/*!
 * tui-editor
 * @version 0.14.0
 * @author Sungho Kim <shirenbeat@gmail.com>
 * @license MIT
 */
!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="dist/",t(t.s=110)}([function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(42),a=function(e){return e&&e.__esModule?e:{default:e}}(o),l=tui,s=l.util,u=/Mac/.test(navigator.platform),c=u?1:0,f=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,e),this._command=new s.Map,this._mdCommand=new s.Map,this._wwCommand=new s.Map,this._options=$.extend({useCommandShortcut:!0},n),this.base=t,this.keyMapCommand={},this._initEvent()}return i(e,[{key:"_addCommandBefore",value:function(e){var t={command:e};return this.base.eventManager.emit("addCommandBefore",t),t.command||e}},{key:"addCommand",value:function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];r.length&&(t=e.command.apply(e,[t].concat(r))),t=this._addCommandBefore(t);var o=t.getName(),a=void 0;return t.isMDType()?a=this._mdCommand:t.isWWType()?a=this._wwCommand:t.isGlobalType()&&(a=this._command),a.set(o,t),t.keyMap&&(this.keyMapCommand[t.keyMap[c]]=o),t}},{key:"_initEvent",value:function(){var e=this;this.base.eventManager.listen("command",function(){e.exec.apply(e,arguments)}),this.base.eventManager.listen("keyMap",function(t){if(e._options.useCommandShortcut){var n=e.keyMapCommand[t.keyMap];n&&(t.data.preventDefault(),e.exec(n))}})}},{key:"exec",value:function(e){var t=void 0,n=void 0,r=this.base;if(t=this._command.get(e),t||(this.base.isMarkdownMode()?(t=this._mdCommand.get(e),r=this.base.mdEditor):(t=this._wwCommand.get(e),r=this.base.wwEditor)),t){for(var i,o=arguments.length,a=Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];a.unshift(r),n=(i=t).exec.apply(i,a)}return n}}]),e}();f.command=function(e,t){var n=a.default.factory(e,t.name,t.keyMap);return s.extend(n,t),n},e.exports=f},function(e,t,n){"use strict";var r=/\u200B/g,i=tui,o=i.util,a=function(e){return e&&e.nodeType===Node.TEXT_NODE},l=function(e){return e&&e.nodeType===Node.ELEMENT_NODE},s=function(e){return l(e)?e.tagName:"TEXT"},u=function(e){var t=void 0;return l(e)?t=e.textContent.replace(r,"").length:a(e)&&(t=e.nodeValue.replace(r,"").length),t},c=function(e){var t=void 0;return l(e)?t=e.childNodes.length:a(e)&&(t=e.nodeValue.replace(r,"").length),t},f=function(e){var t=e.parentNode.childNodes,n=void 0,r=void 0,i=void 0;for(n=0,r=t.length;n<r;n+=1)if(t[n]===e){i=n;break}return i},d=function(e,t){var n=void 0;return a(e)?n=e:e.childNodes.length&&t>=0&&(n=e.childNodes[t]),n},h=function(e,t,n){for(var r=e+"Sibling",i=void 0,o=void 0;t&&!t[r]&&(i=s(t.parentNode))!==n&&"BODY"!==i;)t=t.parentNode;return t[r]&&(o=t[r]),o},g=function(e,t,n){return t>0?d(e,t-1):h("previous",e,n)},p=function(e,t){for(var n=void 0;e.parentNode&&!t(e.parentNode);)e=e.parentNode;return t(e.parentNode)&&(n=e),n},v=function(e,t){return o.isString(t)?p(e,function(e){return t===s(e)}):p(e,function(e){return t===e})},m=function(e,t,n){var r=e+"Sibling",i=void 0;return t=v(t,n),t&&t[r]&&(i=t[r]),i},b=function(e,t){return m("previous",e,t)},y=function(e,t){return m("next",e,t)},w=function(e){return v(e,"BODY")},_=function(e){for(e=e.previousSibling||e.parentNode;!a(e)&&"BODY"!==s(e);)if(e.previousSibling)for(e=e.previousSibling;e.lastChild;)e=e.lastChild;else e=e.parentNode;return"BODY"===s(e)&&(e=null),e},k=function(e,t,n){var r=[],i="",a=0,l=void 0;if(!t.length)return r;for(var s=t.shift(),u=document.createTreeWalker(e,4,null,!1);u.nextNode();){for(i=u.currentNode.nodeValue||"",n&&(i=n(i)),l=a+i.length;l>=s;){if(r.push({container:u.currentNode,offsetInContainer:s-a,offset:s}),!t.length)return r;s=t.shift()}a=l}do{r.push({container:u.currentNode,offsetInContainer:i.length,offset:s}),s=t.shift()}while(!o.isUndefined(s));return r},E=function(e){var t={};t.tagName=e.nodeName,e.id&&(t.id=e.id);var n=e.className.trim();return n&&(t.className=n),t},T=function(e,t){for(var n=[];e&&e!==t;)l(e)&&n.unshift(E(e)),e=e.parentNode;return n},C=function(e,t){var n=!0;return tui.util.isUndefined(t)||"next"!==t&&"previous"!==t?null:("previous"===t&&(n=!1),n?e.nextElementSibling:e.previousElementSibling)},x=function(e,t,n){var r=!0,i=null,o=void 0,a=void 0,l=void 0,u=void 0,c=void 0,d=void 0;return tui.util.isUndefined(t)||"next"!==t&&"previous"!==t?null:("previous"===t&&(r=!1),e?(o=$(e),r?(l=o.parent().next(),u=o.parents("thead"),c=u[0]&&u.next(),d=c&&"TBODY"===s(c[0]),a=0):(l=o.parent().prev(),u=o.parents("tbody"),c=u[0]&&u.prev(),d=c&&"THEAD"===s(c[0]),a=e.parentNode.childNodes.length-1),!tui.util.isUndefined(n)&&n||(a=f(e)),l[0]?i=l.children("td,th")[a]:u[0]&&d&&(i=c.find("td,th")[a]),i):null)};e.exports={getNodeName:s,isTextNode:a,isElemNode:l,getTextLength:u,getOffsetLength:c,getPrevOffsetNodeUntil:g,getNodeOffsetOfParent:f,getChildNodeByOffset:d,getTopPrevNodeUnder:b,getTopNextNodeUnder:y,getParentUntil:v,getTopBlockNode:w,getPrevTextNode:_,findOffsetNode:k,getPath:T,getNodeInfo:E,getTableCellByDirection:C,getSiblingRowCellByDirection:x}},function(e,t,n){"use strict";function r(e,t,n){var r=$(e),i=r.attr("colspan"),o=r.attr("rowspan"),a=e.nodeName;if("TH"!==a&&"TD"!==a)return null;var l={nodeName:e.nodeName,colspan:i?parseInt(i,10):1,rowspan:o?parseInt(o,10):1,content:r.html(),elementIndex:{rowIndex:t,colIndex:n}};return"TH"===e.nodeName&&e.align&&(l.align=e.align),l}function i(e,t,n,r){var i=t.colspan,o=t.rowspan,a=t.nodeName,l=i>1,s=o>1;if(l||s){var u=n+o,c=r+i;y.range(n,u).forEach(function(t){e[t]=e[t]||[],y.range(r,c).forEach(function(i){var o={nodeName:a};t===n&&i===r||(l&&(o.colMergeWith=r),s&&(o.rowMergeWith=n),e[t][i]=o)})})}}function o(e){var t=[];return e.find("tr").each(function(e,n){var o=0;t[e]=t[e]||[],$(n).children().each(function(n,a){var l=r(a,e,n);if(l){for(var s=n+o;t[e][s];)s+=1,o+=1;t[e][s]=l,i(t,l,e,s)}})}),e[0].className&&(t.className=e[0].className),t}function a(e){var t=[];return e.forEach(function(e,n){var r=[];e.forEach(function(e,t){y.isUndefined(e.colMergeWith)&&y.isUndefined(e.rowMergeWith)&&r.push({rowIndex:n,colIndex:t})}),t.push(r)}),t}function l(e){var t=e[0];return t.map(function(e){return y.isExisty(e.colMergeWith)?t[e.colMergeWith].align:e.align})}function s(e,t){var n=l(e),r=t.map(function(t){return t.map(function(t){var r=t.rowIndex,i=t.colIndex;return y.extend({align:n[i]},e[r][i])})});return e.className&&(r.className=e.className),r}function u(e,t,n){return{nodeName:n||"TD",colspan:1,rowspan:1,content:w,elementIndex:{rowIndex:e,colIndex:t}}}function c(e){var t=e.closest("tr"),n=t.prevAll().length;return"TBODY"===t.parent()[0].nodeName&&(n+=1),n}function f(e){return e.closest("td, th").prevAll().length}function d(e,t){var n=c(t),r=f(t);return e[n][r]}function h(e,t,n){var r=e[t][n],i=t;return r.rowspan>1&&(i+=r.rowspan-1),i}function g(e,t,n){var r=e[t][n],i=n;return r.colspan>1&&(i+=r.colspan-1),i}function p(e,t,n){var r=e[t][n];return t=y.isExisty(r.rowMergeWith)?r.rowMergeWith:t,n=y.isExisty(r.colMergeWith)?r.colMergeWith:n,e[t][n].elementIndex}function v(e,t){e.forEach(function(e,n){var r=e.length,i=e[0].nodeName;y.range(r,t).forEach(function(t){e.push(u(n,t,i))})})}function m(e){var t=e[0],n=t.length,r=!0;if(!n&&e[1])y.range(0,e[1].length).forEach(function(e){t.push(u(0,e,"TH"))});else if("TH"!==e[0][0].nodeName){var i,o=y.range(0,n).map(function(e){return u(0,e,"TH")});(i=[]).concat.apply(i,e).forEach(function(e){e.elementIndex&&(e.elementIndex.rowIndex+=1)}),e.unshift(o)}else if(1===e.length){var a=y.range(0,n).map(function(e){return u(1,e,"TD")});e.push(a)}else r=!1;return r}Object.defineProperty(t,"__esModule",{value:!0}),t.createTableData=o,t.createCellIndexData=a;var b=tui,y=b.util,w=tui.util.browser.msie?"":"<br>";t.default={createTableData:o,createCellIndexData:a,createRenderData:s,findElementRowIndex:c,findElementColIndex:f,findCellIndex:d,createBasicCell:u,findRowMergedLastIndex:h,findColMergedLastIndex:g,findElementIndex:p,stuffCellsIntoIncompleteRow:v,addTbodyOrTheadIfNeed:m}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=tui,a=o.util,l=void 0,s="en_US",u=function(){function e(){r(this,e),this._code=s,this._langs=new a.Map}return i(e,[{key:"setCode",value:function(e){this._code=e}},{key:"setLang",value:function(e,t){var n=this;e=[].concat(e),e.forEach(function(e){if(n._langs.has(e)){var r=n._langs.get(e);n._langs.set(e,a.extend(r,t))}else n._langs.set(e,t)})}},{key:"get",value:function(e,t){t||(t=this._code);var n=this._langs.get(t);n||(n=this._langs.get(s));var r=n[e];if(!r)throw new Error('There is no text key "'+e+'" in '+t);return r}}],[{key:"getSharedInstance",value:function(){return l||(l=new e),l}}]),e}();t.I18n=u,t.default=u.getSharedInstance()},function(e,t,n){"use strict";function r(e,t,n){var r=c.default.createCellIndexData(e),i=c.default.findCellIndex(r,t),o=c.default.findCellIndex(r,n),a=void 0,l=void 0,s=void 0,u=void 0;return i.rowIndex>o.rowIndex?(a=o.rowIndex,l=i.rowIndex):(a=i.rowIndex,l=o.rowIndex),i.colIndex>o.colIndex?(s=o.colIndex,u=i.colIndex):(s=i.colIndex,u=o.colIndex),{start:{rowIndex:a,colIndex:s},end:{rowIndex:l,colIndex:u}}}function i(e,t,n){var r=t[n].rowIndex,i=e[r];d.range(t.start.colIndex,t.end.colIndex+1).forEach(function(n){var o=i[n],a=o.rowMergeWith,l=-1;d.isExisty(a)?(a<t.start.rowIndex&&(t.start.rowIndex=a),l=a+e[a][n].rowspan-1):o.rowspan>1&&(l=r+o.rowspan-1),l>t.end.rowIndex&&(t.end.rowIndex=l)})}function o(e,t,n,r){var i=e[n],o=i[r],a=o.colMergeWith,l=-1;d.isExisty(a)?(a<t.start.colIndex&&(t.start.colIndex=a),l=a+i[a].colspan-1):o.colspan>1&&(l=r+o.colspan-1),l>t.end.colIndex&&(t.end.colIndex=l)}function a(e,t){for(var n="";n!==JSON.stringify(t);)n=JSON.stringify(t),i(e,t,"start"),i(e,t,"end"),d.range(t.start.rowIndex,t.end.rowIndex+1).forEach(function(n){o(e,t,n,t.start.colIndex),o(e,t,n,t.end.colIndex)});return t}function l(e,t,n){return a(e,r(e,t,n))}function s(e,t,n){var r=c.default.createCellIndexData(e),i={};if(t.length){var o=c.default.findCellIndex(r,t.first()),a=d.extend({},o);t.each(function(t,n){var i=c.default.findCellIndex(r,$(n)),o=e[i.rowIndex][i.colIndex],l=i.rowIndex+o.rowspan-1,s=i.colIndex+o.colspan-1;a.rowIndex=Math.max(a.rowIndex,l),a.colIndex=Math.max(a.colIndex,s)}),i.start=o,i.end=a}else{var l=c.default.findCellIndex(r,n);i.start=l,i.end=d.extend({},l)}return i}Object.defineProperty(t,"__esModule",{value:!0});var u=n(2),c=function(e){return e&&e.__esModule?e:{default:e}}(u),f=tui,d=f.util;t.default={findSelectionRange:l,getTableSelectionRange:s}},function(e,t,n){"use strict";function r(e){var t=e.colspan>1?' colspan="'+e.colspan+'"':"";return t+=e.rowspan>1?' rowspan="'+e.rowspan+'"':"",t+=e.align?' align="'+e.align+'"':"","<"+e.nodeName+t+">"+e.content+"</"+e.nodeName+">"}function i(e,t){var n="";return e.length&&(n=e.map(function(e){return"<tr>"+e.map(r).join("")+"</tr>"}).join(""),n="<"+t+">"+n+"</"+t+">"),n}function o(e){var t=[e[0]],n=e.slice(1),r=i(t,"THEAD"),o=i(n,"TBODY");return"<table"+(e.className?' class="'+e.className+'"':"")+">"+(r+o)+"</renderData>"}function a(e,t){var n=u.default.createCellIndexData(t),r=u.default.createRenderData(t,n),i=$(o(r));return e.replaceWith(i),i}function l(e,t,n){t.selectNodeContents(n),t.collapse(!0),e.setSelection(t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(2),u=function(e){return e&&e.__esModule?e:{default:e}}(s);t.default={createTableHtml:o,replaceTable:a,focusToCell:l}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=tui,a=o.util,l=function(){function e(){r(this,e),this.exts=new a.Map}return i(e,[{key:"defineExtension",value:function(e,t){this.exts.set(e,t)}},{key:"applyExtension",value:function(e,t){var n=this;t&&t.forEach(function(t){var r=a.isObject(t),i=r?t.name:t;if(n.exts.has(i)){var o=n.exts.get(i);r?o(e,t):o(e)}})}}]),e}();e.exports=new l},function(e,t,n){"use strict";function r(e){if(!(this instanceof r))return new r(e);u.call(this,e),c.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",i)}function i(){this.allowHalfOpen||this._writableState.ended||l(o,this)}function o(e){e.end()}var a=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=r;var l=n(14),s=n(9);s.inherits=n(8);var u=n(22),c=n(15);s.inherits(r,u);for(var f=a(c.prototype),d=0;d<f.length;d++){var h=f[d];r.prototype[h]||(r.prototype[h]=c.prototype[h])}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){(function(e){function n(e){return Array.isArray?Array.isArray(e):"[object Array]"===v(e)}function r(e){return"boolean"==typeof e}function i(e){return null===e}function o(e){return null==e}function a(e){return"number"==typeof e}function l(e){return"string"==typeof e}function s(e){return"symbol"==typeof e}function u(e){return void 0===e}function c(e){return"[object RegExp]"===v(e)}function f(e){return"object"==typeof e&&null!==e}function d(e){return"[object Date]"===v(e)}function h(e){return"[object Error]"===v(e)||e instanceof Error}function g(e){return"function"==typeof e}function p(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function v(e){return Object.prototype.toString.call(e)}t.isArray=n,t.isBoolean=r,t.isNull=i,t.isNullOrUndefined=o,t.isNumber=a,t.isString=l,t.isSymbol=s,t.isUndefined=u,t.isRegExp=c,t.isObject=f,t.isDate=d,t.isError=h,t.isFunction=g,t.isPrimitive=p,t.isBuffer=e.isBuffer}).call(t,n(12).Buffer)},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(e){if(c===setTimeout)return setTimeout(e,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function o(e){if(f===clearTimeout)return clearTimeout(e);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function a(){p&&h&&(p=!1,h.length?g=h.concat(g):v=-1,g.length&&l())}function l(){if(!p){var e=i(a);p=!0;for(var t=g.length;t;){for(h=g,g=[];++v<t;)h&&h[v].run();v=-1,t=g.length}h=null,p=!1,o(e)}}function s(e,t){this.fun=e,this.array=t}function u(){}var c,f,d=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(e){c=n}try{f="function"==typeof clearTimeout?clearTimeout:r}catch(e){f=r}}();var h,g=[],p=!1,v=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];g.push(new s(e,t)),1!==g.length||p||i(l)},s.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=u,d.addListener=u,d.once=u,d.off=u,d.removeListener=u,d.removeAllListeners=u,d.emit=u,d.prependListener=u,d.prependOnceListener=u,d.listeners=function(e){return[]},d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},,function(e,t,n){"use strict";(function(e){function r(){return o.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function i(e,t){if(r()<t)throw new RangeError("Invalid typed array length");return o.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=o.prototype):(null===e&&(e=new o(t)),e.length=t),e}function o(e,t,n){if(!(o.TYPED_ARRAY_SUPPORT||this instanceof o))return new o(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(this,e)}return a(this,e,t,n)}function a(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?d(e,t,n,r):"string"==typeof t?c(e,t,n):h(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function s(e,t,n,r){return l(t),t<=0?i(e,t):void 0!==n?"string"==typeof r?i(e,t).fill(n,r):i(e,t).fill(n):i(e,t)}function u(e,t){if(l(t),e=i(e,t<0?0:0|g(t)),!o.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function c(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!o.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|v(t,n);e=i(e,r);var a=e.write(t,n);return a!==r&&(e=e.slice(0,a)),e}function f(e,t){var n=t.length<0?0:0|g(t.length);e=i(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function d(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),o.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=o.prototype):e=f(e,t),e}function h(e,t){if(o.isBuffer(t)){var n=0|g(t.length);return e=i(e,n),0===e.length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||X(t.length)?i(e,0):f(e,t);if("Buffer"===t.type&&Z(t.data))return f(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function g(e){if(e>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|e}function p(e){return+e!=e&&(e=0),o.alloc(+e)}function v(e,t){if(o.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return q(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return z(e).length;default:if(r)return q(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return O(this,t,n);case"utf8":case"utf-8":return S(this,t,n);case"ascii":return R(this,t,n);case"latin1":case"binary":return A(this,t,n);case"base64":return M(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function b(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function y(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=o.from(t,r)),o.isBuffer(t))return 0===t.length?-1:w(e,t,n,r,i);if("number"==typeof t)return t&=255,o.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):w(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function w(e,t,n,r,i){function o(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}var a=1,l=e.length,s=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,l/=2,s/=2,n/=2}var u;if(i){var c=-1;for(u=n;u<l;u++)if(o(e,u)===o(t,-1===c?0:u-c)){if(-1===c&&(c=u),u-c+1===s)return c*a}else-1!==c&&(u-=u-c),c=-1}else for(n+s>l&&(n=l-s),u=n;u>=0;u--){for(var f=!0,d=0;d<s;d++)if(o(e,u+d)!==o(t,d)){f=!1;break}if(f)return u}return-1}function _(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var l=parseInt(t.substr(2*a,2),16);if(isNaN(l))return a;e[n+a]=l}return a}function k(e,t,n,r){return K(q(t,e.length-n),e,n,r)}function E(e,t,n,r){return K(Y(t),e,n,r)}function T(e,t,n,r){return E(e,t,n,r)}function C(e,t,n,r){return K(z(t),e,n,r)}function x(e,t,n,r){return K(V(t,e.length-n),e,n,r)}function M(e,t,n){return 0===t&&n===e.length?G.fromByteArray(e):G.fromByteArray(e.slice(t,n))}function S(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o=e[i],a=null,l=o>239?4:o>223?3:o>191?2:1;if(i+l<=n){var s,u,c,f;switch(l){case 1:o<128&&(a=o);break;case 2:s=e[i+1],128==(192&s)&&(f=(31&o)<<6|63&s)>127&&(a=f);break;case 3:s=e[i+1],u=e[i+2],128==(192&s)&&128==(192&u)&&(f=(15&o)<<12|(63&s)<<6|63&u)>2047&&(f<55296||f>57343)&&(a=f);break;case 4:s=e[i+1],u=e[i+2],c=e[i+3],128==(192&s)&&128==(192&u)&&128==(192&c)&&(f=(15&o)<<18|(63&s)<<12|(63&u)<<6|63&c)>65535&&f<1114112&&(a=f)}}null===a?(a=65533,l=1):a>65535&&(a-=65536,r.push(a>>>10&1023|55296),a=56320|1023&a),r.push(a),i+=l}return I(r)}function I(e){var t=e.length;if(t<=Q)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=Q));return n}function R(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function A(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function O(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=F(e[o]);return i}function N(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function B(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function D(e,t,n,r,i,a){if(!o.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function P(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function L(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function $(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function U(e,t,n,r,i){return i||$(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),J.write(e,t,n,r,23,4),n+4}function j(e,t,n,r,i){return i||$(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),J.write(e,t,n,r,52,8),n+8}function H(e){if(e=W(e).replace(ee,""),e.length<2)return"";for(;e.length%4!=0;)e+="=";return e}function W(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function F(e){return e<16?"0"+e.toString(16):e.toString(16)}function q(e,t){t=t||1/0;for(var n,r=e.length,i=null,o=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function Y(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function V(e,t){for(var n,r,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}function z(e){return G.toByteArray(H(e))}function K(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function X(e){return e!==e}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var G=n(74),J=n(75),Z=n(20);t.Buffer=o,t.SlowBuffer=p,t.INSPECT_MAX_BYTES=50,o.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=r(),o.poolSize=8192,o._augment=function(e){return e.__proto__=o.prototype,e},o.from=function(e,t,n){return a(null,e,t,n)},o.TYPED_ARRAY_SUPPORT&&(o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0})),o.alloc=function(e,t,n){return s(null,e,t,n)},o.allocUnsafe=function(e){return u(null,e)},o.allocUnsafeSlow=function(e){return u(null,e)},o.isBuffer=function(e){return!(null==e||!e._isBuffer)},o.compare=function(e,t){if(!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,a=Math.min(n,r);i<a;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Z(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=o.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var a=e[n];if(!o.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},o.byteLength=v,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)b(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)b(this,t,t+3),b(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)b(this,t,t+7),b(this,t+1,t+6),b(this,t+2,t+5),b(this,t+3,t+4);return this},o.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?S(this,0,e):m.apply(this,arguments)},o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},o.prototype.compare=function(e,t,n,r,i){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,i>>>=0,this===e)return 0;for(var a=i-r,l=n-t,s=Math.min(a,l),u=this.slice(r,i),c=e.slice(t,n),f=0;f<s;++f)if(u[f]!==c[f]){a=u[f],l=c[f];break}return a<l?-1:l<a?1:0},o.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},o.prototype.indexOf=function(e,t,n){return y(this,e,t,n,!0)},o.prototype.lastIndexOf=function(e,t,n){return y(this,e,t,n,!1)},o.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return _(this,e,t,n);case"utf8":case"utf-8":return k(this,e,t,n);case"ascii":return E(this,e,t,n);case"latin1":case"binary":return T(this,e,t,n);case"base64":return C(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Q=4096;o.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r;if(o.TYPED_ARRAY_SUPPORT)r=this.subarray(e,t),r.__proto__=o.prototype;else{var i=t-e;r=new o(i,void 0);for(var a=0;a<i;++a)r[a]=this[a+e]}return r},o.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||B(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},o.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||B(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},o.prototype.readUInt8=function(e,t){return t||B(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return t||B(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return t||B(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return t||B(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUInt32BE=function(e,t){return t||B(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||B(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},o.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||B(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},o.prototype.readInt8=function(e,t){return t||B(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){t||B(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt16BE=function(e,t){t||B(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt32LE=function(e,t){return t||B(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return t||B(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return t||B(e,4,this.length),J.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return t||B(e,4,this.length),J.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return t||B(e,8,this.length),J.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return t||B(e,8,this.length),J.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){D(this,e,t,n,Math.pow(2,8*n)-1,0)}var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},o.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){D(this,e,t,n,Math.pow(2,8*n)-1,0)}var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},o.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,1,255,0),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):P(this,e,t,!0),t+2},o.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):P(this,e,t,!1),t+2},o.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):L(this,e,t,!0),t+4},o.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},o.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);D(this,e,t,n,i-1,-i)}var o=0,a=1,l=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===l&&0!==this[t+o-1]&&(l=1),this[t+o]=(e/a>>0)-l&255;return t+n},o.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);D(this,e,t,n,i-1,-i)}var o=n-1,a=1,l=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===l&&0!==this[t+o+1]&&(l=1),this[t+o]=(e/a>>0)-l&255;return t+n},o.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,1,127,-128),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):P(this,e,t,!0),t+2},o.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):P(this,e,t,!1),t+2},o.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,2147483647,-2147483648),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):L(this,e,t,!0),t+4},o.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},o.prototype.writeFloatLE=function(e,t,n){return U(this,e,t,!0,n)},o.prototype.writeFloatBE=function(e,t,n){return U(this,e,t,!1,n)},o.prototype.writeDoubleLE=function(e,t,n){return j(this,e,t,!0,n)},o.prototype.writeDoubleBE=function(e,t,n){return j(this,e,t,!1,n)},o.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,a=r-n;if(this===e&&n<t&&t<r)for(i=a-1;i>=0;--i)e[i+t]=this[i+n];else if(a<1e3||!o.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},o.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!o.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0);var a;if("number"==typeof e)for(a=t;a<n;++a)this[a]=e;else{var l=o.isBuffer(e)?e:q(new o(e,r).toString()),s=l.length;for(a=0;a<n-t;++a)this[a+t]=l[a%s]}return this};var ee=/[^+\/0-9A-Za-z-_]/g}).call(t,n(18))},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function i(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!i(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,i,l,s,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}if(n=this._events[e],a(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:l=Array.prototype.slice.call(arguments,1),n.apply(this,l)}else if(o(n))for(l=Array.prototype.slice.call(arguments,1),u=n.slice(),i=u.length,s=0;s<i;s++)u[s].apply(this,l);return!0},n.prototype.addListener=function(e,t){var i;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(i=a(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var i=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,i,a,l;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],a=n.length,i=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(n)){for(l=a;l-- >0;)if(n[l]===t||n[l].listener&&n[l].listener===t){i=l;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,n){"use strict";(function(t){function n(e,n,r,i){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var o,a,l=arguments.length;switch(l){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick(function(){e.call(null,n)});case 3:return t.nextTick(function(){e.call(null,n,r)});case 4:return t.nextTick(function(){e.call(null,n,r,i)});default:for(o=new Array(l-1),a=0;a<o.length;)o[a++]=arguments[a];return t.nextTick(function(){e.apply(null,o)})}}!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?e.exports=n:e.exports=t.nextTick}).call(t,n(10))},function(e,t,n){"use strict";(function(t,r){function i(){}function o(e,t,n){this.chunk=e,this.encoding=t,this.callback=n,this.next=null}function a(e,t){T=T||n(7),e=e||{},this.objectMode=!!e.objectMode,t instanceof T&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var r=e.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:i,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var o=!1===e.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){p(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new E(this)}function l(e){if(T=T||n(7),!(A.call(l,this)||this instanceof T))return new l(e);this._writableState=new a(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev)),I.call(this)}function s(e,t){var n=new Error("write after end");e.emit("error",n),C(t,n)}function u(e,t,n,r){var i=!0,o=!1;return null===n?o=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),C(r,o),i=!1),i}function c(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=R.from(t,n)),t}function f(e,t,n,r,i,a){n||(r=c(t,r,i),R.isBuffer(r)&&(i="buffer"));var l=t.objectMode?1:r.length;t.length+=l;var s=t.length<t.highWaterMark;if(s||(t.needDrain=!0),t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest=new o(r,i,a),u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else d(e,t,!1,l,r,i,a);return s}function d(e,t,n,r,i,o,a){t.writelen=r,t.writecb=a,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function h(e,t,n,r,i){--t.pendingcb,n?C(i,r):i(r),e._writableState.errorEmitted=!0,e.emit("error",r)}function g(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function p(e,t){var n=e._writableState,r=n.sync,i=n.writecb;if(g(n),t)h(e,n,r,t,i);else{var o=y(n);o||n.corked||n.bufferProcessing||!n.bufferedRequest||b(e,n),r?x(v,e,n,o,i):v(e,n,o,i)}}function v(e,t,n,r){n||m(e,t),t.pendingcb--,r(),_(e,t)}function m(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function b(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r),o=t.corkedRequestsFree;o.entry=n;for(var a=0;n;)i[a]=n,n=n.next,a+=1;d(e,t,!0,t.length,i,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new E(t)}else{for(;n;){var l=n.chunk,s=n.encoding,u=n.callback;if(d(e,t,!1,t.objectMode?1:l.length,l,s,u),n=n.next,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=n,t.bufferProcessing=!1}function y(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function w(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function _(e,t){var n=y(t);return n&&(0===t.pendingcb?(w(e,t),t.finished=!0,e.emit("finish")):w(e,t)),n}function k(e,t,n){t.ending=!0,_(e,t),n&&(t.finished?C(n):e.once("finish",n)),t.ended=!0,e.writable=!1}function E(e){var t=this;this.next=null,this.entry=null,this.finish=function(n){var r=t.entry;for(t.entry=null;r;){var i=r.callback;e.pendingcb--,i(n),r=r.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}e.exports=l;var T,C=n(14),x=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?r:C;l.WritableState=a;var M=n(9);M.inherits=n(8);var S={deprecate:n(85)},I=n(24),R=n(17).Buffer;M.inherits(l,I),a.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(a.prototype,"buffer",{get:S.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch(e){}}();var A;"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(A=Function.prototype[Symbol.hasInstance],Object.defineProperty(l,Symbol.hasInstance,{value:function(e){return!!A.call(this,e)||e&&e._writableState instanceof a}})):A=function(e){return e instanceof this},l.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},l.prototype.write=function(e,t,n){var r=this._writableState,o=!1,a=R.isBuffer(e);return"function"==typeof t&&(n=t,t=null),a?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof n&&(n=i),r.ended?s(this,n):(a||u(this,r,e,n))&&(r.pendingcb++,o=f(this,r,a,e,t,n)),o},l.prototype.cork=function(){this._writableState.corked++},l.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||b(this,e))},l.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},l.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},l.prototype._writev=null,l.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!==e&&void 0!==e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||k(this,r,n)}}).call(t,n(10),n(84).setImmediate)},function(e,t,n){t=e.exports=n(22),t.Stream=t,t.Readable=t,t.Writable=n(15),t.Duplex=n(7),t.Transform=n(23),t.PassThrough=n(78)},function(e,t,n){e.exports=n(12)},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},,function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){function r(e){if(e&&!s(e))throw new Error("Unknown encoding: "+e)}function i(e){return e.toString(this.encoding)}function o(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function a(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}var l=n(12).Buffer,s=l.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},u=t.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),r(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=o;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=a;break;default:return void(this.write=i)}this.charBuffer=new l(6),this.charReceived=0,this.charLength=0};u.prototype.write=function(e){for(var t="";this.charLength;){var n=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";e=e.slice(n,e.length),t=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var r=t.charCodeAt(t.length-1);if(!(r>=55296&&r<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var i=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,i),i-=this.charReceived),t+=e.toString(this.encoding,0,i);var i=t.length-1,r=t.charCodeAt(i);if(r>=55296&&r<=56319){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),e.copy(this.charBuffer,0,0,o),t.substring(0,i)}return t},u.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var n=e[e.length-t];if(1==t&&n>>5==6){this.charLength=2;break}if(t<=2&&n>>4==14){this.charLength=3;break}if(t<=3&&n>>3==30){this.charLength=4;break}}this.charReceived=t},u.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var n=this.charReceived,r=this.charBuffer,i=this.encoding;t+=r.slice(0,n).toString(i)}return t}},function(e,t,n){"use strict";(function(t){function r(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?R(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}function i(e,t){S=S||n(7),e=e||{},this.objectMode=!!e.objectMode,t instanceof S&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var r=e.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:i,this.highWaterMark=~~this.highWaterMark,this.buffer=new $,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(L||(L=n(21).StringDecoder),this.decoder=new L(e.encoding),this.encoding=e.encoding)}function o(e){if(S=S||n(7),!(this instanceof o))return new o(e);this._readableState=new i(e,this),this.readable=!0,e&&"function"==typeof e.read&&(this._read=e.read),O.call(this)}function a(e,t,n,r,i){var o=c(t,n);if(o)e.emit("error",o);else if(null===n)t.reading=!1,f(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!i){var a=new Error("stream.push() after EOF");e.emit("error",a)}else if(t.endEmitted&&i){var s=new Error("stream.unshift() after end event");e.emit("error",s)}else{var u;!t.decoder||i||r||(n=t.decoder.write(n),u=!t.objectMode&&0===n.length),i||(t.reading=!1),u||(t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&d(e))),g(e,t)}else i||(t.reading=!1);return l(t)}function l(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function s(e){return e>=j?e=j:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function u(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=s(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function c(e,t){var n=null;return N.isBuffer(t)||"string"==typeof t||null===t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function f(e,t){if(!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,d(e)}}function d(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(P("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?I(h,e):h(e))}function h(e){P("emit readable"),e.emit("readable"),w(e)}function g(e,t){t.readingMore||(t.readingMore=!0,I(p,e,t))}function p(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(P("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function v(e){return function(){var t=e._readableState;P("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&A(e,"data")&&(t.flowing=!0,w(e))}}function m(e){P("readable nexttick read 0"),e.read(0)}function b(e,t){t.resumeScheduled||(t.resumeScheduled=!0,I(y,e,t))}function y(e,t){t.reading||(P("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),w(e),t.flowing&&!t.reading&&e.read(0)}function w(e){var t=e._readableState;for(P("flow",t.flowing);t.flowing&&null!==e.read(););}function _(e,t){if(0===t.length)return null;var n;return t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=k(e,t.buffer,t.decoder),n}function k(e,t,n){var r;return e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():n?E(e,t):T(e,t),r}function E(e,t){var n=t.head,r=1,i=n.data;for(e-=i.length;n=n.next;){var o=n.data,a=e>o.length?o.length:e;if(a===o.length?i+=o:i+=o.slice(0,e),0===(e-=a)){a===o.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(a));break}++r}return t.length-=r,i}function T(e,t){var n=N.allocUnsafe(e),r=t.head,i=1;for(r.data.copy(n),e-=r.data.length;r=r.next;){var o=r.data,a=e>o.length?o.length:e;if(o.copy(n,n.length-e,0,a),0===(e-=a)){a===o.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(a));break}++i}return t.length-=i,n}function C(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,I(x,t,e))}function x(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function M(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}e.exports=o;var S,I=n(14),R=n(20);o.ReadableState=i;var A=(n(13).EventEmitter,function(e,t){return e.listeners(t).length}),O=n(24),N=n(17).Buffer,B=n(9);B.inherits=n(8);var D=n(86),P=void 0;P=D&&D.debuglog?D.debuglog("stream"):function(){};var L,$=n(79);B.inherits(o,O);var U=["error","close","destroy","pause","resume"];o.prototype.push=function(e,t){var n=this._readableState;return n.objectMode||"string"!=typeof e||(t=t||n.defaultEncoding)!==n.encoding&&(e=N.from(e,t),t=""),a(this,n,e,t,!1)},o.prototype.unshift=function(e){return a(this,this._readableState,e,"",!0)},o.prototype.isPaused=function(){return!1===this._readableState.flowing},o.prototype.setEncoding=function(e){return L||(L=n(21).StringDecoder),this._readableState.decoder=new L(e),this._readableState.encoding=e,this};var j=8388608;o.prototype.read=function(e){P("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return P("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?C(this):d(this),null;if(0===(e=u(e,t))&&t.ended)return 0===t.length&&C(this),null;var r=t.needReadable;P("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&(r=!0,P("length less than watermark",r)),t.ended||t.reading?(r=!1,P("reading or ended",r)):r&&(P("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=u(n,t)));var i;return i=e>0?_(e,t):null,null===i?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&C(this)),null!==i&&this.emit("data",i),i},o.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},o.prototype.pipe=function(e,n){function i(e){P("onunpipe"),e===d&&a()}function o(){P("onend"),e.end()}function a(){P("cleanup"),e.removeListener("close",u),e.removeListener("finish",c),e.removeListener("drain",m),e.removeListener("error",s),e.removeListener("unpipe",i),d.removeListener("end",o),d.removeListener("end",f),d.removeListener("data",l),b=!0,!h.awaitDrain||e._writableState&&!e._writableState.needDrain||m()}function l(t){P("ondata"),y=!1,!1!==e.write(t)||y||((1===h.pipesCount&&h.pipes===e||h.pipesCount>1&&-1!==M(h.pipes,e))&&!b&&(P("false write response, pause",d._readableState.awaitDrain),d._readableState.awaitDrain++,y=!0),d.pause())}function s(t){P("onerror",t),f(),e.removeListener("error",s),0===A(e,"error")&&e.emit("error",t)}function u(){e.removeListener("finish",c),f()}function c(){P("onfinish"),e.removeListener("close",u),f()}function f(){P("unpipe"),d.unpipe(e)}var d=this,h=this._readableState;switch(h.pipesCount){case 0:h.pipes=e;break;case 1:h.pipes=[h.pipes,e];break;default:h.pipes.push(e)}h.pipesCount+=1,P("pipe count=%d opts=%j",h.pipesCount,n);var g=(!n||!1!==n.end)&&e!==t.stdout&&e!==t.stderr,p=g?o:f;h.endEmitted?I(p):d.once("end",p),e.on("unpipe",i);var m=v(d);e.on("drain",m);var b=!1,y=!1;return d.on("data",l),r(e,"error",s),e.once("close",u),e.once("finish",c),e.emit("pipe",d),h.flowing||(P("pipe resume"),d.resume()),e},o.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<r;i++)n[i].emit("unpipe",this);return this}var o=M(t.pipes,e);return-1===o?this:(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},o.prototype.on=function(e,t){var n=O.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&d(this):I(m,this))}return n},o.prototype.addListener=o.prototype.on,o.prototype.resume=function(){var e=this._readableState;return e.flowing||(P("resume"),e.flowing=!0,b(this,e)),this},o.prototype.pause=function(){return P("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(P("pause"),this._readableState.flowing=!1,this.emit("pause")),this},o.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;e.on("end",function(){if(P("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(i){if(P("wrapped data"),t.decoder&&(i=t.decoder.write(i)),(!t.objectMode||null!==i&&void 0!==i)&&(t.objectMode||i&&i.length)){r.push(i)||(n=!0,e.pause())}});for(var i in e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<U.length;o++)e.on(U[o],r.emit.bind(r,U[o]));return r._read=function(t){P("wrapped _read",t),n&&(n=!1,e.resume())},r},o._fromList=_}).call(t,n(10))},function(e,t,n){"use strict";function r(e){this.afterTransform=function(t,n){return i(e,t,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function i(e,t,n){var r=e._transformState;r.transforming=!1;var i=r.writecb;if(!i)return e.emit("error",new Error("no writecb in Transform class"));r.writechunk=null,r.writecb=null,null!==n&&void 0!==n&&e.push(n),i(t);var o=e._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&e._read(o.highWaterMark)}function o(e){if(!(this instanceof o))return new o(e);l.call(this,e),this._transformState=new r(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(e,n){a(t,e,n)}):a(t)})}function a(e,t,n){if(t)return e.emit("error",t);null!==n&&void 0!==n&&e.push(n);var r=e._writableState,i=e._transformState;if(r.length)throw new Error("Calling transform done when ws.length != 0");if(i.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}e.exports=o;var l=n(7),s=n(9);s.inherits=n(8),s.inherits(o,l),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,l.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,n){throw new Error("_transform() is not implemented")},o.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0}},function(e,t,n){e.exports=n(13).EventEmitter},function(e,t,n){function r(){i.call(this)}e.exports=r;var i=n(13).EventEmitter;n(8)(r,i),r.Readable=n(16),r.Writable=n(82),r.Duplex=n(77),r.Transform=n(81),r.PassThrough=n(80),r.Stream=r,r.prototype.pipe=function(e,t){function n(t){e.writable&&!1===e.write(t)&&u.pause&&u.pause()}function r(){u.readable&&u.resume&&u.resume()}function o(){c||(c=!0,e.end())}function a(){c||(c=!0,"function"==typeof e.destroy&&e.destroy())}function l(e){if(s(),0===i.listenerCount(this,"error"))throw e}function s(){u.removeListener("data",n),e.removeListener("drain",r),u.removeListener("end",o),u.removeListener("close",a),u.removeListener("error",l),e.removeListener("error",l),u.removeListener("end",s),u.removeListener("close",s),e.removeListener("close",s)}var u=this;u.on("data",n),e.on("drain",r),e._isStdio||t&&!1===t.end||(u.on("end",o),u.on("close",a));var c=!1;return u.on("error",l),e.on("error",l),u.on("end",s),u.on("close",s),e.on("close",s),e.emit("pipe",u),e}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e,t){e=g(e);var n=e.split(/\n{2,}/),r=n[0],i=n[1],o=h(r),a=o&&o.editorChart&&o.editorChart.url,l=void 0;if(O.isString(a)){var u=function(e){l=s(e,r),t(l)},c=function(){return t(null)};$.get(a).done(u).fail(c)}else l=s(r,i),t(l)}function s(e,t){return{data:f(e),options:h(t)}}function u(e){e=g(e);var t=e.split(B).slice(0,10).join("\n");return D.map(function(e){return{delimiter:e,delta:c(t,e)}}).sort(function(e,t){return e.delta-t.delta})[0].delimiter}function c(e,t){var n=void 0,r=void 0;try{if(S.default.COLUMN_SEPARATOR=t,n=S.default.parse(e),n[0].length<2)throw new Error("parser fail");r=n.map(function(e){return e.length}).reduce(function(e,t){return{deltaSum:e.deltaSum+Math.abs(e.length-t),length:t}},{deltaSum:0,length:n[0].length}).deltaSum}catch(e){r=1/0}return r}function f(e,t){e=g(e),S.default.COLUMN_SEPARATOR=t||u(e);var n=S.default.parse(e);n=n.map(function(e){return e.map(function(e){return e.trim()})});var r=n[0].filter(function(e,t){return t>0}).reduce(function(e,t){return e||!p(t)},!1),i=r?n.shift():[],o=n.slice(1).reduce(function(e,t){return e||!p(t[0])},!1),a=o?n.map(function(e){return e.shift()}):[];return o&&i.shift(),n=n[0].map(function(e,t){return n.map(function(e){return parseFloat(e[t])})}),{categories:a,series:n.map(function(e,t){return r?{name:i[t],data:e}:{data:e}})}}function d(e,t){var n=function(e){var n=f(e);t(n)},r=function(){return t(null)};$.get(e).done(n).fail(r)}function h(e){var t=["type","url"],n={};return O.isUndefined(e)?n:(e.split(B).forEach(function(e){var r=e.split(P),i=r[0],o=r.slice(1),a=o.join(P);if(i=i.trim(),0!==a.length){try{a=JSON.parse(a.trim())}catch(e){a=a.trim()}var l=i.split("."),s=l.slice(0),u=s[0];O.inArray(u,t)>=0?s.unshift("editorChart"):1===s.length?s.unshift("chart"):"x"!==u&&"y"!==u||(s[0]=u+"Axis");for(var c=n,f=0;f<s.length;f+=1){var d=s[f];c[d]=c[d]||(s.length-1===f?a:{}),c=c[d]}}}),n)}function g(e){return e.replace(/(^(\s*[\n\r])+)|([\n\r]+\s*$)/g,"")}function p(e){return!isNaN(e)&&isFinite(e)}function v(e,t){e=O.extend({editorChart:{},chart:{},chartExportMenu:{}},e);var n=e.chart,r=n.width,i=n.height,o=O.isUndefined(r),a=O.isUndefined(i);if(o||a){var l=t.getBoundingClientRect(),s=l.width;e.chart.width=o?s:r,e.chart.height=a?s:i}return e.editorChart.type=e.editorChart.type?e.editorChart.type+"Chart":"columnChart",e.chartExportMenu.visible=e.chartExportMenu.visible||!1,e}function m(e){var t="chart-"+Math.random().toString(36).substr(2,10),n='<div id="'+t+'" class="chart" />';return window.setTimeout(function(){var n=document.querySelector("#"+t);try{l(e,function(e){var t=e.data,r=e.options;r=v(r,n);var i=r.editorChart.type;L.indexOf(i)<0?n.innerHTML="invalid chart type. type: bar, column, line, area, pie":U.indexOf(i)>-1&&t.categories.length!==t.series[0].data.length?n.innerHTML="invalid chart data":N[i](n,t,r)})}catch(e){n.innerHTML="invalid chart data"}},0),n}function b(e){return e.reduce(function(e,t){var n=t.map(function(e){return!p(e)&&e.indexOf(" ")>=0&&(e='"'+e+'"'),e});return e.push(n.join("\t")),e},[])}function y(e){var t=e.wwEditor.componentManager;t.removeManager("codeblock"),t.addManager(function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),E(t,[{key:"convertToCodeblock",value:function(e){if(1!==e.length||"TABLE"!==e[0].tagName)return T(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"convertToCodeblock",this).call(this,e);var n=$("<pre />"),r=e.shift(),i=[].slice.call(r.rows).map(function(e){return[].slice.call(e.cells).map(function(e){return e.innerText.trim()})}),o=b(i);return n.append(o.reduce(function(e,t){return e+"<div>"+t+"</div>"},[])),n.attr("data-te-codeblock",""),n[0]}}]),t}(R.default))}function w(e,t,n){var r="markdown"===t&&e.getTokenAt(n.from).state.overlay.codeBlock;return r=r||"codeblock"===t,r=r&&"wysiwyg"!==t}function _(e,t){var n=t.source,r=t.data;if(w(e,n,r)){var i=r.text.join("\n");if(0===c(i,"\t")){S.default.COLUMN_SEPARATOR="\t";var o=b(S.default.parse(i));r.update(r.from,r.to,o)}}}function k(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.convertor.getCodeBlockManager(),r=t.languages;(void 0===r?["chart"]:r).forEach(function(e){return n.setReplacer(e,m)}),y(e),e.eventManager.listen("pasteBefore",function(t){return _(e.mdEditor.cm,t)})}Object.defineProperty(t,"__esModule",{value:!0}),t.detectDelimiter=t.parseDSV2ChartData=t.parseCode2ChartOption=t.parseURL2ChartData=t.parseCode2DataAndOptions=void 0;var E=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),T=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},C=n(6),x=r(C),M=n(43),S=r(M),I=n(38),R=r(I);S.default.IGNORE_QUOTE_WHITESPACE=!1,S.default.IGNORE_RECORD_LENGTH=!0,S.default.DETECT_TYPES=!1;var A=tui,O=A.util,N=A.chart,B=/[\n\r]/,D=[",","\t",/\s+/],P=":",L=["barChart","columnChart","lineChart","areaChart","pieChart"],U=["lineChart","areaChart"];x.default.defineExtension("chart",k),t.parseCode2DataAndOptions=l,t.parseURL2ChartData=d,t.parseCode2ChartOption=h,t.parseDSV2ChartData=f,t.detectDelimiter=u},function(e,t,n){"use strict";function r(e){function t(e){var t=void 0;try{if(!plantumlEncoder)throw new Error("plantuml-encoder dependency required");t='<img src="'+a+plantumlEncoder.encode(e)+'" />'}catch(e){t="Error occurred on encoding uml: "+e.message}return t}var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.convertor.getCodeBlockManager(),i=n.rendererURL,a=void 0===i?o:i,l=n.languages;(void 0===l?["plantuml","uml"]:l).forEach(function(e){return r.setReplacer(e,t)})}var i=n(6),o="http://www.plantuml.com/plantuml/png/";(function(e){return e&&e.__esModule?e:{default:e}})(i).default.defineExtension("plantUML",r)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){e.eventManager.addEventType("colorButtonClicked"),e.getUI().toolbar.addButton({className:"tui-color",event:"colorButtonClicked",tooltip:g.default.get("Text color")},4);var n=e.getUI().toolbar.$el.find("button.tui-color"),r=$("<div />"),i=$('<button type="button" class="te-apply-button">입력</button>'),o={container:r[0]};t&&(o.preset=t);var a=tui.component.colorpicker.create(o),l=a.getColor();r.append(i);var s=e.getUI().createPopup({header:!1,title:!1,content:r,className:"tui-popup-color",$target:e.getUI().$el,css:{width:"auto",position:"absolute"}});e.eventManager.listen("focus",function(){s.hide()}),e.eventManager.listen("colorButtonClicked",function(){if(e.eventManager.emit("closeAllPopup"),s.isShow())s.hide();else{var t=n.position();s.$el.css({top:t.top+n.outerHeight(!0),left:t.left}),s.show(),a.slider.toggle(!0)}}),e.eventManager.listen("closeAllPopup",function(){s.hide()}),e.eventManager.listen("removeEditor",function(){a.off("selectColor")}),a.on("selectColor",function(t){l=t.color,"palette"===t.origin&&(e.exec("color",l),s.hide())}),s.$el.find(".te-apply-button").on("click",function(){e.exec("color",l)})}function o(e,t){return l("{color:"+t+"}",e,"{color}")}function a(e,t){return l('<span style="color:'+t+'">',e,"</span>")}function l(e,t,n){return{result:""+e+t+n,from:e.length,to:e.length+t.length}}function s(e){return e.replace(b,function(e,t,n,r){return"#"+u(t)+u(n)+u(r)})}function u(e){var t=parseInt(e,10);return t=t.toString(16),t=c(t)}function c(e){var t="00"+e;return t.substr(t.length-2)}var f=n(6),d=r(f),h=n(3),g=r(h),p=/\{color:(.+?)}(.*?)\{color}/g,v=/<span (?:class="colour" )?style="color:(.+?)"(?: class="colour")?>(.*?)/g,m=/<span (?:class="colour" )?style="color:(.+?)"(?: class="colour")?>(.*?)<\/span>/g,b=/rgb\((\d+)[, ]+(\d+)[, ]+(\d+)\)/g;d.default.defineExtension("colorSyntax",function(e){var t=e.options.colorSyntax,n=void 0===t?{}:t,r=n.preset,l=n.useCustomSyntax,u=void 0!==l&&l;e.eventManager.listen("convertorAfterMarkdownToHtmlConverted",function(e){return u?e.replace(p,function(e,t,n){return a(n,t).result}):e}),e.eventManager.listen("convertorAfterHtmlToMarkdownConverted",function(e){var t=u?m:v;return e.replace(t,function(e,t,n){return t.match(b)&&(t=s(t)),u?o(n,t).result:e.replace(/ ?class="colour" ?/g," ").replace(b,t)})}),e.isViewOnly()||"default"!==e.getUI().name||(e.addCommand("markdown",{name:"color",exec:function(e,t){var n=e.getEditor(),r=n.getCursor("from"),i=n.getCursor("to"),l=void 0,s=void 0;if(t){if(u){var c=o(n.getSelection(),t);l=c.result,s=c.from,n.replaceSelection(l)}else{var f=a(n.getSelection(),t);l=f.result,s=f.from,n.replaceSelection(l)}n.setSelection({line:r.line,ch:r.ch+s},{line:i.line,ch:r.line===i.line?i.ch+s:i.ch}),e.focus()}}}),e.addCommand("wysiwyg",{name:"color",exec:function(e,t){var n=e.getEditor();t&&(n.hasFormat("PRE")||("#181818"===t?n.changeFormat(null,{class:"colour",tag:"span"}):n.setTextColour(t)),e.focus())}}),i(e,r))})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var i=n(6),o=r(i),a=n(45),l=r(a),s=n(46),u=r(s),c=n(48),f=r(c),d=n(47),h=r(d),g=n(44),p=r(g),v=tui,m=v.util,b=/(\n)|(\r\n)|(\r)/g;o.default.defineExtension("mark",function(e){function t(){return e.isViewOnly()?s:e.isWysiwygMode()?o:a}function n(){var n=t();r.getAll().forEach(function(e){n.updateMarkerWithExtraInfo(e)}),e.eventManager.emit("markerUpdated",r.getAll())}var r=new l.default,i=new u.default(r),o=void 0,a=void 0,s=void 0;e.eventManager.addEventType("markerUpdated"),e.isViewOnly()?s=new h.default(e.preview):(o=new f.default(e.getSquire()),a=new p.default(e.getCodeMirror())),$(window).on("resize",n),e.on("removeEditor",function(){$(window).off("resize",n)}),e.on("setMarkdownAfter",function(){var e=t();i.resetContent(e.getTextContent())}),e.setValueWithMarkers=function(n,o){var l=void 0;return r.resetMarkers(),o.forEach(function(e){r.addMarker(e.start,e.end,e.id)}),e.setValue(n),i.resetContent(n.replace(b,"")),e.isViewOnly()||e.isWysiwygMode()?(l=t(),i.updateMarkersByContent(l.getTextContent())):l=a,r.getAll().forEach(function(e){l.updateMarkerWithExtraInfo(e)}),e.eventManager.emit("markerUpdated",r.getAll()),r.getAll()},e.getMarker=function(e){return r.getMarker(e)},e.getMarkersAll=function(){return r.getAll()},e.removeMarker=function(e){return r.removeMarker(e)},e.exportMarkers=function(){var n=void 0;return e.isMarkdownMode()?n=r.getMarkersData():(e.isViewOnly()||e.isWysiwygMode())&&(i.updateMarkersByContent(e.getValue().replace(b,"")),n=r.getMarkersData(),i.updateMarkersByContent(t().getTextContent())),n},e.selectMarker=function(n){var r=t(),i=e.getMarker(n);i&&r.selectOffsetRange(i.start,i.end)},e.addMarker=function(n,i,o){var a=void 0,l=t();return o?(a={start:n,end:i},a=l.updateMarkerWithExtraInfo(a)):(o=n,a=l.getMarkerInfoOfCurrentSelection()),a&&(a.id=o,a=r.addMarker(a),r.sortBy("end"),e.eventManager.emit("markerUpdated",[a])),a},e.clearSelect=function(){t().clearSelect()},e.isViewOnly()||(e.on("changeMode",function(){e._updateMarkers()}),e.on("change",m.debounce(function(){e._updateMarkers()},100)),e._updateMarkers=function(){var n=t();r.getAll().length&&(i.updateMarkersByContent(n.getTextContent()),r.getAll().forEach(function(e){n.updateMarkerWithExtraInfo(e)}),e.eventManager.emit("markerUpdated",r.getAll()))})})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){e.addCommand(O.default),e.addCommand(B.default)}function o(e){e.removeManager("table"),e.removeManager("tableSelection"),e.addManager(b.default),e.addManager(w.default)}function a(e,t){var n=$("<div>"+e+"</div>"),r=n.find("table");return r.length&&(r.get().forEach(function(e){var n=t(e);$(e).replaceWith(n)}),e=n.html()),e}function l(e){var t=e.command;if(t.isWWType())switch(t.getName()){case"AddRow":e.command=k.default;break;case"AddCol":e.command=T.default;break;case"RemoveRow":e.command=x.default;break;case"RemoveCol":e.command=S.default;break;case"AlignCol":e.command=R.default}}function s(e){e.listen("convertorAfterMarkdownToHtmlConverted",function(e){return a(e,d.default)}),e.listen("convertorBeforeHtmlToMarkdownConverted",function(e){return a(e,g.default)}),e.listen("addCommandBefore",l)}var u=n(6),c=r(u),f=n(54),d=r(f),h=n(58),g=r(h),p=n(59),v=r(p),m=n(61),b=r(m),y=n(62),w=r(y),_=n(52),k=r(_),E=n(51),T=r(E),C=n(56),x=r(C),M=n(55),S=r(M),I=n(53),R=r(I),A=n(50),O=r(A),N=n(60),B=r(N),D=n(57),P=r(D);n(49),c.default.defineExtension("tableExtension",function(e){var t=e.eventManager;if(e.toMarkOptions=e.toMarkOptions||{},e.toMarkOptions.renderer=v.default,s(t),!e.isViewOnly()){var n=e.wwEditor.componentManager,r=e._ui.popupTableUtils;i(e),o(n),e._ui.popupTableUtils&&P.default.updateContextMenu(r,t,n.getManager("tableSelection"))}})},function(e,t,n){"use strict";var r=/^\s*\* \[[xX ]\] [^\n]*/gm,i=/^\s*\* \[[xX]\] [^\n]*/gm;n(6).defineExtension("taskCounter",function(e){e.getTaskCount=function(){var t=void 0,n=void 0;return e.isViewOnly()?n=e.preview.$el.find(".task-list-item").length:e.isMarkdownMode()?(t=e.mdEditor.getValue().match(r),n=t?t.length:0):n=e.wwEditor.get$Body().find(".task-list-item").length,n},e.getCheckedTaskCount=function(){var t=void 0,n=void 0;return e.isViewOnly()?n=e.preview.$el.find(".task-list-item.checked").length:e.isMarkdownMode()?(t=e.mdEditor.getValue().match(i),n=t?t.length:0):n=e.wwEditor.get$Body().find(".task-list-item.checked").length,n}})},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=window,l=a.hljs,s=function(){function e(){r(this,e),this._supportedLanguages=l.listLanguages(),this._replacers={}}return o(e,[{key:"setReplacer",value:function(e,t){this._replacers[e]=t,this._supportedLanguages.indexOf(e)<0&&this._supportedLanguages.push(e)}},{key:"getReplacer",value:function(e){return this._replacers[e]}},{key:"setSupportedLanguages",value:function(e){this._supportedLanguages=e}},{key:"getSupportedLanguages",value:function(){return this._supportedLanguages}},{key:"createCodeBlockHtml",value:function(e,t){var n=this.getReplacer(e);return n?n(t,e):l.getLanguage(e)?l.highlight(e,t).value:i(t,!1)}}],[{key:"getHighlightJSLanguages",value:function(){return l.listLanguages()}}]),e}();t.default=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(35),l=r(a),s=n(72),u=r(s),c=n(68),f=r(c),d=n(69),h=r(d),g=n(67),p=r(g),v=n(71),m=r(v),b=n(70),y=r(b),w=n(66),_=r(w),k=n(32),E=r(k),T=window,C=T.toMark,x=T.markdownit,M=function(){function e(t){i(this,e),this.eventManager=t,this._initMarkdownIt()}return o(e,[{key:"_initMarkdownIt",value:function(){var e=new E.default;this._codeBlockManager=e;var t=new x({html:!0,breaks:!0,quotes:"“”‘’",langPrefix:"lang-",highlight:function(t,n){return e.createCodeBlockHtml(n,t)}}),n=new x({html:!0,breaks:!0,quotes:"“”‘’",langPrefix:"lang-"});t.block.ruler.at("code",h.default),t.block.ruler.at("table",m.default,{alt:["paragraph","reference"]}),t.block.ruler.at("blockquote",p.default,{alt:["paragraph","reference","blockquote","list"]}),t.block.ruler.at("html_block",y.default,{alt:["paragraph","reference","blockquote"]}),t.inline.ruler.at("backticks",_.default),t.use(u.default),t.use(f.default),this._markdownitHighlight=t,n.block.ruler.at("code",h.default),n.block.ruler.at("table",m.default,{alt:["paragraph","reference"]}),n.block.ruler.at("blockquote",p.default,{alt:["paragraph","reference","blockquote","list"]}),n.block.ruler.at("html_block",y.default,{alt:["paragraph","reference","blockquote"]}),n.inline.ruler.at("backticks",_.default),n.use(u.default),n.use(f.default),this._markdownit=n}},{key:"_markdownToHtmlWithCodeHighlight",value:function(e){e=e.replace(/<br>/gi,"<br data-tomark-pass>");for(var t=/(<img[^>]*)(onerror\s*=\s*[\"']?[^\"']*[\"']?)(.*)/i;t.exec(e);)e=e.replace(t,"$1$3");var n=this._markdownitHighlight.render(e);return n=this._removeBrToMarkPassAttributeInCode(n)}},{key:"_markdownToHtml",value:function(e){e=e.replace(/<br>/gi,"<br data-tomark-pass>");for(var t=/(<img[^>]*)(onerror\s*=\s*[\"']?[^\"']*[\"']?)(.*)/i;t.exec(e);)e=e.replace(t,"$1$3");var n=this._markdownit.render(e);return n=this._removeBrToMarkPassAttributeInCode(n)}},{key:"_removeBrToMarkPassAttributeInCode",value:function(e){var t=$("<div />");return t.html(e),t.find("code, pre").each(function(e,t){var n=$(t);n.html(n.html().replace(/&lt;br data-tomark-pass&gt;/,"&lt;br&gt;"))}),e=t.html()}},{key:"toHTMLWithCodeHightlight",value:function(e){var t=this._markdownToHtmlWithCodeHighlight(e);return t=this.eventManager.emitReduce("convertorAfterMarkdownToHtmlConverted",t)}},{key:"toHTML",value:function(e){var t=this._markdownToHtml(e);return t=this.eventManager.emitReduce("convertorAfterMarkdownToHtmlConverted",t)}},{key:"initHtmlSanitizer",value:function(){this.eventManager.listen("convertorAfterMarkdownToHtmlConverted",function(e){return(0,l.default)(e,!0)})}},{key:"toMarkdown",value:function(e,t){var n=[];e=this.eventManager.emitReduce("convertorBeforeHtmlToMarkdownConverted",e);var r=C(this._appendAttributeForBrIfNeed(e),t);return r=this.eventManager.emitReduce("convertorAfterHtmlToMarkdownConverted",r),tui.util.forEach(r.split("\n"),function(e,t){var r=/^\|[^|]*\|/gi;/`[^`]*<br>[^`]*`/gi.test(e)||r.test(e)||(e=e.replace(/<br>/gi,"<br>\n")),n[t]=e}),n.join("\n")}},{key:"_appendAttributeForBrIfNeed",value:function(e){var t=/<br>/gi,n=/<br \/><br \/>/gi,r=/<br data-tomark-pass \/><br \/>(.)/gi,i=/([^>]|<\/b>|<\/i>|<\/s>|<img [^>]*>)/,o=/<br data-tomark-pass \/><br data-tomark-pass \/>/,a=new RegExp(i.source+o.source,"g");e=e.replace(t,"<br />"),e=e.replace(n,"<br data-tomark-pass /><br data-tomark-pass />");var l=document.createElement("div"),s=$(l);return s.html(e),s.find("pre br,code br").each(function(e,t){t.hasAttribute("data-tomark-pass")&&t.removeAttribute("data-tomark-pass")}),e=s.html().replace(/<br data-tomark-pass="">/gi,"<br data-tomark-pass />"),e=e.replace(t,"<br />"),e=e.replace(r,"<br data-tomark-pass /><br data-tomark-pass />$1"),e=e.replace(a,"$1<br /><br />")}},{key:"getMarkdownHighlightRenderer",value:function(){return this._markdownitHighlight}},{key:"setMarkdownHighlightRenderer",value:function(e){e.set({html:!0,breaks:!0,quotes:"“”‘’",langPrefix:"lang-"}),this._markdownitHighlight=e}},{key:"getCodeBlockManager",value:function(){return this._codeBlockManager}}]),e}();e.exports=M},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=tui,a=o.util,l=["previewBeforeHook","previewRenderAfter","previewNeedsRefresh","addImageBlobHook","setMarkdownAfter","contentChangedFromWysiwyg","changeFromWysiwyg","contentChangedFromMarkdown","changeFromMarkdown","change","changeModeToWysiwyg","changeModeToMarkdown","changeModeBefore","changeMode","changePreviewStyle","openPopupAddLink","openPopupAddImage","openPopupAddTable","openPopupTableUtils","openHeadingSelect","openPopupCodeBlockLanguages","openPopupCodeBlockEditor","closePopupCodeBlockLanguages","closePopupCodeBlockEditor","closeAllPopup","command","addCommandBefore","htmlUpdate","markdownUpdate","renderedHtmlUpdated","removeEditor","convertorAfterMarkdownToHtmlConverted","convertorBeforeHtmlToMarkdownConverted","convertorAfterHtmlToMarkdownConverted","stateChange","wysiwygSetValueAfter","wysiwygSetValueBefore","wysiwygGetValueBefore","wysiwygProcessHTMLText","wysiwygRangeChangeAfter","wysiwygKeyEvent","scroll","click","mousedown","mouseover","mouseout","mouseup","contextmenu","keydown","keyup","keyMap","load","focus","blur","paste","pasteBefore","willPaste","copy","copyBefore","copyAfter","cut","cutAfter","drop","show","hide"],s=function(){function e(){r(this,e),this.events=new a.Map,this.TYPE=new a.Enum(l)}return i(e,[{key:"listen",value:function(e,t){var n=this._getTypeInfo(e),r=this.events.get(n.type)||[];if(!this._hasEventType(n.type))throw new Error("There is no event type "+n.type);n.namespace&&(t.namespace=n.namespace),r.push(t),this.events.set(n.type,r)}},{key:"emit",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.shift(),i=this._getTypeInfo(r),o=this.events.get(i.type),l=void 0;return o&&a.forEach(o,function(e){var n=e.apply(void 0,t);a.isUndefined(n)||(l=l||[],l.push(n))}),l}},{key:"emitReduce",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.shift(),i=this.events.get(r);return i&&a.forEach(i,function(e){var n=e.apply(void 0,t);a.isFalsy(n)||(t[0]=n)}),t[0]}},{key:"_getTypeInfo",value:function(e){var t=e.split(".");return{type:t[0],namespace:t[1]}}},{key:"_hasEventType",value:function(e){return!a.isUndefined(this.TYPE[this._getTypeInfo(e).type])}},{key:"addEventType",value:function(e){if(this._hasEventType(e))throw new Error("There is already have event type "+e);this.TYPE.set(e)}},{key:"removeEventHandler",value:function(e,t){var n=this,r=this._getTypeInfo(e),i=r.type,o=r.namespace;i&&t?this._removeEventHandlerWithHandler(i,t):i&&!o?this.events.delete(i):!i&&o?this.events.forEach(function(e,t){n._removeEventHandlerWithTypeInfo(t,o)}):i&&o&&this._removeEventHandlerWithTypeInfo(i,o)}},{key:"_removeEventHandlerWithHandler",value:function(e,t){var n=this.events.get(e)||[],r=n.indexOf(t);r>=0&&n.splice(r,1)}},{key:"_removeEventHandlerWithTypeInfo",value:function(e,t){var n=[],r=this.events.get(e);r&&(r.map(function(e){e.namespace!==t&&n.push(e)}),this.events.set(e,n))}}]),e}();e.exports=s},function(e,t,n){"use strict";function r(e,t){var n=$("<div />");return e=e.replace(/<!--[\s\S]*?-->/g,""),n.append(e),i(n),o(n),a(n,t)}function i(e){e.find("script, iframe, textarea, form, button, select, meta, style, link, title").remove()}function o(e){e.find("*").each(function(e,t){var n=s.toArray(t.attributes).filter(function(e){var t=e.name.match(u),n=e.name.match(c);return!t&&!n});s.forEachArray(n,function(e){t.attributes.removeNamedItem(e.name)})})}function a(e,t){var n=void 0;if(t)n=e[0].innerHTML;else{for(var r=document.createDocumentFragment(),i=tui.util.toArray(e[0].childNodes),o=i.length,a=0;a<o;a+=1)r.appendChild(i[a]);n=r}return n}var l=tui,s=l.util,u=new RegExp("^(abbr|align|alt|axis|bgcolor|border|cellpadding|cellspacing|class|clear|color|cols|compact|coords|dir|face|headers|height|hreflang|hspace|ismap|lang|language|nohref|nowrap|rel|rev|rows|rules|scope|scrolling|shape|size|span|start|summary|tabindex|target|title|type|valign|value|vspace|width|checked|mathvariant|encoding|id|name|background|cite|href|longdesc|src|usemap|xlink:href|data-+|checked|style)","g"),c=new RegExp("^(accent-height|accumulate|additive|alphabetic|arabic-form|ascent|baseProfile|bbox|begin|by|calcMode|cap-height|class|color|color-rendering|content|cx|cy|d|dx|dy|descent|display|dur|end|fill|fill-rule|font-family|font-size|font-stretch|font-style|font-variant|font-weight|from|fx|fy|g1|g2|glyph-name|gradientUnits|hanging|height|horiz-adv-x|horiz-origin-x|ideographic|k|keyPoints|keySplines|keyTimes|lang|marker-end|marker-mid|marker-start|markerHeight|markerUnits|markerWidth|mathematical|max|min|offset|opacity|orient|origin|overline-position|overline-thickness|panose-1|path|pathLength|points|preserveAspectRatio|r|refX|refY|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|rotate|rx|ry|slope|stemh|stemv|stop-color|stop-opacity|strikethrough-position|strikethrough-thickness|stroke|stroke-dasharray|stroke-dashoffset|stroke-linecap|stroke-linejoin|stroke-miterlimit|stroke-opacity|stroke-width|systemLanguage|target|text-anchor|to|transform|type|u1|u2|underline-position|underline-thickness|unicode|unicode-range|units-per-em|values|version|viewBox|visibility|width|widths|x|x-height|x1|x2|xlink:actuate|xlink:arcrole|xlink:role|xlink:show|xlink:title|xlink:type|xml:base|xml:lang|xml:space|xmlns|xmlns:xlink|y|y1|y2|zoomAndPan)","g");e.exports=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},s=n(37),u=function(e){return e&&e.__esModule?e:{default:e}}(s),c=function(e){function t(e,n,o,a){r(this,t);var l=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,o,a));return l._initEvent(),l}return o(t,e),a(t,[{key:"_initEvent",value:function(){var e=this,t="";this.eventManager.listen("contentChangedFromMarkdown",function(n){t=n.getValue(),e.isVisible()&&e.lazyRunner.run("refresh",t.replace(/<br>\n/g,"<br>"))}),this.eventManager.listen("previewNeedsRefresh",function(n){e.refresh(n||t)}),this.$el.on("scroll",function(t){e.eventManager.emit("scroll",{source:"preview",data:t})})}},{key:"render",value:function(e){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).call(this,e),this.eventManager.emit("previewRenderAfter",this)}}]),t}(u.default);t.default=c},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(65),a=function(e){return e&&e.__esModule?e:{default:e}}(o),l=function(){function e(t,n,i,o){r(this,e),this.eventManager=n,this.convertor=i,this.$el=t,this.isViewOnly=!!o,this._initContentSection(),this.lazyRunner=new a.default,this.lazyRunner.registerLazyRunFunction("refresh",this.refresh,800,this)}return i(e,[{key:"_initContentSection",value:function(){this._$previewContent=$('<div class="tui-editor-contents" />'),this.$el.append(this._$previewContent)}},{key:"refresh",value:function(e){this.render(this.convertor.toHTMLWithCodeHightlight(e))}},{key:"getHTML",value:function(){return this._$previewContent.html()}},{key:"setHTML",value:function(e){this._$previewContent.html(e)}},{key:"render",value:function(e){var t=this._$previewContent;e=this.eventManager.emit("previewBeforeHook",e)||e,t.empty(),t.html(e)}},{key:"setHeight",value:function(e){this.$el.get(0).style.height=e+"px"}},{key:"setMinHeight",value:function(e){this.$el.get(0).style.minHeight=e+"px"}},{key:"isVisible",value:function(){return"none"!==this.$el.css("display")}}]),e}();e.exports=l},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){return e.replace(/[<>&]/g,function(e){return c[e]||e})}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),l=function(e){return e&&e.__esModule?e:{default:e}}(a),s=tui,u=s.util,c={"&":"&amp;","<":"&lt;",">":"&gt;"},f=/\u200B/g,d=function(){function e(t){r(this,e),this.wwe=t,this.eventManager=t.eventManager,this.name="codeblock",this._init()}return o(e,[{key:"_init",value:function(){this._initKeyHandler(),this._initEvent()}},{key:"_initKeyHandler",value:function(){this.wwe.addKeyEventHandler("BACK_SPACE",this._removeCodeblockIfNeed.bind(this))}},{key:"_initEvent",value:function(){var e=this;this.eventManager.listen("wysiwygSetValueAfter",function(){e.splitCodeblockToEachLine()}),this.eventManager.listen("wysiwygProcessHTMLText",function(t){return e._mergeCodeblockEachlinesFromHTMLText(t)})}},{key:"prepareToPasteOnCodeblock",value:function(e){var t=this.wwe.getEditor().getSelection().cloneRange(),n=this.wwe.getEditor().getDocument().createDocumentFragment();return 1===e.length&&this._isCodeBlock(e[0])?n.appendChild(this._copyCodeblockTypeFromRangeCodeblock(e.shift(),t)):n.appendChild(this._copyCodeblockTypeFromRangeCodeblock(this.convertToCodeblock(e),t)),n}},{key:"convertToCodeblock",value:function(e){for(var t=$("<pre />"),n=this,r=e.shift();u.isTruthy(r);)t.append(n._makeCodeBlockLineHtml(u.isString(r)?r:r.textContent)),r=e.shift();return t.attr("data-te-codeblock",""),t[0]}},{key:"_copyCodeblockTypeFromRangeCodeblock",value:function(e,t){var n=l.default.getParentUntil(t.commonAncestorContainer,this.wwe.get$Body()[0]);if("PRE"===l.default.getNodeName(n)){var r=$(n).prop("attributes");u.forEach(r,function(t){$(e).attr(t.name,t.value)})}return e}},{key:"_mergeCodeblockEachlinesFromHTMLText",value:function(e){return e=e.replace(/<pre( .*?)?>(.*?)<\/pre>/g,function(e,t,n){return n=n.replace(/<br \/>/g,"\n"),n=n.replace(/<div ?(.*?)>/g,""),n=n.replace(/\n$/,""),"<pre><code"+(t||"")+">"+n+"</code></pre>"})}},{key:"splitCodeblockToEachLine",value:function(e){var t=this;e||(e=this.wwe.get$Body()),$(e).find("pre").each(function(e,n){var r=$(n),i=r.find("code").attr("data-language"),o=void 0;r.children().length>1&&(o=[],r.children().each(function(e,t){"DIV"!==t.nodeName&&"P"!==t.nodeName||$(t).find("br").length||$(t).append("<br>")})),r.find("br").replaceWith("\n"),o=r.text().replace(/\s+$/,"").split(/\n/g),i&&(r.attr("data-language",i),r.addClass("lang-"+i)),r.empty(),u.forEach(o,function(e){r.append(t._makeCodeBlockLineHtml(e))}),r.attr("data-te-codeblock","")})}},{key:"_makeCodeBlockLineHtml",value:function(e){return"<div>"+(e=e?i(e):"<br>")+"</div>"}},{key:"_removeCodeblockIfNeed",value:function(e,t){var n=this;if(!this.isInCodeBlock(t))return!0;var r=$(t.startContainer).closest("pre"),i=$(r).find("div").eq(0),o=i.text().replace(f,"");return 0!==t.startOffset&&0!==o.length||!($(r).find("div").length<=1)||(this.wwe.getEditor().modifyBlocks(function(){var e=n.wwe.getEditor().getDocument().createDocumentFragment(),t=void 0;return t=0===o.length?"<br>":i.html().replace(f,""),$(e).append($("<div>"+t+"</div>")),e}),!1)}},{key:"isInCodeBlock",value:function(e){var t=void 0;return t=e.collapsed?e.startContainer:e.commonAncestorContainer,this._isCodeBlock(t)}},{key:"_isCodeBlock",value:function(e){return!!$(e).closest("pre").length}}]),e}();e.exports=d},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n="<"+t+"><br /></"+t+">",r="",i=0;i<e;i+=1)r+=n;return r}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),l=function(e){return e&&e.__esModule?e:{default:e}}(a),s=tui,u=s.util,c=u.browser.msie&&10===u.browser.version,f=u.browser.msie&&(10===u.browser.version||11===u.browser.version),d=u.browser.msie?"":"<br>",h=function(){function e(t){r(this,e),this.wwe=t,this.eventManager=t.eventManager,this.name="table",this._lastCellNode=null,this._init()}return o(e,[{key:"_init",value:function(){this._initKeyHandler(),this._initEvent(),this.tableID=0}},{key:"_initEvent",value:function(){var e=this;this.eventManager.listen("wysiwygRangeChangeAfter.table",function(){var t=e.wwe.getEditor().getSelection(),n=e.isInTable(t);if(e._unwrapBlockInTable(),e._completeTableIfNeed(),!n){e.wwe.componentManager.getManager("tableSelection").removeClassAttrbuteFromAllCellsIfNeed()}e._insertDefaultBlockBetweenTable()}),this.eventManager.listen("wysiwygSetValueAfter.table",function(){e._unwrapBlockInTable(),e._insertDefaultBlockBetweenTable()}),this.eventManager.listen("wysiwygProcessHTMLText.table",function(e){return e.replace(/<br \/>(<\/td>|<\/th>)/g,"$1")}),this.eventManager.listen("cut.table",function(){var t=e.wwe.componentManager.getManager("tableSelection"),n=t.getSelectedCells();n.length&&n.get().forEach(function(e){return $(e).html(d)}),t.removeClassAttrbuteFromAllCellsIfNeed()}),this.eventManager.listen("copyBefore.table",function(t){var n=t.$clipboardContainer;return e.updateTableHtmlOfClipboardIfNeed(n)}),this.onBindedPaste=this._onPaste.bind(this),this.wwe.getEditor().addEventListener("paste",this.onBindedPaste)}},{key:"updateTableHtmlOfClipboardIfNeed",value:function(e){var t=this,n=this.wwe.componentManager.getManager("tableSelection");if(n.getSelectedCells().length){n.createRangeBySelectedCells();var r=this.wwe.getEditor().getSelection().cloneContents();$(r).children().each(function(e,n){var r=$(n);t.isTableOrSubTableElement(n.nodeName)&&("TABLE"===n.nodeName&&0===r.find("thead").length&&0===r.find("tbody").length?r.remove():n.previousSibling&&"TABLE"===n.previousSibling.nodeName?n.previousSibling.appendChild(n):(t._completeIncompleteTable(n),"TABLE"!==n.nodeName&&"THEAD"!==n.nodeName&&$(n).closest("table").find("thead").remove()))}),e.append(r),e.find(".te-cell-selected").removeClass("te-cell-selected")}}},{key:"pasteClipboardData",value:function(e){this.wwe.componentManager.getManager("tableSelection").getSelectedCells().length||(this._expandTableIfNeed(e),this._pasteDataIntoTable(e))}},{key:"_onPaste",value:function(e){var t=this.wwe.getEditor().getSelection(),n=!l.default.isTextNode(t.commonAncestorContainer);this.isInTable(t)&&!t.collapsed&&n&&e.preventDefault()}},{key:"_initKeyHandler",value:function(){var e=this;this.keyEventHandlers={DEFAULT:function(t,n,r){var i=e.isInTable(n);i&&!e._isSingleModifierKey(r)?(e._recordUndoStateIfNeed(n),e._removeBRIfNeed(n),e._removeContentsAndChangeSelectionIfNeed(n,r,t)):!i&&e._lastCellNode&&e._recordUndoStateAndResetCellNode(n),i&&!e._isModifierKeyPushed(t)&&e.wwe.getEditor().modifyDocument(function(){e.wwe.componentManager.getManager("tableSelection").removeClassAttrbuteFromAllCellsIfNeed()})},ENTER:function(t,n){var r=void 0;return e._isAfterTable(n)?(t.preventDefault(),n.setStart(n.startContainer,n.startOffset-1),e.wwe.breakToNewDefaultBlock(n),r=!1):e._isBeforeTable(n)?(t.preventDefault(),e.wwe.breakToNewDefaultBlock(n,"before"),r=!1):e.isInTable(n)&&(e._appendBrIfTdOrThNotHaveAsLastChild(n),r=!1),r},BACK_SPACE:function(t,n,r){return e._handleBackspaceAndDeleteKeyEvent(t,n,r)},DELETE:function(t,n,r){return e._handleBackspaceAndDeleteKeyEvent(t,n,r)},TAB:function(){return e._moveCursorTo("next","cell")},"SHIFT+TAB":function(t){return e._moveCursorTo("previous","cell",t)},UP:function(t){return e._moveCursorTo("previous","row",t)},DOWN:function(t){return e._moveCursorTo("next","row",t)}},u.forEach(this.keyEventHandlers,function(t,n){return e.wwe.addKeyEventHandler(n,t)})}},{key:"isInTable",value:function(e){var t=void 0,n=void 0;return e.collapsed?(t=e.startContainer,n=!!$(t).closest("[contenteditable=true] table").length):(t=e.commonAncestorContainer,n=!!$(t).closest("[contenteditable=true] table").length||!!$(e.cloneContents()).find("table").length),n}},{key:"_isBeforeTable",value:function(e){return"TABLE"===l.default.getNodeName(l.default.getChildNodeByOffset(e.startContainer,e.startOffset))}},{key:"_isAfterTable",value:function(e){var t=l.default.getPrevOffsetNodeUntil(e.startContainer,e.startOffset);return"TABLE"===l.default.getNodeName(t)&&e.commonAncestorContainer===this.wwe.get$Body()[0]}},{key:"_handleBackspaceAndDeleteKeyEvent",value:function(e,t,n){var r="BACK_SPACE"===n,i=this.wwe.componentManager.getManager("tableSelection"),o=i.getSelectedCells(),a=!0;if(t.collapsed){if(this.isInTable(t))r?this._tableHandlerOnBackspace(t,e):this._tableHandlerOnDelete(t,e),this._insertBRIfNeed(t),this._removeContentsAndChangeSelectionIfNeed(t,n,e),a=!1;else if(!r&&this._isBeforeTable(t)||r&&this._isAfterTable(t)){e.preventDefault();var s=r?t.startOffset-1:t.startOffset;this._removeTable(t,l.default.getChildNodeByOffset(t.startContainer,s)),a=!1}}else if(this.isInTable(t)&&o.length>0){var u=this._removeContentsAndChangeSelectionIfNeed(t,n,e);u&&(e.preventDefault(),a=!1)}return a}},{key:"_tableHandlerOnBackspace",value:function(e,t){var n=l.default.getPrevOffsetNodeUntil(e.startContainer,e.startOffset,"TR"),r=l.default.getNodeName(n);n&&"TD"!==r&&"TH"!==r?"BR"===r&&1!==n.parentNode.childNodes.length&&(t.preventDefault(),$(n).remove()):t.preventDefault()}},{key:"isNonTextDeleting",value:function(e){var t=e.startContainer,n=t.nextSibling,r=l.default.getNodeName(n),i=l.default.getNodeName(t),o=i===r&&"TEXT"!==i,a=(!n||"BR"===r&&n.parentNode.lastChild===n)&&l.default.isTextNode(t)&&e.startOffset===t.nodeValue.length,s=!a&&$(t).parents("tr").children().last()[0]===t&&("TD"===i||"TH"===i);return o||a||s}},{key:"_tableHandlerOnDelete",value:function(e,t){this.isNonTextDeleting(e)&&(t.preventDefault(),e.startContainer.normalize())}},{key:"_appendBrIfTdOrThNotHaveAsLastChild",value:function(e){var t=l.default.getNodeName(e.startContainer),n=void 0;if("TD"===t||"TH"===t)n=e.startContainer;else{var r=$(e.startContainer).parentsUntil("tr");n=r[r.length-1]}"BR"===l.default.getNodeName(n.lastChild)||"DIV"===l.default.getNodeName(n.lastChild)||f||$(n).append($("<br />")[0])}},{key:"_unwrapBlockInTable",value:function(){this.wwe.get$Body().find("td div,th div,tr>br,td>br,th>br").each(function(e,t){if("BR"===l.default.getNodeName(t)){var n=l.default.getNodeName(t.parentNode),r=/TD|TH/.test(n),i=0===t.parentNode.textContent.length,o=t.parentNode.lastChild===t;("TR"===n||r&&!i&&o)&&$(t).remove()}else $(t).children().unwrap()})}},{key:"_insertDefaultBlockBetweenTable",value:function(){this.wwe.get$Body().find("table").each(function(e,t){t.nextElementSibling&&"TABLE"===t.nextElementSibling.nodeName&&$("<div><br /></div>").insertAfter(t)})}},{key:"_removeTable",value:function(e,t){"TABLE"===t.tagName&&(this.wwe.getEditor().saveUndoState(e),this.wwe.saveSelection(e),$(t).remove(),this.wwe.restoreSavedSelection())}},{key:"_recordUndoStateIfNeed",value:function(e){var t=l.default.getParentUntil(e.startContainer,"TR");e.collapsed&&t&&this._lastCellNode!==t&&(this.wwe.getEditor().saveUndoState(e),this._lastCellNode=t)}},{key:"_recordUndoStateAndResetCellNode",value:function(e){this.wwe.getEditor().saveUndoState(e),this.resetLastCellNode()}},{key:"_pasteDataIntoTable",value:function(e){var t=this.wwe.getEditor().getSelection(),n=t.startContainer,r=n.parentNode,i=this._getTableDataFromTable(e),o="TD"===r.tagName||"TH"===r.tagName,a="TD"===n.tagName||"TH"===n.tagName,s=3===n.nodeType,u=c?"":"<br />",f=void 0,d=void 0,h=void 0,g=void 0;for(f=s&&o?r:a?n:$(n).find("th,td").get(0),d=f;i.length;){for(h=i.shift();d&&h.length;)g=h.shift(),g.length?d.textContent=g:d.innerHTML=u,d=l.default.getTableCellByDirection(d,"next");d=l.default.getSiblingRowCellByDirection(f,"next",!1),f=d}}},{key:"_getTableDataFromTable",value:function(e){var t=$(e),n=[];return t.find("tr").each(function(e,t){var r=[];$(t).children().each(function(e,t){r.push(t.textContent)}),r.length&&n.push(r)}),n}},{key:"_removeTableContents",value:function(e){this.wwe.getEditor().saveUndoState(),e.each(function(e,t){var n=c?"":"<br />";$(t).html(n)})}},{key:"wrapDanglingTableCellsIntoTrIfNeed",value:function(e){var t=e.children("td,th"),n=void 0;if(t.length){var r=$("<tr></tr>");t.each(function(e,t){r.append(t)}),n=r.get(0)}return n}},{key:"wrapTrsIntoTbodyIfNeed",value:function(e){var t=e.children("tr"),n=t.find("th"),r=void 0;if(n.length&&n.each(function(e,t){var n=$(t),r=$("<td></td>");r.html(n.html()),r.insertBefore(t),n.detach()}),t.length){var i=$("<tbody></tbody>");t.each(function(e,t){i.append(t)}),r=i.get(0)}return r}},{key:"wrapTheadAndTbodyIntoTableIfNeed",value:function(e){var t=e.children("thead"),n=e.children("tbody"),r=$("<table></table>"),i=void 0;return!n.length&&t.length?(r.append(t[0]),r.append("<tbody><tr></tr></tbody>"),i=r.get(0)):n.length&&!t.length?(r.append("<thead><tr></tr></thead>"),r.append(n[0]),i=r.get(0)):n.length&&t.length&&(r.append(t[0]),r.append(n[0]),i=r.get(0)),i}},{key:"isTableOrSubTableElement",value:function(e){return"TABLE"===e||"TBODY"===e||"THEAD"===e||"TR"===e||"TD"===e}},{key:"_stuffTableCellsIntoIncompleteRow",value:function(e,t){e.each(function(e,n){for(var r=$(n),o=r.find("th,td"),a=l.default.getNodeName(r.parent()[0]),s="THEAD"===a?"th":"td",u=o.length;u<t;u+=1)r.append($(i(1,s))[0])})}},{key:"prepareToTableCellStuffing",value:function(e){var t=e.eq(0).find("th,td").length,n=!1;return e.each(function(e,r){var i=$(r).find("th,td").length;t!==i&&(n=!0,t<i&&(t=i))}),{maximumCellLength:t,needTableCellStuffingAid:n}}},{key:"_addTbodyOrTheadIfNeed",value:function(e){var t=!e.find("thead").length,n=!e.find("tbody").length,r=void 0;t?(r=$("<thead><tr></tr></thead>").get(0),e.prepend(r)):n&&(r=$("<tbody><tr></tr></tbody>").get(0),e.append(r))}},{key:"tableCellAppendAidForTableElement",value:function(e){var t=$(e);this._addTbodyOrTheadIfNeed(t),this._addTrIntoContainerIfNeed(t);var n=t.find("tr"),r=this.prepareToTableCellStuffing(n),i=r.maximumCellLength;r.needTableCellStuffingAid&&this._stuffTableCellsIntoIncompleteRow(n,i)}},{key:"_generateTheadAndTbodyFromTbody",value:function(e){var t=$("<tr></tr>"),n=$("<thead></thead>");return t.append(i($(e).find("tr").eq(0).find("td").length,"th")),n.append(t),{thead:n[0],tbody:e}}},{key:"_generateTheadAndTbodyFromThead",value:function(e){var t=$("<tr></tr>"),n=$("<tbody></tbody>");return t.append(i($(e).find("th").length,"td")),n.append(t),{thead:e,tbody:n[0]}}},{key:"_generateTheadAndTbodyFromTr",value:function(e){var t=$(e),n=$("<thead></thead>"),r=$("<tbody></tbody>"),o=void 0,a=void 0;return"TH"===t.children()[0].tagName?(o=e,a=$("<tr>"+i(t.find("th").length,"td")+"</tr>").get(0)):(o=$("<tr>"+i(t.find("td").length,"th")+"</tr>").get(0),a=e),n.append(o),r.append(a),{thead:n[0],tbody:r[0]}}},{key:"_completeIncompleteTable",value:function(e,t){var n=e.tagName,r=void 0,i=void 0;t=!!u.isUndefined(t)||t,"TABLE"===n?r=e:(r=$("<table></table>"),r.insertAfter(e),"TBODY"===n?i=this._generateTheadAndTbodyFromTbody(e):"THEAD"===n?i=this._generateTheadAndTbodyFromThead(e):"TR"===n&&(i=this._generateTheadAndTbodyFromTr(e)),t&&r.append(i.thead),r.append(i.tbody)),this.tableCellAppendAidForTableElement(r)}},{key:"_completeTableIfNeed",value:function(){var e=this;this.wwe.getEditor().get$Body().children().each(function(t,n){var r=$(n);e.isTableOrSubTableElement(n.nodeName)&&("TABLE"===n.nodeName&&0===r.find("thead").length&&0===r.find("tbody").length&&r.remove(),e._completeIncompleteTable(n))})}},{key:"resetLastCellNode",value:function(){this._lastCellNode=null}},{key:"setLastCellNode",value:function(e){this._lastCellNode=e}},{key:"_isSingleModifierKey",value:function(e){return"META"===e||"SHIFT"===e||"ALT"===e||"CONTROL"===e}},{key:"_isModifierKeyPushed",value:function(e){return e.metaKey||e.ctrlKey||e.altKey||e.shiftKey}},{key:"_addTrIntoContainerIfNeed",value:function(e){e.children().each(function(e,t){0===$(t).find("tr").length&&$(t).append($("<tr></tr>")[0])})}},{key:"_expandTableIfNeed",value:function(e){var t=this.wwe.getEditor().getSelection().cloneRange(),n=$(t.startContainer).parents("table"),r=this._getColumnAndRowDifference(e,t);r.column<0&&this._appendCellForAllRow(n,r.column),r.row<0&&this._appendRow(n,r.row)}},{key:"_getColumnAndRowDifference",value:function(e,t){var n=this._getTableDataFromTable(e),r=n.length,i=n[0].length,o=$(t.startContainer).closest("th,td"),a=o.parent(),s=l.default.getNodeOffsetOfParent(o[0]),u=l.default.getNodeOffsetOfParent(o[0].parentNode),c=a.parents("table"),f=c.find("tr").eq(0).children().length,d=c.find("tr").length;return a.parents("tbody").length&&(u+=1),{row:d-(u+r),column:f-(s+i)}}},{key:"_appendCellForAllRow",value:function(e,t){var n=c?"":"<br />";e.find("tr").each(function(e,r){for(var i=void 0,o=t;o<0;o+=1)i=0===e?"th":"td",$(r).append($("<"+i+">"+n+"</"+i+">")[0])})}},{key:"_appendRow",value:function(e,t){var n=e.find("tr").last().clone(),r=c?"":"<br />";for(n.find("td").html(r);t<0;t+=1)e.find("tbody").append(n.clone()[0])}},{key:"_getSiblingTextNodeByDirection",value:function(e,t){var n=e.previousSibling&&"BR"===e.previousSibling.nodeName&&e.previousSibling.previousSibling&&3===e.previousSibling.previousSibling.nodeType,r=e.nextSibling&&"BR"===e.nextSibling.nodeName&&e.nextSibling.nextSibling&&3===e.nextSibling.nextSibling.nodeType,i=void 0;return t&&r?i=e.nextSibling.nextSibling:!t&&n&&(i=e.previousSibling.previousSibling),i}},{key:"_changeSelectionToTargetCell",value:function(e,t,n,r){var i=t.startContainer,o="next"===n,a="row"===r,s=void 0,u=void 0;if(a){if(l.default.isTextNode(i)&&(s=this._getSiblingTextNodeByDirection(i,o)))return u=s.length<t.startOffset?s.length:t.startOffset,t.setStart(s,u),void t.collapse(!0);s=l.default.getSiblingRowCellByDirection(e,n,!1)}else(s=l.default.getTableCellByDirection(e,n))||(s=l.default.getSiblingRowCellByDirection(e,n,!0));s?(t.setStart(s,0),t.collapse(!0)):(s=$(e).parents("table").get(0),o?t.setStart(s.nextElementSibling,0):s.previousElementSibling&&"TABLE"!==s.previousElementSibling.nodeName?t.setStart(s.previousElementSibling,1):t.setStartBefore(s),t.collapse(!0))}},{key:"_moveCursorTo",value:function(e,t,n){var r=this.wwe.getEditor(),i=r.getSelection().cloneRange(),o=$(i.startContainer).closest("td,th").get(0),a=void 0;return i.collapsed&&this.isInTable(i)&&o&&("previous"!==e&&"row"!==t||u.isUndefined(n)||n.preventDefault(),this._changeSelectionToTargetCell(o,i,e,t),r.setSelection(i),a=!1),a}},{key:"_removeContentsAndChangeSelectionIfNeed",value:function(e,t,n){var r=t.length<=1,i="BACK_SPACE"===t||"DELETE"===t,o=this.wwe.componentManager.getManager("tableSelection").getSelectedCells(),a=o.first().get(0),l=!1;return(r||i)&&!this._isModifierKeyPushed(n)&&o.length&&(i&&this._recordUndoStateIfNeed(e),this._removeTableContents(o),this._lastCellNode=a,e.setStart(a,0),e.collapse(!0),this.wwe.getEditor().setSelection(e),l=!0),l}},{key:"getTableIDClassName",value:function(){var e="te-content-table-"+this.tableID;return this.tableID+=1,e}},{key:"_removeBRIfNeed",value:function(e){var t=l.default.isTextNode(e.startContainer),n=t?e.startContainer.parentNode:e.startContainer;/td|th/i.test(l.default.getNodeName(n))&&e.collapsed&&1===n.textContent.length&&$(n).find("br").remove()}},{key:"_insertBRIfNeed",value:function(e){var t=l.default.isTextNode(e.startContainer),n=t?e.startContainer.parentNode:e.startContainer,r=l.default.getNodeName(n),i=$(n);!/td|th/i.test(r)||!e.collapsed||n.textContent.length||i.children().length||f||(n.normalize(),i.append("<br>"))}},{key:"destroy",value:function(){var e=this;this.eventManager.removeEventHandler("wysiwygRangeChangeAfter.table"),this.eventManager.removeEventHandler("wysiwygSetValueAfter.table"),this.eventManager.removeEventHandler("wysiwygProcessHTMLText.table"),this.eventManager.removeEventHandler("cut.table"),this.eventManager.removeEventHandler("copyBefore.table"),this.wwe.getEditor().removeEventListener("paste",this.onBindedPaste),u.forEach(this.keyEventHandlers,function(t,n){return e.wwe.removeKeyEventHandler(n,t)})}}]),e}();e.exports=h},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1),a=function(e){return e&&e.__esModule?e:{default:e}}(o),l=function(){function e(t){r(this,e),this.wwe=t,this.eventManager=t.eventManager,this.name="tableSelection",this._init()}return i(e,[{key:"_init",value:function(){this._initEvent(),tui.util.browser.firefox&&(document.execCommand("enableObjectResizing",!1,"false"),document.execCommand("enableInlineTableEditing",!1,"false"))}},{key:"_initEvent",value:function(){var e=this,t=void 0,n=void 0,r=void 0;this._tableSelectionTimer=null,this._removeSelectionTimer=null,this._isSelectionStarted=!1;var i=function(i){n=$(i.data.target).closest("[contenteditable=true] td,th").get(0);var o=e.wwe.getEditor().getSelection(),a=$(n).parents("[contenteditable=true] table").get(0),l=t===n,s=e._isTextSelect(o,l)&&!$(t).hasClass("te-cell-selected");e._isSelectionStarted&&a&&!s&&(window.getSelection().removeAllRanges(),tui.util.browser.firefox&&!e._removeSelectionTimer&&(e._removeSelectionTimer=setInterval(function(){window.getSelection().removeAllRanges()},10)),e.highlightTableCellsBy(t,n),r=n)},o=function(){e._isSelectionStarted&&(e._isSelectionStarted=!1,e.eventManager.removeEventHandler("mouseover.tableSelection"),e.eventManager.removeEventHandler("mouseup.tableSelection"))},a=function(i){n=$(i.data.target).closest("[contenteditable=true] td,th").get(0);var a=e.wwe.getEditor().getSelection(),l=t===n,s=e._isTextSelect(a,l)&&!$(t).hasClass("te-cell-selected");e._clearTableSelectionTimerIfNeed(),e._isSelectionStarted&&(s?e.removeClassAttrbuteFromAllCellsIfNeed():(e.wwe.componentManager.getManager("table").resetLastCellNode(),n=n||r,a=e.wwe.getEditor().getSelection(),a.setStart(n,0),tui.util.browser.msie?a.setEnd(n,1):(a.setEnd(n,0),a.collapse(!1)),e.wwe.getEditor().setSelection(a)),e.onDragEnd&&e.onDragEnd()),o()},l=function(r){t=$(r.data.target).closest("[contenteditable=true] td,th").get(0);var l=$(t).hasClass("te-cell-selected");n=null,!l||l&&2!==r.data.button?(e.removeClassAttrbuteFromAllCellsIfNeed(),e.setTableSelectionTimerIfNeed(t),e.eventManager.listen("mouseover.tableSelection",i),e.eventManager.listen("mouseup.tableSelection",a),e.onDragStart&&t&&e.onDragStart(t)):2===r.data.button&&o()};this.eventManager.listen("mousedown.tableSelection",l),this.eventManager.listen("copyBefore.tableSelection",o),this.eventManager.listen("pasteBefore.tableSelection",o)}},{key:"_isTextSelect",value:function(e,t){return/TD|TH|TEXT/i.test(e.commonAncestorContainer.nodeName)&&t}},{key:"setTableSelectionTimerIfNeed",value:function(e){$(e).parents("[contenteditable=true] table").length&&(this._isSelectionStarted=!0)}},{key:"_clearTableSelectionTimerIfNeed",value:function(){clearTimeout(this._tableSelectionTimer),tui.util.browser.firefox&&this._removeSelectionTimer&&(clearTimeout(this._removeSelectionTimer),this._removeSelectionTimer=null)}},{key:"_reArrangeSelectionIfneed",value:function(e,t){var n=$(e).parents("[contenteditable=true] table").length,r=$(t).parents("[contenteditable=true] table").length,i=r&&!n,o=!r&&n;return i?e=$(t).parents("[contenteditable=true] table").find("th").first().get(0):o&&(t=$(e).parents("[contenteditable=true] table").find("td").last().get(0)),{startContainer:e,endContainer:t}}},{key:"_applySelectionDirection",value:function(e,t){var n=a.default.getNodeOffsetOfParent,r=e.startContainer,i=e.endContainer,o=n($(r).closest("[contenteditable=true] tr")[0])-n($(i).closest("[contenteditable=true] tr")[0]),l=n(r)-n(i),s=0===o,u=o<0,c=l>0;return s?c?(t.setStart(i,0),t.setEnd(r,1)):(t.setStart(r,0),t.setEnd(i,1)):u?(t.setStart(r,0),t.setEnd(i,1)):(t.setStart(i,0),t.setEnd(r,1)),t}},{key:"getSelectionRangeFromTable",value:function(e,t){var n=a.default.getNodeOffsetOfParent,r=n(e.parentNode),i=n(t.parentNode),o=n(e),l=n(t),s=a.default.getParentUntil(e,"TABLE"),u=a.default.getParentUntil(t,"TABLE"),c="TBODY"===a.default.getNodeName(s)&&"THEAD"===a.default.getNodeName(u),f=s!==u,d=!!$(e).parents("tbody").length&&!!$(t).parents("tbody").length,h={row:r,cell:o},g={row:i,cell:l},p=void 0,v=void 0;return c?h.row+=1:f?g.row+=1:d&&(h.row+=1,g.row+=1),r>i||r===i&&o>l?(p=g,v=h):(p=h,v=g),{from:p,to:v}}},{key:"highlightTableCellsBy",value:function(e,t){var n=$(e).parents("[contenteditable=true] table").find("tr"),r=this.getSelectionRangeFromTable(e,t),i=r.from.row,o=r.from.cell,a=r.to.row,l=r.to.cell;n.each(function(e,t){$(t).find("td,th").each(function(t,n){var r=$(n),s=e===i,u=e===a;s&&t<o||u&&t>l||e<i||e>a?r.removeClass("te-cell-selected"):r.addClass("te-cell-selected")})})}},{key:"removeClassAttrbuteFromAllCellsIfNeed",value:function(){this.wwe.get$Body().find("td.te-cell-selected,th.te-cell-selected").each(function(e,t){var n=$(t);n.removeClass("te-cell-selected"),n.attr("class").length||n.removeAttr("class")})}},{key:"getSelectedCells",value:function(){return this.wwe.get$Body().find(".te-cell-selected")}},{key:"createRangeBySelectedCells",value:function(){var e=this.wwe.getEditor(),t=e.getSelection().cloneRange(),n=this.getSelectedCells(),r=this.wwe.componentManager.getManager("table"),i=n.first().get(0),o=n.last().get(0);n.length&&r.isInTable(t)&&(t.setStart(i,0),t.setEnd(o,o.childNodes.length),e.setSelection(t))}},{key:"styleToSelectedCells",value:function(e){this.createRangeBySelectedCells(),e(this.wwe.getEditor())}},{key:"destroy",value:function(){this.eventManager.removeEventHandler("mousedown.tableSelection"),this.eventManager.removeEventHandler("mouseover.tableSelection"),this.eventManager.removeEventHandler("mouseup.tableSelection"),this.eventManager.removeEventHandler("copyBefore.tableSelection"),this.eventManager.removeEventHandler("pasteBefore.tableSelection")}}]),e}();e.exports=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(36),l=r(a),s=n(34),u=r(s),c=n(0),f=r(c),d=n(6),h=r(d),g=n(33),p=r(g),v=tui,m=v.util,b=function(){function e(t){var n=this;i(this,e),this.options=t,this.eventManager=new u.default,this.commandManager=new f.default(this),this.convertor=new p.default(this.eventManager),this.toMarkOptions=null,this.options.hooks&&m.forEach(this.options.hooks,function(e,t){n.addHook(t,e)}),this.options.events&&m.forEach(this.options.events,function(e,t){n.on(t,e)}),this.preview=new l.default($(this.options.el),this.eventManager,this.convertor,!0),this.preview.$el.on("mousedown",$.proxy(this._toggleTask,this)),h.default.applyExtension(this,this.options.exts),this.setValue(this.options.initialValue),this.eventManager.emit("load",this)}return o(e,[{key:"_toggleTask",value:function(e){var t=e.offsetX<18&&e.offsetY>18;e.target.hasAttribute("data-te-task")&&!t&&($(e.target).toggleClass("checked"),this.eventManager.emit("change",{source:"viewOnly",data:e}))}},{key:"getMarkdownHighlightRenderer",value:function(){return this.convertor.getMarkdownHighlightRenderer()}},{key:"setMarkdownHighlightRenderer",value:function(e){this.convertor.setMarkdownHighlightRenderer(e)}},{key:"setMarkdown",value:function(e){this.markdownValue=e=e||"",this.preview.refresh(this.markdownValue),this.eventManager.emit("setMarkdownAfter",this.markdownValue)}},{key:"setValue",value:function(e){this.setMarkdown(e)}},{key:"on",value:function(e,t){this.eventManager.listen(e,t)}},{key:"off",value:function(e){this.eventManager.removeEventHandler(e)}},{key:"remove",value:function(){this.eventManager.emit("removeEditor"),this.preview.$el.off("mousedown",$.proxy(this._toggleTask,this)),this.options=null,this.eventManager=null,this.commandManager=null,this.convertor=null,this.preview=null}},{key:"addHook",value:function(e,t){this.eventManager.removeEventHandler(e),this.eventManager.listen(e,t)}},{key:"isViewOnly",value:function(){return!0}},{key:"isMarkdownMode",value:function(){return!1}},{key:"isWysiwygMode",value:function(){return!1}}]),e}();e.exports=b},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=tui,a=o.util,l=function(){function e(t,n,i){r(this,e),this.name=t,this.type=n,i&&this.setKeyMap(i)}return i(e,[{key:"getName",value:function(){return this.name}},{key:"getType",value:function(){return this.type}},{key:"isMDType",value:function(){return this.type===e.TYPE.MD}},{key:"isWWType",value:function(){return this.type===e.TYPE.WW}},{key:"isGlobalType",value:function(){return this.type===e.TYPE.GB}},{key:"setKeyMap",value:function(e,t){this.keyMap=[e,t]}}]),e}();l.factory=function(e,t){var n=void 0;"markdown"===e?n=l.TYPE.MD:"wysiwyg"===e?n=l.TYPE.WW:"global"===e&&(n=l.TYPE.GB);var r=new l(t.name,n);return a.extend(r,t),r},l.TYPE={MD:0,WW:1,GB:2},e.exports=l},function(e,t,n){"use strict";"function"==typeof Symbol&&Symbol.iterator;!function(r){var i={};i.RELAXED=!1,i.IGNORE_RECORD_LENGTH=!1,i.IGNORE_QUOTES=!1,i.LINE_FEED_OK=!0,i.CARRIAGE_RETURN_OK=!0,i.DETECT_TYPES=!0,i.IGNORE_QUOTE_WHITESPACE=!0,i.DEBUG=!1,i.COLUMN_SEPARATOR=",",i.ERROR_EOF="UNEXPECTED_END_OF_FILE",i.ERROR_CHAR="UNEXPECTED_CHARACTER",i.ERROR_EOL="UNEXPECTED_END_OF_RECORD",i.WARN_SPACE="UNEXPECTED_WHITESPACE";i.parse=function(e){var t=i.result=[];i.COLUMN_SEPARATOR=i.COLUMN_SEPARATOR instanceof RegExp?new RegExp("^"+i.COLUMN_SEPARATOR.source):i.COLUMN_SEPARATOR,i.offset=0,i.str=e,i.record_begin(),i.debug("parse()",e);for(var n;;){if(n=e[i.offset++],i.debug("c",n),null==n){i.escaped&&i.error(i.ERROR_EOF),i.record&&(i.token_end(),i.record_end()),i.debug("...bail",n,i.state,i.record),i.reset();break}if(null==i.record){if(i.RELAXED&&("\n"==n||"\r"==n&&"\n"==e[i.offset+1]))continue;i.record_begin()}if(0==i.state){if((" "===n||"\t"===n)&&'"'==i.next_nonspace()){if(i.RELAXED||i.IGNORE_QUOTE_WHITESPACE)continue;i.warn(i.WARN_SPACE)}if('"'==n&&!i.IGNORE_QUOTES){i.debug("...escaped start",n),i.escaped=!0,i.state=1;continue}i.state=1}1==i.state&&i.escaped?'"'==n?'"'==e[i.offset]?(i.debug("...escaped quote",n),i.token+='"',i.offset++):(i.debug("...escaped end",n),i.escaped=!1,i.state=2):(i.token+=n,i.debug("...escaped add",n,i.token)):"\r"==n?("\n"==e[i.offset]?i.offset++:i.CARRIAGE_RETURN_OK||i.error(i.ERROR_CHAR),i.token_end(),i.record_end()):"\n"==n?(i.LINE_FEED_OK||i.RELAXED||i.error(i.ERROR_CHAR),i.token_end(),i.record_end()):i.test_regex_separator(e)||i.COLUMN_SEPARATOR==n?i.token_end():1==i.state?(i.token+=n,i.debug("...add",n,i.token)):" "===n||"\t"===n?i.IGNORE_QUOTE_WHITESPACE||i.error(i.WARN_SPACE):i.RELAXED||i.error(i.ERROR_CHAR)}return t},i.stream=function(){var e=n(25),t=new e.Transform({objectMode:!0});return t.EOL="\n",t.prior="",t.emitter=function(e){return function(t){e.push(i.parse(t+e.EOL))}}(t),t._transform=function(e,t,n){var r=""==this.prior?e.toString().split(this.EOL):(this.prior+e.toString()).split(this.EOL);this.prior=r.pop(),r.forEach(this.emitter),n()},t._flush=function(e){""!=this.prior&&(this.emitter(this.prior),this.prior=""),e()},t},i.test_regex_separator=function(e){if(!(i.COLUMN_SEPARATOR instanceof RegExp))return!1;var t;return e=e.slice(i.offset-1),t=i.COLUMN_SEPARATOR.exec(e),t&&(i.offset+=t[0].length-1),null!==t},i.stream.json=function(){var e=n(76),t=(n(25),new streamTransform({objectMode:!0}));return t._transform=function(n,r,i){t.push(JSON.stringify(n.toString())+e.EOL),i()},t},i.reset=function(){i.state=null,i.token=null,i.escaped=null,i.record=null,i.offset=null,i.result=null,i.str=null},i.next_nonspace=function(){for(var e,t=i.offset;t<i.str.length;)if(" "!=(e=i.str[t++])&&"\t"!==e)return e;return null},i.record_begin=function(){i.escaped=!1,i.record=[],i.token_begin(),i.debug("record_begin")},i.record_end=function(){i.state=4,!i.IGNORE_RECORD_LENGTH&&!i.RELAXED&&i.result.length>0&&i.record.length!=i.result[0].length&&i.error(i.ERROR_EOL),i.result.push(i.record),i.debug("record end",i.record),i.record=null},i.resolve_type=function(e){return e.match(/^[-+]?[0-9]+(\.[0-9]+)?([eE][-+]?[0-9]+)?$/)?e=parseFloat(e):e.match(/^(true|false)$/i)?e=Boolean(e.match(/true/i)):"undefined"===e?e=void 0:"null"===e&&(e=null),e},i.token_begin=function(){i.state=0,i.token=""},i.token_end=function(){i.DETECT_TYPES&&(i.token=i.resolve_type(i.token)),i.record.push(i.token),i.debug("token end",i.token),i.token_begin()},i.debug=function(){i.DEBUG&&console.log(arguments)},i.dump=function(e){return[e,"at char",i.offset,":",i.str.substr(i.offset-50,50).replace(/\r/gm,"\\r").replace(/\n/gm,"\\n").replace(/\t/gm,"\\t")].join(" ")},i.error=function(e){var t=i.dump(e);throw i.reset(),t},i.warn=function(e){if(i.DEBUG){var t=i.dump(e);try{return void console.warn(t)}catch(e){}try{console.log(t)}catch(e){}}},void 0!==e&&e.exports?e.exports=i:t.CSV=i}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=tui,a=o.util,l=/(\n)|(\r\n)|(\r)/g,s=function(){function e(t){r(this,e),this.cm=t}return i(e,[{key:"getTextContent",value:function(){return this.cm.getValue().replace(l,"")}},{key:"updateMarkerWithExtraInfo",value:function(e){var t=this._findOffsetCursor([e.start,e.end]),n=t[0].line,r=t[0].ch,i=t[1].line,o=t[1].ch,a=this._getExtraInfoOfRange(n,r,i,o);return e.text=a.text.replace(l," "),e.top=a.top,e.left=a.left,e.height=a.height,e}},{key:"_getExtraInfoOfRange",value:function(e,t,n,r){var i=void 0,o=void 0,a=void 0,l=void 0,s=void 0,u=this.cm.getDoc();if(u.getValue().length){i=u.getRange({line:e,ch:t},{line:n,ch:r}),o=this.cm.charCoords({line:n,ch:r},"local");var c=o;a=c.top,l=c.left,s=o.bottom-o.top}else a=l=s=0,i="";return{text:i,top:a,left:l,height:s}}},{key:"getMarkerInfoOfCurrentSelection",value:function(){var e=this.cm.getDoc(),t=this._getSelection(),n=e.getRange({line:0,ch:0},t.anchor).replace(l,"").length,r=n+e.getSelection().replace(l,"").length,i=this._findOffsetCursor([n,r]),o=this._getExtraInfoOfRange(i[0].line,i[0].ch,i[1].line,i[1].ch);return{start:n,end:r,text:o.text.replace(l," "),top:o.top,left:o.left,height:o.height}}},{key:"_getSelection",value:function(){var e=this.cm.getDoc().listSelections(),t=e[0],n=t.anchor,r=t.head;if(n.line>r.line||n.line===r.line&&n.ch>r.ch){var i=r;r=n,n=i}return{anchor:n,head:r}}},{key:"_findOffsetCursor",value:function(e){var t=this.cm.getDoc(),n=0,r=[],i=t.lineCount(),o=0,l=0,s=void 0;for(s=0;s<i;s+=1){for(l+=t.getLine(s).length;l>=e[o];)if(r.push({line:s,ch:e[o]-n}),o+=1,a.isUndefined(e[o]))return r;n=l}for(;!a.isUndefined(e[o]);)r.push({line:s,ch:l-n}),o+=1;return r}},{key:"selectOffsetRange",value:function(e,t){var n=this._findOffsetCursor([e,t]);this.cm.setSelection({line:n[0].line,ch:n[0].ch},{line:n[1].line,ch:n[1].ch})}},{key:"clearSelect",value:function(){var e=this.cm.getDoc().listSelections(),t=e[0];t&&this.cm.setCursor(t.to())}}]),e}();e.exports=s},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=tui,a=o.util,l=function(){function e(){r(this,e),this._sortedMarkers=[],this._markersWithId={}}return i(e,[{key:"addMarker",value:function(e,t,n){var r=void 0;return r=n?{start:e,end:t,id:n}:e,this._markersWithId[r.id]||(this._sortedMarkers.push(r),this._markersWithId[r.id]=r),r}},{key:"getMarker",value:function(e){return this._markersWithId[e]}},{key:"removeMarker",value:function(e){var t=this._markersWithId[e];delete this._markersWithId[e];var n=this._sortedMarkers.indexOf(t);return this._sortedMarkers.splice(n,1),t}},{key:"updateMarker",value:function(e,t){var n=this.getMarker(e);return a.extend(n,t)}},{key:"forEachByRangeAffected",value:function(e,t,n){this._getMarkersByRangeAffected(e,t).forEach(n)}},{key:"_getMarkersByRangeAffected",value:function(e,t){return this._sortedMarkers.filter(function(n){return n.end>t||n.end>e})}},{key:"getAll",value:function(){return this._sortedMarkers}},{key:"resetMarkers",value:function(){this._sortedMarkers=[],this._markersWithId={}}},{key:"sortBy",value:function(e){this._sortedMarkers.sort(function(t,n){return t[e]-n[e]})}},{key:"getMarkersData",value:function(){return this.getAll().map(function(e){return{start:e.start,end:e.end,id:e.id}})}}]),e}();e.exports=l},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(73),a=tui,l=a.util,s=function(){function e(t){r(this,e),this._dmp=new o,this.markerList=t,this.oldTextContent=null}return i(e,[{key:"resetContent",value:function(e){this.oldTextContent=l.isString(e)?e:null}},{key:"updateMarkersByContent",value:function(e){if(l.isNull(this.oldTextContent))return this.resetContent(e),[];var t=this._makeMarkerDiffs(e);return this.oldTextContent=e,this._getUpdateMarkersWithDiffs(t)}},{key:"_makeMarkerDiffs",value:function(e){var t=this.markerList,n=this,r={};return this._forEachChanges(e,function(e,i,o){t.forEachByRangeAffected(e,i,function(t){var a=r[t.id],l=n._calculateStartDiff(e,i,o,t),s=n._calculateEndDiff(e,i,o,t);a?(a.start+=l,a.end+=s):r[t.id]={start:l,end:s}})}),r}},{key:"_forEachChanges",value:function(e,t){var n=0,r=0;this._dmp.diff_main(this.oldTextContent,e).forEach(function(e){var i=e[0],o=e[1],a=0,l=o.length;if(n=r,0===i)return n+=l,void(r+=l);1===i?a+=l:-1===i&&(a-=l,r+=l),t(n,r,a)})}},{key:"_calculateStartDiff",value:function(e,t,n,r){return e<=r.start&&t<=r.start?n:e<=r.start&&t>r.start?e-r.start:0}},{key:"_calculateEndDiff",value:function(e,t,n,r){return t<=r.end?n:e<=r.end&&t>r.start?e-r.end:0}},{key:"_getUpdateMarkersWithDiffs",value:function(e){var t=[],n=this.markerList;return l.forEachOwnProperties(e,function(e,r){var i=n.getMarker(r);n.updateMarker(r,{start:i.start+=e.start,end:i.end+=e.end}),t.push(i)}),t}}]),e}();e.exports=s},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(){var e=window.getSelection(),t=void 0;return e&&e.rangeCount?t=e.getRangeAt(0).cloneRange():(t=document.createRange(),t.selectNodeContents(this.preview.$el[0]),t.collapse(!0)),t}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),l=/(\n)|(\r\n)|(\r)/g,s=function(){function e(t){r(this,e),this.preview=t}return o(e,[{key:"getTextContent",value:function(){return this.preview.$el[0].textContent.replace(l,"")}},{key:"updateMarkerWithExtraInfo",value:function(e){var t=this._findOffsetNode([e.start,e.end]),n=document.createRange();n.setStart(t[0].container,t[0].offsetInContainer),n.setEnd(t[1].container,t[1].offsetInContainer);var r=this._getExtraInfoOfRange(n);return e.text=r.text,e.top=r.top,e.left=r.left,e.height=r.height,e}},{key:"_getExtraInfoOfRange",value:function(e){var t=void 0,n=void 0,r=void 0,i=void 0,o=void 0,a=void 0,s=void 0,u=e.cloneContents().textContent.replace(l,"");if(e.setStart(e.endContainer,e.endOffset),e.collapse(!0),(r=e.getBoundingClientRect())&&!r.top){a=document.createElement("SPAN"),a.textContent="​",e.endContainer.parentNode.insertBefore(a,e.endContainer),r=a.getBoundingClientRect();s=a.parentNode,s.removeChild(a)}if(r){i=this.preview.$el.offset(),t=r.top+this.preview.$el.scrollTop()-i.top+$("body").scrollTop(),n=r.left-i.left;o=r.height}else o=t=n=0;return{text:u,top:t,left:n,height:o}}},{key:"getMarkerInfoOfCurrentSelection",value:function(){var e=void 0,t=void 0,n=void 0,r=void 0,o=i();return $.contains(this.preview.$el[0],o.commonAncestorContainer)&&this._extendRangeToTextNodeIfHasNone(o)?(e=o.cloneRange(),e.setStart(this.preview.$el[0],0),e.setEnd(o.startContainer,o.startOffset),r=this._getExtraInfoOfRange(o),t=e.cloneContents().textContent.length,n=t+r.text.length,{start:t,end:n,text:r.text,top:r.top,left:r.left,height:r.height}):null}},{key:"_extendRangeToTextNodeIfHasNone",value:function(e){var t=a.getChildNodeByOffset(e.endContainer,e.endOffset),n=void 0;if(!a.isTextNode(e.endContainer))if(a.isTextNode(t))e.setEnd(t,0);else{if(!(n=a.getPrevTextNode(t)))return!1;e.setEnd(n,n.length)}return!0}},{key:"_findOffsetNode",value:function(e){return a.findOffsetNode(this.preview.$el[0],e,function(e){return e.replace(l,"")})}},{key:"selectOffsetRange",value:function(e,t){var n=this._findOffsetNode([e,t]),r=document.createRange(),i=window.getSelection();r.setStart(n[0].container,n[0].offsetInContainer),r.setEnd(n[1].container,n[1].offsetInContainer),i.removeAllRanges(),i.addRange(r)}},{key:"clearSelect",value:function(){window.getSelection().removeAllRanges()}}]),e}();e.exports=s},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1),a=/\u200B/g,l=function(){function e(t){r(this,e),this.sqe=t}return i(e,[{key:"getTextContent",value:function(){return this.sqe.get$Body()[0].textContent.replace(a,"")}},{key:"updateMarkerWithExtraInfo",value:function(e){var t=this._findOffsetNode([e.start,e.end]),n=this.sqe.getSelection().cloneRange();n.setStart(t[0].container,t[0].offsetInContainer),n.setEnd(t[1].container,t[1].offsetInContainer);var r=this._getExtraInfoOfRange(n);return e.text=r.text,e.top=r.top,e.left=r.left,e.height=r.height,e}},{key:"_getExtraInfoOfRange",value:function(e){var t=void 0,n=void 0,r=void 0,i=void 0,l=void 0,s=void 0,u=void 0,c=e.endContainer,f=e.endOffset,d=e.cloneContents().textContent.replace(a,"");if(o.getChildNodeByOffset(c,f)&&(e.setStart(c,f),e.collapse(!0),r=e.getBoundingClientRect()),r&&!r.top&&this.sqe.modifyDocument(function(){l=document.createElement("SPAN"),l.textContent="​",e.endContainer.parentNode.insertBefore(l,e.endContainer),r=l.getBoundingClientRect(),s=l.parentNode,s.removeChild(l)}),r){u=this.sqe.get$Body().parent().offset(),t=this.sqe.scrollTop()+r.top-u.top+$("body").scrollTop(),n=r.left-u.left;i=r.height}else i=t=n=0;return{text:d,top:t,left:n,height:i}}},{key:"getMarkerInfoOfCurrentSelection",value:function(){var e=void 0,t=void 0,n=void 0,r=void 0,i=this.sqe.getSelection().cloneRange();return this._extendRangeToTextNodeIfHasNone(i)?(e=i.cloneRange(),e.setStart(this.sqe.get$Body()[0],0),e.setEnd(i.startContainer,i.startOffset),r=this._getExtraInfoOfRange(i),t=e.cloneContents().textContent.length,n=t+r.text.length,{start:t,end:n,text:r.text,top:r.top,left:r.left,height:r.height}):null}},{key:"_extendRangeToTextNodeIfHasNone",value:function(e){var t=o.getChildNodeByOffset(e.endContainer,e.endOffset),n=void 0;if(!o.isTextNode(e.endContainer)||!t.nodeValue.replace(a,"").length)if(o.isTextNode(t))e.setEnd(t,0);else{if(!(n=o.getPrevTextNode(t)))return!1;e.setEnd(n,n.length)}return!0}},{key:"_findOffsetNode",value:function(e){return o.findOffsetNode(this.sqe.get$Body()[0],e,function(e){return e.replace(a,"")})}},{key:"selectOffsetRange",value:function(e,t){var n=this._findOffsetNode([e,t]),r=this.sqe.getSelection().cloneRange();r.setStart(n[0].container,n[0].offsetInContainer),r.setEnd(n[1].container,n[1].offsetInContainer),this.sqe.setSelection(r)}},{key:"clearSelect",value:function(){var e=this.sqe.getSelection().cloneRange();e.collapse(!0),this.sqe.setSelection(e)}}]),e}();e.exports=l},function(e,t,n){"use strict";var r=n(3),i=function(e){return e&&e.__esModule?e:{default:e}}(r);i.default.setLang(["ko","ko_KR"],{"Merge cells":"셀 병합","Unmerge cells":"셀 병합해제","Cannot change part of merged cell":"병합 된 셀의 일부를 변경할 수 없습니다.","Cannot paste row merged cells into the table header":"테이블 헤더에는 행 병합된 셀을 붙여넣을 수 없습니다."}),i.default.setLang(["en","en_US"],{"Merge cells":"Merge cells","Unmerge cells":"Unmerge cells","Cannot change part of merged cell":"Cannot change part of merged cell.","Cannot paste row merged cells into the table header":"Cannot paste row merged cells into the table header."}),i.default.setLang(["ja","ja_JP"],{"Merge cells":"セルの結合","Unmerge cells":"セルの結合を解除","Cannot change part of merged cell":"結合されたセルの一部を変更することはできません。","Cannot paste row merged cells into the table header":"行にマージされたセルをヘッダーに貼り付けることはできません。"}),i.default.setLang(["nl","nl_NL"],{"Merge cells":"cellen samenvoegen","Unmerge cells":"Samenvoegen cellen ongedaan maken","Cannot change part of merged cell":"Kan geen deel uit van samengevoegde cel te veranderen.","Cannot paste row merged cells into the table header":"Kan niet plakken rij samengevoegde cellen in de koptekst. "}),i.default.setLang(["zh","zh_CN"],{"Merge cells":"合并单元格","Unmerge cells":"取消合并单元格","Cannot change part of merged cell":"无法更改合并单元格的一部分。","Cannot paste row merged cells into the table header":"无法将行合并单元格粘贴到标题中。"})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){var r,i=n+1,o=(r=[]).concat.apply(r,e.map(function(e){return e.slice(t,i)})),a=o.filter(function(e){var t=e.content;return t&&t!==w});return a.length?a[0].content:w}function o(e,t,n){var r,i=n+1,o=e.map(function(e){return e.slice(t,i)});(r=[]).concat.apply(r,o).slice(1).forEach(function(e){var t=e.nodeName;y.forEach(e,function(t,n){return delete e[n]}),e.nodeName=t})}function a(e,t,n,r){var i=n+1;e.forEach(function(e){e.slice(t,i).forEach(function(e){e.rowMergeWith=r})})}function l(e,t,n,r){var i=n+1;e.forEach(function(e){e.slice(t,i).forEach(function(e){e.colMergeWith=r})})}function s(e,t){var n=t.start,r=t.end,s=n.rowIndex,u=n.colIndex,c=r.rowIndex,f=r.colIndex,d=e[s][u],h=e.slice(s,c+1),g=c-s+1,p=f-u+1;d.rowspan=g,d.colspan=p,d.content=i(h,u,f),o(h,u,f),g>1&&a(h.slice(1),u,f,s),p>1&&l(h,u+1,f,u)}function u(e,t,n){var r=h.default.createTableData(e),i=h.default.findElementIndex(r,t,n);return e.find("tr").eq(i.rowIndex).find("td, th")[i.colIndex]}Object.defineProperty(t,"__esModule",{value:!0}),t._mergeCells=s;var c=n(0),f=r(c),d=n(2),h=r(d),g=n(4),p=r(g),v=n(5),m=r(v),b=tui,y=b.util,w=y.browser.msie?"":"<br>",_=f.default.command("wysiwyg",{name:"MergeCells",exec:function(e){var t=e.getEditor();if(e.focus(),t.hasFormat("TABLE")){var n=e.componentManager.getManager("tableSelection"),r=n.getSelectedCells();if(!(r.length<2||n.hasSelectedBothThAndTd(r))){var i=t.getSelection().cloneRange(),o=$(i.startContainer),a=o.closest("table"),l=h.default.createTableData(a),c=p.default.getTableSelectionRange(l,r,o);s(l,c);var f=m.default.replaceTable(a,l),d=u(f,c.start.rowIndex,c.start.colIndex);m.default.focusToCell(t,i,d)}}}});t.default=_},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){return{nodeName:t,colMergeWith:e}}function o(e,t,n,r){var o=e[n],a=void 0;if(b.isExisty(o.colMergeWith)){var l=o.colMergeWith,s=e[l],u=l+s.colspan-1;b.isExisty(s.rowMergeWith)&&r?a=b.extend({},r):u>n&&(s.colspan+=1,a=b.extend({},o))}else o.colspan>1&&(o.colspan+=1,a=i(n,o.nodeName));return a||(a=d.default.createBasicCell(t,n+1,o.nodeName)),a}function a(e,t,n){var r=b.range(t,n+1),i=[],a=null;return e.forEach(function(e,t){var l=r.map(function(r,i){var l=a?a[i-1]:null;return o(e,t,n,l)});a=l,i.push(l)}),i}function l(e,t){var n=t.end,r=d.default.findColMergedLastIndex(e,n.rowIndex,n.colIndex),i=a(e,t.start.colIndex,r),o=r+1;e.forEach(function(e,t){e.splice.apply(e,[o,0].concat(i[t]))})}function s(e,t,n){var r=d.default.createTableData(e),i=d.default.findColMergedLastIndex(r,t,n)+1,o=d.default.findElementIndex(r,t,i);return e.find("tr").eq(o.rowIndex).find("td, th")[o.colIndex]}Object.defineProperty(t,"__esModule",{value:!0}),t._createNewColumns=a,t._addColumns=l;var u=n(0),c=r(u),f=n(2),d=r(f),h=n(4),g=r(h),p=n(5),v=r(p),m=tui,b=m.util,y=c.default.command("wysiwyg",{name:"AddCol",exec:function(e){var t=e.getEditor(),n=t.getSelection().cloneRange();if(e.focus(),t.hasFormat("TABLE")){var r=$(n.startContainer),i=r.closest("table"),o=d.default.createTableData(i),a=e.componentManager.getManager("tableSelection").getSelectedCells(),u=g.default.getTableSelectionRange(o,a,r);t.saveUndoState(n),l(o,u);var c=v.default.replaceTable(i,o),f=s(c,u.start.rowIndex,u.end.colIndex);v.default.focusToCell(t,n,f)}}});t.default=y},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){return{nodeName:"TD",rowMergeWith:e}}function o(e,t){var n=null;return e[t].map(function(r,o){var a=void 0;if(m.isExisty(r.rowMergeWith)){var l=r.rowMergeWith,s=e[l][o],u=l+s.rowspan-1;m.isExisty(s.colMergeWith)&&n?a=m.extend({},n):u>t&&(s.rowspan+=1,a=m.extend({},r))}else r.rowspan>1&&(r.rowspan+=1,a=i(t));return a||(a=f.default.createBasicCell(t+1,o)),n=a,a})}function a(e,t){var n=t.start.rowIndex,r=t.end,i=f.default.findRowMergedLastIndex(e,r.rowIndex,r.colIndex),a=m.range(n,i+1).map(function(){return o(e,i)});e.splice.apply(e,[i+1,0].concat(a))}function l(e,t,n){var r=f.default.createTableData(e),i=f.default.findRowMergedLastIndex(r,t,n)+1,o=f.default.findElementIndex(r,i,n);return e.find("tr").eq(o.rowIndex).find("td")[o.colIndex]}Object.defineProperty(t,"__esModule",{value:!0}),t._createNewRow=o,t._addRow=a;var s=n(0),u=r(s),c=n(2),f=r(c),d=n(4),h=r(d),g=n(5),p=r(g),v=tui,m=v.util,b=u.default.command("wysiwyg",{name:"AddRow",exec:function(e){var t=e.getEditor(),n=t.getSelection().cloneRange();if(e.focus(),t.hasFormat("TABLE")){var r=$(n.startContainer),i=r.closest("table"),o=f.default.createTableData(i),s=e.componentManager.getManager("tableSelection").getSelectedCells(),u=h.default.getTableSelectionRange(o,s,r);t.saveUndoState(n),a(o,u);var c=p.default.replaceTable(i,o),d=l(c,u.end.rowIndex,u.start.colIndex);p.default.focusToCell(t,n,d)}}});t.default=b},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n,r){p.range(t,n+1).forEach(function(t){var n=e[t];p.isExisty(n.colMergeWith)?e[n.colMergeWith].align=r:n.align=r})}function o(e,t){var n=u.default.findElementRowIndex(t),r=u.default.findElementColIndex(t);return e.find("tr").eq(n).find("td, th")[r]}Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),l=r(a),s=n(2),u=r(s),c=n(4),f=r(c),d=n(5),h=r(d),g=tui,p=g.util,v=l.default.command("wysiwyg",{name:"AlignCol",exec:function(e,t){var n=e.getEditor(),r=n.getSelection().cloneRange();if(e.focus(),n.hasFormat("TABLE")){var a=$(r.startContainer),l=a.closest("table"),s=u.default.createTableData(l),c=e.componentManager.getManager("tableSelection").getSelectedCells(),d=f.default.getTableSelectionRange(s,c,a);i(s[0],d.start.colIndex,d.end.colIndex,t);var g=h.default.replaceTable(l,s),p=o(g,a);h.default.focusToCell(n,r,p)}}});t.default=v},function(e,t,n){"use strict";function r(e,t,n){var r=new RegExp("^((?:"+n+"=[0-9]+:)?)"+t+"=([0-9]+):(.*)"),i=r.exec(e),o=1;return i&&(o=parseInt(i[2],10),e=i[1]+i[3]),[o,e]}function i(e){var t=e.nodeName,n=e.align||"",i=e.innerHTML.trim(),o=null,a=null,l=r(i,"@cols","@rows");o=l[0],i=l[1];var s=r(i,"@rows","@cols");return a=s[0],i=s[1],{nodeName:t,colspan:o,rowspan:a,content:i,align:n}}function o(e){return e.find("tr").get().map(function(e){return $(e).find("td, th").get().map(i)})}function a(e,t){var n=-1;return tui.util.forEach(e,function(e,r){var i=!0;return t(e,r)&&(n=r,i=!1),i}),n}function l(e){var t=a(e,function(e){return"TD"===e[0].nodeName});return[e.slice(0,t),e.slice(t)]}function s(e){e.forEach(function(e){var t=e.length,n=0;e.forEach(function(e){n+=e.colspan-1}),e.splice(t-n)})}function u(e){var t=e.map(function(e,t){return t}),n=t.map(function(){return 0});return e.forEach(function(e,r){var i=e.filter(function(e){return e.rowspan>1}),o=r+1;i.forEach(function(e){var r=e.colspan,i=o+(e.rowspan-1);t.slice(o,i).forEach(function(e){n[e]+=r})})}),n}function c(e){var t=u(e);e.forEach(function(e,n){e.splice(e.length-t[n])})}function f(e){var t=o($(e)),n=l(t),r=n[0],i=n[1];return s(r),s(i),c(i),$(h.default.createTableHtml(t))[0]}Object.defineProperty(t,"__esModule",{value:!0}),t._extractPropertiesForMerge=r,t._parseTableCell=i,t._createTableObjectFrom$Table=o,t._divideTrs=l,t._mergeByColspan=s,t._getRemovalTdCountsByRowspan=u,t._mergeByRowspan=c,t.default=f;var d=n(5),h=function(e){return e&&e.__esModule?e:{default:e}}(d)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){e.forEach(function(e){m.range(t,n+1).forEach(function(t){var r=e[t];if(m.isExisty(r.colMergeWith)){var i=e[r.colMergeWith];i.colspan&&(i.colspan-=1)}else if(r.colspan>1){var o=t+r.colspan-1;r.colspan-=n-t+1,o>n&&(e[n+1]=m.extend({},r))}})})}function o(e,t,n){e.forEach(function(e){e.slice(n+1).forEach(function(e){m.isExisty(e.colMergeWith)&&e.colMergeWith>=t&&(e.colMergeWith=n+1)})})}function a(e,t){var n=t.start.colIndex,r=t.end,a=f.default.findColMergedLastIndex(e,r.rowIndex,r.colIndex),l=a-n+1;i(e,n,a),o(e,n,a),e.forEach(function(e){e.splice(n,l)})}function l(e,t,n){var r=f.default.createTableData(e);r[0].length-1<n&&(n-=1);var i=f.default.findElementIndex(r,t,n);return e.find("tr").eq(i.rowIndex).find("td, th")[i.colIndex]}Object.defineProperty(t,"__esModule",{value:!0}),t._removeColumns=a;var s=n(0),u=r(s),c=n(2),f=r(c),d=n(4),h=r(d),g=n(5),p=r(g),v=tui,m=v.util,b=u.default.command("wysiwyg",{name:"RemoveCol",exec:function(e){var t=e.getEditor(),n=t.getSelection().cloneRange();if(e.focus(),t.hasFormat("TABLE")){var r=$(n.startContainer),i=r.closest("table"),o=f.default.createTableData(i),s=e.componentManager.getManager("tableSelection").getSelectedCells(),u=h.default.getTableSelectionRange(o,s,r),c=o[0].length;if(t.saveUndoState(n),a(o,u),0===o[0].length)i.remove();else if(c!==o[0].length){var d=p.default.replaceTable(i,o),g=u.start.colIndex,v=g>=o[0].length?g-1:g,m=l(d,u.start.rowIndex,v);p.default.focusToCell(t,n,m)}}}});t.default=b},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){m.range(t,n+1).forEach(function(t){e[t].forEach(function(r,i){if(m.isExisty(r.rowMergeWith)){var o=e[r.rowMergeWith][i];o.rowspan&&(o.rowspan-=1)}else if(r.rowspan>1){var a=t+r.rowspan-1;r.rowspan-=n-t+1,a>n&&(e[n+1][i]=m.extend({},r))}})})}function o(e,t,n){e.slice(n+1).forEach(function(e){e.forEach(function(e){m.isExisty(e.rowMergeWith)&&e.rowMergeWith>=t&&(e.rowMergeWith=n+1)})})}function a(e,t){var n=t.start.rowIndex,r=t.end,a=f.default.findRowMergedLastIndex(e,r.rowIndex,r.colIndex);if(0!==n||0!==a){n=Math.max(n,1),a=Math.max(a,1);var l=a-n+1;e.length-l<2?e.splice(0,e.length):(i(e,n,a),o(e,n,a),e.splice(n,l))}}function l(e,t,n){var r=f.default.createTableData(e);r.length-1<t&&(t-=1);var i=f.default.findElementIndex(r,t,n);return e.find("tr").eq(i.rowIndex).find("th,td")[i.colIndex]}Object.defineProperty(t,"__esModule",{value:!0}),t._removeRow=a;var s=n(0),u=r(s),c=n(2),f=r(c),d=n(4),h=r(d),g=n(5),p=r(g),v=tui,m=v.util,b=u.default.command("wysiwyg",{name:"RemoveRow",exec:function(e){var t=e.getEditor(),n=t.getSelection().cloneRange();if(e.focus(),t.hasFormat("TABLE")){var r=$(n.startContainer),i=r.closest("table"),o=f.default.createTableData(i),s=o.length,u=e.componentManager.getManager("tableSelection").getSelectedCells(),c=h.default.getTableSelectionRange(o,u,r);if(t.saveUndoState(n),a(o,c),o.length<2)i.remove();else if(s!==o.length){var d=p.default.replaceTable(i,o),g=c.start.rowIndex,v=g<o.length?g:g-1,m=l(d,v,c.start.colIndex);p.default.focusToCell(t,n,m)}}}});t.default=b},function(e,t,n){"use strict";function r(e){var t=['<button type="button" class="te-table-add-row">'+l.default.get("Add row")+"</button>",'<button type="button" class="te-table-add-col">'+l.default.get("Add col")+"</button>",'<button type="button" class="te-table-remove-row">'+l.default.get("Remove row")+"</button>",'<button type="button" class="te-table-remove-col">'+l.default.get("Remove col")+"</button>","<hr/>",'<button type="button" class="te-table-merge">'+l.default.get("Merge cells")+"</button>",'<button type="button" class="te-table-unmerge">'+l.default.get("Unmerge cells")+"</button>","<hr/>",'<button type="button" class="te-table-col-align-left">'+l.default.get("Align left")+"</button>",'<button type="button" class="te-table-col-align-center">'+l.default.get("Align center")+"</button>",'<button type="button" class="te-table-col-align-right">'+l.default.get("Align right")+"</button>","<hr/>",'<button type="button" class="te-table-remove">'+l.default.get("Remove table")+"</button>"].join(""),n=$(t);e.setContent(n)}function i(e,t,n){var r=e.$content,i=$(r[5]),o=$(r[6]),a=$(r[7]);e.on("click .te-table-merge",function(){t.emit("command","MergeCells")}),e.on("click .te-table-unmerge",function(){t.emit("command","UnmergeCells")}),t.listen("openPopupTableUtils",function(){var e=n.getSelectedCells(),t=e.length;t?(t<2||n.hasSelectedBothThAndTd(e)?i.hide():i.show(),e.is("[rowspan], [colspan]")?o.show():o.hide(),a.show()):(i.hide(),o.hide(),a.hide())})}function o(e,t,n){r(e),i(e,t,n)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),l=function(e){return e&&e.__esModule?e:{default:e}}(a);t.default={updateContextMenu:o}},function(e,t,n){"use strict";function r(e){var t=$(e),n=t.attr("colspan")||"",r=t.attr("rowspan")||"",i=t.html();n&&(i="@cols="+n+":"+i),r&&(i="@rows="+r+":"+i),i&&t.html(i)}function i(e){return $(e).find("td, th").get().forEach(r),e}Object.defineProperty(t,"__esModule",{value:!0}),t._prependMergeSyntaxToContent=r,t.default=i},function(e,t,n){"use strict";function r(e,t){return tui.util.range(0,t).map(function(){return e}).join("")}function i(e){var t=e.align,n=(e.textContent||e.innerText).replace(u,""),i=n.length,o="",a="";return t&&("left"===t?(o=":",i-=1):"right"===t?(a=":",i-=1):"center"===t&&(a=":",o=":",i-=2)),i=Math.max(i,3),o+r("-",i)+a}function o(e){var t=0;return e.filter(function(e){return $(e).attr("colspan")}).forEach(function(e){t+=parseInt($(e).attr("colspan"),10)-1}),t}function a(e,t){var n=$(e).find("th").get(),a=n.map(function(e){return" "+i(e)+" |"}).join("");return a+=r(" --- |",o(n)),t?t+"|"+a+"\n":""}Object.defineProperty(t,"__esModule",{value:!0}),t._getAdditionalThCount=o,t._createTheadMarkdown=a;var l=window,s=l.toMark,u=/@cols=[0-9]+:/g;t.default=s.Renderer.factory(s.gfmRenderer,{THEAD:a})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n,r=t.start,i=t.end,o=r.colIndex,a=i.colIndex+1,l=e.slice(r.rowIndex,i.rowIndex+1),s=l.map(function(e){return e.slice(o,a)});return!!(n=[]).concat.apply(n,s).filter(function(e){return e.colspan>1||e.rowspan>1}).length}function o(e,t,n,r,i){var o=t+r,a=n+i,l=m.range(n,a);m.range(t,o).forEach(function(n){var r=e[n],i=n===t?1:0;l.slice(i).forEach(function(e){r[e]=f.default.createBasicCell(n,e,r[e].nodeName)})})}function a(e,t){var n=t.start,r=t.end,i=m.range(n.colIndex,r.colIndex+1);m.range(n.rowIndex,r.rowIndex+1).forEach(function(t){i.forEach(function(n){var r=e[t][n],i=r.colspan,a=r.rowspan;(i>1||a>1)&&(r.colspan=1,r.rowspan=1,o(e,t,n,a,i))})})}function l(e,t,n){var r=f.default.createTableData(e),i=f.default.findElementIndex(r,t,n);return e.find("tr").eq(i.rowIndex).find("td, th")[i.colIndex]}Object.defineProperty(t,"__esModule",{value:!0}),t._hasMergedCell=i,t._unmergeCells=a;var s=n(0),u=r(s),c=n(2),f=r(c),d=n(4),h=r(d),g=n(5),p=r(g),v=tui,m=v.util,b=u.default.command("wysiwyg",{name:"UnmergeCells",exec:function(e){var t=e.getEditor(),n=t.getSelection().cloneRange();if(e.focus(),t.hasFormat("TABLE")){var r=$(n.startContainer),o=r.closest("table"),s=f.default.createTableData(o),u=e.componentManager.getManager("tableSelection").getSelectedCells(),c=h.default.getTableSelectionRange(s,u,r);if(i(s,c)){a(s,c);var d=p.default.replaceTable(o,s),g=l(d,c.start.rowIndex,c.start.colIndex);p.default.focusToCell(t,n,g)}}}});t.default=b},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e,t){var n=!1;return w.forEach(e,function(e){return!(n=t(e))}),n}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(39),c=r(u),f=n(2),d=r(f),h=n(5),g=r(h),p=n(4),v=r(p),m=n(3),b=r(m),y=tui,w=y.util,_=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"_updateCopyDataMergeWith",value:function(e,t){e.forEach(function(e){e.forEach(function(e){w.isExisty(e.rowMergeWith)&&(e.rowMergeWith-=t.rowIndex),w.isExisty(e.colMergeWith)&&(e.colMergeWith-=t.colIndex)})})}},{key:"_createCopyTableData",value:function(e,t,n){var r=e.slice(t.rowIndex,n.rowIndex+1);return r=r.map(function(e){return e.slice(t.colIndex,n.colIndex+1)}),this._updateCopyDataMergeWith(r,t),r}},{key:"updateTableHtmlOfClipboardIfNeed",value:function(e){var t=this.wwe.componentManager.getManager("tableSelection").getSelectedCells();if(t.length){var n=d.default.createTableData($(t[0]).closest("TABLE")),r=v.default.getTableSelectionRange(n,t),i=r.start,o=r.end,a=this._createCopyTableData(n,i,o),l=d.default.createCellIndexData(a),s=d.default.createRenderData(a,l);e.html(g.default.createTableHtml(s))}}},{key:"prepareToTableCellStuffing",value:function(e){var t=e[0].length,n=!1;return e.slice(1).forEach(function(e){var r=e.length;t!==r&&(n=!0,t<r&&(t=r))}),{maximumCellLength:t,needTableCellStuffingAid:n}}},{key:"tableCellAppendAidForTableElement",value:function(e){var t=$(e),n=d.default.createTableData(t),r=d.default.addTbodyOrTheadIfNeed(n),i=this.prepareToTableCellStuffing(n),o=i.needTableCellStuffingAid;o&&d.default.stuffCellsIntoIncompleteRow(n,i.maximumCellLength),(r||o)&&g.default.replaceTable(t,n)}},{key:"_findStartCell",value:function(e){return 1===e.length?e.get(0):this.wwe.getEditor().getSelection().startContainer}},{key:"_findStartCellIndex",value:function(e,t){var n=d.default.createCellIndexData(e);return d.default.findCellIndex(n,t)}},{key:"_hasRowMergedHeader",value:function(e,t,n){var r="TH"===t[n.rowIndex][n.colIndex].nodeName,i=l(e[0],function(e){return e.rowspan&&e.rowspan>1});return r&&i}},{key:"_isExactlyFit",value:function(e,t,n){return t%e.length==0&&n%e[0].length==0}},{key:"_updateClipboardTableData",value:function(e,t,n){var r=e.length,i=e[0].length,o=parseInt(t/r,10),a=parseInt(n/i,10);if(o>1){var l=JSON.parse(JSON.stringify(e));w.range(0,o-1).forEach(function(){var t=JSON.parse(JSON.stringify(l));e.push.apply(e,t)})}if(a>1){var s=JSON.parse(JSON.stringify(e));w.range(0,a-1).forEach(function(){var t=JSON.parse(JSON.stringify(s));e.forEach(function(e,n){e.push.apply(e,t[n])})})}}},{key:"_updateTableDataByClipboardData",value:function(e,t,n){var r=n.rowIndex,i=n.colIndex;e.forEach(function(e,n){var o=r+n;e.forEach(function(e,n){var r=i+n,a=t[o][r];e.nodeName=a.nodeName,t[o][r]=e})})}},{key:"_isPossibleToPaste",value:function(e,t,n){var r=t.rowIndex,i=t.colIndex,o=n.rowIndex,a=n.colIndex,s=e.slice(r,o+1),u=s[0].slice(i,a+1),c=!l(u,function(e){return w.isExisty(e.rowMergeWith)});if(c){c=!l(w.pluck(s,i),function(e){return w.isExisty(e.colMergeWith)})}if(c&&e.length>o+1){c=!l(e[o+1].slice(i,a+1),function(e){return w.isExisty(e.rowMergeWith)})}if(c&&e[0].length>a+1){c=!l(w.pluck(s,a+1),function(e){return w.isExisty(e.colMergeWith)})}return c}},{key:"_spliceClipboardData",value:function(e,t,n){e.splice(t),e.forEach(function(e){e.splice(n)})}},{key:"_bookmarkLastTd",value:function(e){var t=e.rowIndex,n=e.colIndex,r=this.wwe.getEditor(),i=r.get$Body().find(".tui-paste-table-bookmark"),o=d.default.createTableData(i),a=o[t][n];t=w.isExisty(a.rowMergeWith)?a.rowMergeWith:t,n=w.isExisty(a.colMergeWith)?a.colMergeWith:n;var l=o[t][n].elementIndex,s=i.find("tr").eq(l.rowIndex).children()[l.colIndex];i.removeClass("tui-paste-table-bookmark"),$(s).addClass("tui-paste-table-cell-bookmark")}},{key:"_updateClipboardDataForPasteToSamllerSelectedArea",value:function(e,t,n,r,i){var o=!0,a={rowIndex:0,colIndex:0},l={rowIndex:n-1,colIndex:r-1};return this._isPossibleToPaste(e,a,l)?(this._spliceClipboardData(e,n,r),this._updateTableDataByClipboardData(e,t,i)):o=!1,o}},{key:"_pasteToSelectedArea",value:function(e,t,n,r){var i=v.default.getTableSelectionRange(n,r),o=i.start,a=i.end,l=a.rowIndex-o.rowIndex+1,s=a.colIndex-o.colIndex+1,u=t.length,c=t[0].length,f=l>=u&&s>=c,d=b.default.get("Cannot change part of merged cell"),h=!0,p=void 0;this._hasRowMergedHeader(t,n,o)?(d=b.default.get("Cannot paste row merged cells into the table header"),h=!1):this._isExactlyFit(t,l,s)?(p=a,this._updateClipboardTableData(t,l,s),this._updateTableDataByClipboardData(t,n,o)):f?(p={rowIndex:o.rowIndex+u-1,colIndex:o.colIndex+c-1},this._isPossibleToPaste(n,o,p)?this._updateTableDataByClipboardData(t,n,o):h=!1):(p={rowIndex:o.rowIndex+l-1,colIndex:o.colIndex+s-1},h=this._updateClipboardDataForPasteToSamllerSelectedArea(t,n,l,s,o)),h?(n.className+=" tui-paste-table-bookmark",g.default.replaceTable(e,n),this._bookmarkLastTd(p)):(alert(d),this.wwe.focus())}},{key:"_findEndCellIndex",value:function(e,t){var n=t.rowIndex,r=t.colIndex;return{rowIndex:n+e.length-1,colIndex:r+e[0].length-1}}},{key:"_expandRow",value:function(e,t){var n=e.length,r=e[0].length,i=w.range(n,n+t).map(function(e){return w.range(0,r).map(function(t){return d.default.createBasicCell(e,t)})});e.push.apply(e,i)}},{key:"_expandCoumn",value:function(e,t){var n=e[0].length,r=w.range(n,n+t);e.forEach(function(e,t){var n=e[0].nodeName,i=r.map(function(e){return d.default.createBasicCell(t,e,n)});e.push.apply(e,i)})}},{key:"_expandTableDataIfNeed",value:function(e,t,n){var r=n.rowIndex-e.length+1,i=n.colIndex-e[0].length+1;r>0&&this._expandRow(e,r),i>0&&this._expandCoumn(e,i)}},{key:"_pasteAllClipboardTableData",value:function(e,t,n,r){var i=this._findEndCellIndex(t,r);if(this._hasRowMergedHeader(t,n,r))return alert(b.default.get("Cannot paste row merged cells into the table header")),void this.wwe.focus();this._expandTableDataIfNeed(n,r,i),this._isPossibleToPaste(n,r,i)?(this._updateTableDataByClipboardData(t,n,r),n.className+=" tui-paste-table-bookmark",g.default.replaceTable(e,n),this._bookmarkLastTd(i)):(alert(b.default.get("Cannot change part of merged cell")),this.wwe.focus())}},{key:"pasteClipboardData",value:function(e){var t=d.default.createTableData(e),n=this.wwe.componentManager.getManager("tableSelection"),r=n.getSelectedCells(),i=$(this._findStartCell(r)),o=i.closest("table"),a=d.default.createTableData(o),l=this._findStartCellIndex(a,i);r.length>1?this._pasteToSelectedArea(o,t,a,r):this._pasteAllClipboardTableData(o,t,a,l)}}]),t}(c.default);e.exports=_},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(40),u=r(s),c=n(2),f=r(c),d=n(4),h=r(d),g=tui,p=g.util,v=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._tableData=null,n.mergedTableSelectionManager=!0,n}return a(t,e),l(t,[{key:"_addClassToSelectedCells",value:function(e,t,n){var r=n.start,i=n.end,o=p.range(r.colIndex,i.colIndex+1),a=e.find("tr");p.range(r.rowIndex,i.rowIndex+1).forEach(function(e){var n=t[e],r=a.eq(e).find("td, th");return o.forEach(function(e){n[e].elementIndex&&r.eq(n[e].elementIndex.colIndex).addClass("te-cell-selected")})})}},{key:"onDragStart",value:function(e){var t=$(e).closest("[contenteditable=true] table");this._tableData=f.default.createTableData(t)}},{key:"onDragEnd",value:function(){this._tableData=null}},{key:"highlightTableCellsBy",value:function(e,t){var n=$(e),r=$(t),i=n.closest("[contenteditable=true] table"),o=h.default.findSelectionRange(this._tableData,n,r);this.removeClassAttrbuteFromAllCellsIfNeed(),this._addClassToSelectedCells(i,this._tableData,o)}},{key:"styleToSelectedCells",value:function(e){var t=this.wwe.getEditor(),n=t.getSelection().cloneRange();$(n.startContainer).closest("[contenteditable=true] table").find("tr").get().forEach(function(r){var i=$(r).find(".te-cell-selected"),o=i.first().get(0),a=i.last().get(0);i.length&&(n.setStart(o,0),n.setEnd(a,a.childNodes.length),t.setSelection(n),e(t))})}},{key:"hasSelectedBothThAndTd",value:function(e){return e=e||this.getSelectedCells(),e.first()[0].nodeName!==e.last()[0].nodeName}}]),t}(u.default);t.default=v},,,function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=tui,a=o.util,l=function(){function e(){r(this,e),this.globalTOID=null,this.lazyRunFunctions={}}return i(e,[{key:"run",value:function(e,t,n,r){var i=void 0;return a.isString(e)?i=this._runRegisteredRun(e,t,n,r):(i=this._runSingleRun(e,t,n,r,this.globalTOID),this.globalTOID=i),i}},{key:"registerLazyRunFunction",value:function(e,t,n,r){r=r||this,this.lazyRunFunctions[e]={fn:t,delay:n,context:r,TOID:null}}},{key:"_runSingleRun",value:function(e,t,n,r,i){return this._clearTOIDIfNeed(i),i=setTimeout(function(){e.call(n,t)},r)}},{key:"_runRegisteredRun",value:function(e,t,n,r){var i=this.lazyRunFunctions[e],o=i.fn,a=i.TOID;return r=r||i.delay,n=n||i.context,a=this._runSingleRun(o,t,n,r,a),i.TOID=a,a}},{key:"_clearTOIDIfNeed",value:function(e){e&&clearTimeout(e)}}]),e}();e.exports=l},function(e,t,n){"use strict";e.exports=function(e,t){var n,r,i,o,a,l,s=e.pos;if(96!==e.src.charCodeAt(s))return!1;for(n=s,s++,r=e.posMax;s<r&&96===e.src.charCodeAt(s);)s++;for(i=e.src.slice(n,s),o=a=s;-1!==(o=e.src.indexOf("`",a));){for(a=o+1;a<r&&96===e.src.charCodeAt(a);)a++;if(a-o===i.length)return t||(l=e.push("code_inline","code",0),l.markup=i,l.content=e.src.slice(s,o).replace(/[ \n]+/g," ").trim(),l.attrSet("data-backticks",l.markup.length)),e.pos=a,!0}return t||(e.pending+=i),e.pos+=i.length,!0}},function(e,t,n){"use strict";function r(e){switch(e){case 9:case 32:return!0}return!1}e.exports=function(e,t,n,i){var o,a,l,s,u,c,f,d,h,g,p,v,m,b,y,w,_,k,E,T,C=e.lineMax,x=e.bMarks[t]+e.tShift[t],M=e.eMarks[t],S=/(?:-|\*|\d+\.) {1,4}(?:> {0,3})[^>]*$/,I=e.src.split("\n"),R=I[t];if(e.sCount[t]-e.blkIndent>=4)return!1;if(62!==e.src.charCodeAt(x++))return!1;if(R.match(S))return!1;if(i)return!0;for(s=h=e.sCount[t]+x-(e.bMarks[t]+e.tShift[t]),32===e.src.charCodeAt(x)?(x++,s++,h++,o=!1,w=!0):9===e.src.charCodeAt(x)?(w=!0,(e.bsCount[t]+h)%4==3?(x++,s++,h++,o=!1):o=!0):w=!1,g=[e.bMarks[t]],e.bMarks[t]=x;x<M&&(a=e.src.charCodeAt(x),r(a));)9===a?h+=4-(h+e.bsCount[t]+(o?1:0))%4:h++,x++;for(p=[e.bsCount[t]],e.bsCount[t]=e.sCount[t]+1+(w?1:0),c=x>=M,b=[e.sCount[t]],e.sCount[t]=h-s,y=[e.tShift[t]],e.tShift[t]=x-e.bMarks[t],k=e.md.block.ruler.getRules("blockquote"),m=e.parentType,e.parentType="blockquote",T=!1,d=t+1;d<n&&(e.sCount[d]<e.blkIndent&&(T=!0),x=e.bMarks[d]+e.tShift[d],M=e.eMarks[d],!(x>=M));d++)if(62!==e.src.charCodeAt(x++)||T){if(c)break;for(_=!1,l=0,u=k.length;l<u;l++)if(k[l](e,d,n,!0)){_=!0;break}if(_){e.lineMax=d,0!==e.blkIndent&&(g.push(e.bMarks[d]),p.push(e.bsCount[d]),y.push(e.tShift[d]),b.push(e.sCount[d]),e.sCount[d]-=e.blkIndent);break}g.push(e.bMarks[d]),p.push(e.bsCount[d]),y.push(e.tShift[d]),b.push(e.sCount[d]),e.sCount[d]=-1}else{for(s=h=e.sCount[d]+x-(e.bMarks[d]+e.tShift[d]),32===e.src.charCodeAt(x)?(x++,s++,h++,o=!1,w=!0):9===e.src.charCodeAt(x)?(w=!0,(e.bsCount[d]+h)%4==3?(x++,s++,h++,o=!1):o=!0):w=!1,g.push(e.bMarks[d]),e.bMarks[d]=x;x<M&&(a=e.src.charCodeAt(x),r(a));)9===a?h+=4-(h+e.bsCount[d]+(o?1:0))%4:h++,x++;c=x>=M,p.push(e.bsCount[d]),e.bsCount[d]=e.sCount[d]+1+(w?1:0),b.push(e.sCount[d]),e.sCount[d]=h-s,y.push(e.tShift[d]),e.tShift[d]=x-e.bMarks[d]}for(v=e.blkIndent,e.blkIndent=0,E=e.push("blockquote_open","blockquote",1),E.markup=">",E.map=f=[t,0],e.md.block.tokenize(e,t,d),E=e.push("blockquote_close","blockquote",-1),E.markup=">",e.lineMax=C,e.parentType=m,f[1]=e.line,l=0;l<y.length;l++)e.bMarks[l+t]=g[l],e.tShift[l+t]=y[l],e.sCount[l+t]=b[l],e.bsCount[l+t]=p[l];return e.blkIndent=v,!0}},function(e,t,n){"use strict";function r(e,t,n){var r=e.attrIndex(t),i=[t,n];r<0?e.attrPush(i):e.attrs[r]=i}function i(e){return!0===e.block&&"code"===e.tag&&"fence"===e.type}function o(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}var a=function(e){e.core.ruler.after("block","tui-code-block",function(e){var t,n,a=e.tokens;for(n=0;n<a.length;n+=1)t=a[n],i(t)&&t.info&&r(t,"data-language",o(t.info.replace(" ",""),!0))})};e.exports=a},function(e,t,n){"use strict";e.exports=function(e,t,n){var r,i,o,a=/ {0,3}(?:-|\*|\d\.) /,l=e.src.split("\n"),s=l[t],u=0;if(s.match(a)||e.sCount[t]-e.blkIndent<4)return!1;for(i=r=t+1;r<n;)if(e.isEmpty(r)){if(++u>=2&&"list"===e.parentType)break;r++}else{if(u=0,!(e.sCount[r]-e.blkIndent>=4))break;r++,i=r}return e.line=i,o=e.push("code_block","code",0),o.content=e.getLines(t,i,4+e.blkIndent,!0),o.map=[t,e.line],!0}},function(e,t,n){"use strict";var r=["area","base","br","col","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],i=[[/^<(script|pre|style)(?=(\s|>|$))/i,/<\/(script|pre|style)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^<("+r.join("|")+")","i"),/^\/?>$/,!0],[new RegExp("^</?(address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h1|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|pre|section|source|title|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul)(?=(\\s|/?>|$))","i"),/^$/,!0],[/^(?:<[A-Za-z][A-Za-z0-9\-]*(?:\s+[a-zA-Z_:][a-zA-Z0-9:._-]*(?:\s*=\s*(?:[^"'=<>`\x00-\x20]+|'[^']*'|"[^"]*"))?)*\s*\/?>|<\/[A-Za-z][A-Za-z0-9\-]*\s*>)\s*$/,/^$/,!1]];e.exports=function(e,t,n,r){var o,a,l,s,u=e.bMarks[t]+e.tShift[t],c=e.eMarks[t];if(!e.md.options.html)return!1;if(60!==e.src.charCodeAt(u))return!1;for(s=e.src.slice(u,c),o=0;o<i.length;o++)if(i[o][0].test(s)){if(5===o)return!1;break}if(o===i.length)return!1;if(r)return i[o][2];if(a=t+1,!i[o][1].test(s))for(;a<n&&!(e.sCount[a]<e.blkIndent);a++)if(u=e.bMarks[a]+e.tShift[a],c=e.eMarks[a],s=e.src.slice(u,c),i[o][1].test(s)){0!==s.length&&a++;break}return e.line=a,l=e.push("html_block","",0),l.map=[t,a],l.content=e.getLines(t,a,e.blkIndent,!0),!0}},function(e,t,n){"use strict";function r(e,t){var n=e.bMarks[t]+e.blkIndent,r=e.eMarks[t];return e.src.substr(n,r-n)}function i(e){var t,n=[],r=0,i=e.length,o=0,a=0,l=!1,s=0;for(t=e.charCodeAt(r);r<i;)96===t&&o%2==0?(l=!l,s=r):124!==t||o%2!=0||l?92===t?o+=1:o=0:(n.push(e.substring(a,r)),a=r+1),r+=1,r===i&&l&&(l=!1,r=s+1),t=e.charCodeAt(r);return n.push(e.substring(a)),n}e.exports=function(e,t,n,o){var a,l,s,u,c,f,d,h,g,p,v,m,b;if(t+2>n)return!1;if(c=t+1,e.sCount[c]<e.blkIndent)return!1;if((s=e.bMarks[c]+e.tShift[c])>=e.eMarks[c])return!1;if(124!==(a=e.src.charCodeAt(s))&&45!==a&&58!==a)return!1;if(l=r(e,t+1),!/^[-:| ]+$/.test(l))return!1;for(f=l.split("|"),g=[],u=0;u<f.length;u+=1){if(!(v=f[u].trim())){if(0===u||u===f.length-1)continue;return!1}if(!/^:?-+:?$/.test(v))return!1;58===v.charCodeAt(v.length-1)?g.push(58===v.charCodeAt(0)?"center":"right"):58===v.charCodeAt(0)?g.push("left"):g.push("")}if(p=g.length,l=r(e,t).trim(),-1===l.indexOf("|"))return!1;if(f=i(l.replace(/^\||\|$/g,"")),(d=f.length)>p)return!1;if(d<p){for(u=0;u<p-d;u+=1)f.push("");d=f.length}if(o)return!0;for(h=e.push("table_open","table",1),h.map=m=[t,0],h=e.push("thead_open","thead",1),h.map=[t,t+1],h=e.push("tr_open","tr",1),h.map=[t,t+1],u=0;u<d;u+=1)h=e.push("th_open","th",1),h.map=[t,t+1],g[u]&&(h.attrs=[["align",g[u]]]),h=e.push("inline","",0),h.content=f[u].trim(),h.map=[t,t+1],h.children=[],h=e.push("th_close","th",-1);for(h=e.push("tr_close","tr",-1),h=e.push("thead_close","thead",-1),h=e.push("tbody_open","tbody",1),h.map=b=[t+2,0],c=t+2;c<n&&!(e.sCount[c]<e.blkIndent)&&(l=r(e,c),-1!==l.indexOf("|"));c+=1){for(f=i(l.replace(/^\||\|\s*$/g,"")),h=e.push("tr_open","tr",1),u=0;u<d;u+=1)h=e.push("td_open","td",1),g[u]&&(h.attrs=[["align",g[u]]]),h=e.push("inline","",0),h.content=f[u]?f[u].trim():"",h.children=[],h=e.push("td_close","td",-1);h=e.push("tr_close","tr",-1)}return h=e.push("tbody_close","tbody",-1),h=e.push("table_close","table",-1),m[1]=b[1]=c,e.line=c,!0}},function(e,t,n){"use strict";function r(e){e.content=e.content.slice(4),e.children[0].content=e.children[0].content.slice(4)}function i(e){var t=!1;return 0!==e.content.indexOf("[x]")&&0!==e.content.indexOf("[X]")||(t=!0),t}function o(e,t,n){var r=e.attrIndex(t),i=[t,n];r<0?e.attrPush(i):e.attrs[r]=i}function a(e,t){return"inline"===e[t].type&&"paragraph_open"===e[t-1].type&&"list_item_open"===e[t-2].type&&(0===e[t].content.indexOf("[ ]")||0===e[t].content.indexOf("[x]")||0===e[t].content.indexOf("[X]"))}var l=function(e){e.core.ruler.after("inline","tui-task-list",function(e){var t,n,l=e.tokens;for(n=2;n<l.length;n+=1)a(l,n)&&(t=i(l[n])?"task-list-item checked":"task-list-item",r(l[n]),o(l[n-2],"class",t),o(l[n-2],"data-te-task",""))})};e.exports=l},function(e,t,n){"use strict";function r(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.Diff,r.prototype.diff_main=function(e,t,n,r){void 0===r&&(r=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var i=r;if(null==e||null==t)throw new Error("Null input. (diff_main)");if(e==t)return e?[[0,e]]:[];void 0===n&&(n=!0);var o=n,a=this.diff_commonPrefix(e,t),l=e.substring(0,a);e=e.substring(a),t=t.substring(a),a=this.diff_commonSuffix(e,t);var s=e.substring(e.length-a);e=e.substring(0,e.length-a),t=t.substring(0,t.length-a);var u=this.diff_compute_(e,t,o,i);return l&&u.unshift([0,l]),s&&u.push([0,s]),this.diff_cleanupMerge(u),u},r.prototype.diff_compute_=function(e,t,n,r){var i;if(!e)return[[1,t]];if(!t)return[[-1,e]];var o=e.length>t.length?e:t,a=e.length>t.length?t:e,l=o.indexOf(a);if(-1!=l)return i=[[1,o.substring(0,l)],[0,a],[1,o.substring(l+a.length)]],e.length>t.length&&(i[0][0]=i[2][0]=-1),i;if(1==a.length)return[[-1,e],[1,t]];var s=this.diff_halfMatch_(e,t);if(s){var u=s[0],c=s[1],f=s[2],d=s[3],h=s[4],g=this.diff_main(u,f,n,r),p=this.diff_main(c,d,n,r);return g.concat([[0,h]],p)}return n&&e.length>100&&t.length>100?this.diff_lineMode_(e,t,r):this.diff_bisect_(e,t,r)},r.prototype.diff_lineMode_=function(e,t,n){var r=this.diff_linesToChars_(e,t);e=r.chars1,t=r.chars2;var i=r.lineArray,o=this.diff_main(e,t,!1,n);this.diff_charsToLines_(o,i),this.diff_cleanupSemantic(o),o.push([0,""]);for(var a=0,l=0,s=0,u="",c="";a<o.length;){switch(o[a][0]){case 1:s++,c+=o[a][1];break;case-1:l++,u+=o[a][1];break;case 0:if(l>=1&&s>=1){o.splice(a-l-s,l+s),a=a-l-s;for(var r=this.diff_main(u,c,!1,n),f=r.length-1;f>=0;f--)o.splice(a,0,r[f]);a+=r.length}s=0,l=0,u="",c=""}a++}return o.pop(),o},r.prototype.diff_bisect_=function(e,t,n){for(var r=e.length,i=t.length,o=Math.ceil((r+i)/2),a=o,l=2*o,s=new Array(l),u=new Array(l),c=0;c<l;c++)s[c]=-1,u[c]=-1;s[a+1]=0,u[a+1]=0;for(var f=r-i,d=f%2!=0,h=0,g=0,p=0,v=0,m=0;m<o&&!((new Date).getTime()>n);m++){for(var b=-m+h;b<=m-g;b+=2){var y,w=a+b;y=b==-m||b!=m&&s[w-1]<s[w+1]?s[w+1]:s[w-1]+1;for(var _=y-b;y<r&&_<i&&e.charAt(y)==t.charAt(_);)y++,_++;if(s[w]=y,y>r)g+=2;else if(_>i)h+=2;else if(d){var k=a+f-b;if(k>=0&&k<l&&-1!=u[k]){var E=r-u[k];if(y>=E)return this.diff_bisectSplit_(e,t,y,_,n)}}}for(var T=-m+p;T<=m-v;T+=2){var E,k=a+T;E=T==-m||T!=m&&u[k-1]<u[k+1]?u[k+1]:u[k-1]+1;for(var C=E-T;E<r&&C<i&&e.charAt(r-E-1)==t.charAt(i-C-1);)E++,C++;if(u[k]=E,E>r)v+=2;else if(C>i)p+=2;else if(!d){var w=a+f-T;if(w>=0&&w<l&&-1!=s[w]){var y=s[w],_=a+y-w;if(E=r-E,y>=E)return this.diff_bisectSplit_(e,t,y,_,n)}}}}return[[-1,e],[1,t]]},r.prototype.diff_bisectSplit_=function(e,t,n,r,i){var o=e.substring(0,n),a=t.substring(0,r),l=e.substring(n),s=t.substring(r),u=this.diff_main(o,a,!1,i),c=this.diff_main(l,s,!1,i);return u.concat(c)},r.prototype.diff_linesToChars_=function(e,t){function n(e){for(var t="",n=0,o=-1,a=r.length;o<e.length-1;){o=e.indexOf("\n",n),-1==o&&(o=e.length-1);var l=e.substring(n,o+1);n=o+1,(i.hasOwnProperty?i.hasOwnProperty(l):void 0!==i[l])?t+=String.fromCharCode(i[l]):(t+=String.fromCharCode(a),i[l]=a,r[a++]=l)}return t}var r=[],i={};return r[0]="",{chars1:n(e),chars2:n(t),lineArray:r}},r.prototype.diff_charsToLines_=function(e,t){for(var n=0;n<e.length;n++){for(var r=e[n][1],i=[],o=0;o<r.length;o++)i[o]=t[r.charCodeAt(o)];e[n][1]=i.join("")}},r.prototype.diff_commonPrefix=function(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var n=0,r=Math.min(e.length,t.length),i=r,o=0;n<i;)e.substring(o,i)==t.substring(o,i)?(n=i,o=n):r=i,i=Math.floor((r-n)/2+n);return i},r.prototype.diff_commonSuffix=function(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var n=0,r=Math.min(e.length,t.length),i=r,o=0;n<i;)e.substring(e.length-i,e.length-o)==t.substring(t.length-i,t.length-o)?(n=i,o=n):r=i,i=Math.floor((r-n)/2+n);return i},r.prototype.diff_commonOverlap_=function(e,t){var n=e.length,r=t.length;if(0==n||0==r)return 0;n>r?e=e.substring(n-r):n<r&&(t=t.substring(0,n));var i=Math.min(n,r);if(e==t)return i;for(var o=0,a=1;;){var l=e.substring(i-a),s=t.indexOf(l);if(-1==s)return o;a+=s,0!=s&&e.substring(i-a)!=t.substring(0,a)||(o=a,a++)}},r.prototype.diff_halfMatch_=function(e,t){function n(e,t,n){for(var r,i,o,l,s=e.substring(n,n+Math.floor(e.length/4)),u=-1,c="";-1!=(u=t.indexOf(s,u+1));){var f=a.diff_commonPrefix(e.substring(n),t.substring(u)),d=a.diff_commonSuffix(e.substring(0,n),t.substring(0,u));c.length<d+f&&(c=t.substring(u-d,u)+t.substring(u,u+f),r=e.substring(0,n-d),i=e.substring(n+f),o=t.substring(0,u-d),l=t.substring(u+f))}return 2*c.length>=e.length?[r,i,o,l,c]:null}if(this.Diff_Timeout<=0)return null;var r=e.length>t.length?e:t,i=e.length>t.length?t:e;if(r.length<4||2*i.length<r.length)return null;var o,a=this,l=n(r,i,Math.ceil(r.length/4)),s=n(r,i,Math.ceil(r.length/2));if(!l&&!s)return null;o=s?l&&l[4].length>s[4].length?l:s:l;var u,c,f,d;return e.length>t.length?(u=o[0],c=o[1],f=o[2],d=o[3]):(f=o[0],d=o[1],u=o[2],c=o[3]),[u,c,f,d,o[4]]},r.prototype.diff_cleanupSemantic=function(e){for(var t=!1,n=[],r=0,i=null,o=0,a=0,l=0,s=0,u=0;o<e.length;)0==e[o][0]?(n[r++]=o,a=s,l=u,s=0,u=0,i=e[o][1]):(1==e[o][0]?s+=e[o][1].length:u+=e[o][1].length,i&&i.length<=Math.max(a,l)&&i.length<=Math.max(s,u)&&(e.splice(n[r-1],0,[-1,i]),e[n[r-1]+1][0]=1,r--,r--,o=r>0?n[r-1]:-1,a=0,l=0,s=0,u=0,i=null,t=!0)),o++;for(t&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),o=1;o<e.length;){if(-1==e[o-1][0]&&1==e[o][0]){var c=e[o-1][1],f=e[o][1],d=this.diff_commonOverlap_(c,f),h=this.diff_commonOverlap_(f,c);d>=h?(d>=c.length/2||d>=f.length/2)&&(e.splice(o,0,[0,f.substring(0,d)]),e[o-1][1]=c.substring(0,c.length-d),e[o+1][1]=f.substring(d),o++):(h>=c.length/2||h>=f.length/2)&&(e.splice(o,0,[0,c.substring(0,h)]),e[o-1][0]=1,e[o-1][1]=f.substring(0,f.length-h),e[o+1][0]=-1,e[o+1][1]=c.substring(h),o++),o++}o++}},r.prototype.diff_cleanupSemanticLossless=function(e){function t(e,t){if(!e||!t)return 6;var n=e.charAt(e.length-1),i=t.charAt(0),o=n.match(r.nonAlphaNumericRegex_),a=i.match(r.nonAlphaNumericRegex_),l=o&&n.match(r.whitespaceRegex_),s=a&&i.match(r.whitespaceRegex_),u=l&&n.match(r.linebreakRegex_),c=s&&i.match(r.linebreakRegex_),f=u&&e.match(r.blanklineEndRegex_),d=c&&t.match(r.blanklineStartRegex_);return f||d?5:u||c?4:o&&!l&&s?3:l||s?2:o||a?1:0}for(var n=1;n<e.length-1;){if(0==e[n-1][0]&&0==e[n+1][0]){var i=e[n-1][1],o=e[n][1],a=e[n+1][1],l=this.diff_commonSuffix(i,o);if(l){var s=o.substring(o.length-l);i=i.substring(0,i.length-l),o=s+o.substring(0,o.length-l),a=s+a}for(var u=i,c=o,f=a,d=t(i,o)+t(o,a);o.charAt(0)===a.charAt(0);){i+=o.charAt(0),o=o.substring(1)+a.charAt(0),a=a.substring(1);var h=t(i,o)+t(o,a);h>=d&&(d=h,u=i,c=o,f=a)}e[n-1][1]!=u&&(u?e[n-1][1]=u:(e.splice(n-1,1),n--),e[n][1]=c,f?e[n+1][1]=f:(e.splice(n+1,1),n--))}n++}},r.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,r.whitespaceRegex_=/\s/,r.linebreakRegex_=/[\r\n]/,r.blanklineEndRegex_=/\n\r?\n$/,r.blanklineStartRegex_=/^\r?\n\r?\n/,r.prototype.diff_cleanupEfficiency=function(e){for(var t=!1,n=[],r=0,i=null,o=0,a=!1,l=!1,s=!1,u=!1;o<e.length;)0==e[o][0]?(e[o][1].length<this.Diff_EditCost&&(s||u)?(n[r++]=o,a=s,l=u,i=e[o][1]):(r=0,i=null),s=u=!1):(-1==e[o][0]?u=!0:s=!0,i&&(a&&l&&s&&u||i.length<this.Diff_EditCost/2&&a+l+s+u==3)&&(e.splice(n[r-1],0,[-1,i]),e[n[r-1]+1][0]=1,r--,i=null,a&&l?(s=u=!0,r=0):(r--,o=r>0?n[r-1]:-1,s=u=!1),t=!0)),o++;t&&this.diff_cleanupMerge(e)},r.prototype.diff_cleanupMerge=function(e){e.push([0,""]);for(var t,n=0,r=0,i=0,o="",a="";n<e.length;)switch(e[n][0]){case 1:i++,a+=e[n][1],n++;break;case-1:r++,o+=e[n][1],n++;break;case 0:r+i>1?(0!==r&&0!==i&&(t=this.diff_commonPrefix(a,o),0!==t&&(n-r-i>0&&0==e[n-r-i-1][0]?e[n-r-i-1][1]+=a.substring(0,t):(e.splice(0,0,[0,a.substring(0,t)]),n++),a=a.substring(t),o=o.substring(t)),0!==(t=this.diff_commonSuffix(a,o))&&(e[n][1]=a.substring(a.length-t)+e[n][1],a=a.substring(0,a.length-t),o=o.substring(0,o.length-t))),0===r?e.splice(n-i,r+i,[1,a]):0===i?e.splice(n-r,r+i,[-1,o]):e.splice(n-r-i,r+i,[-1,o],[1,a]),n=n-r-i+(r?1:0)+(i?1:0)+1):0!==n&&0==e[n-1][0]?(e[n-1][1]+=e[n][1],e.splice(n,1)):n++,i=0,r=0,o="",a=""}""===e[e.length-1][1]&&e.pop();var l=!1;for(n=1;n<e.length-1;)0==e[n-1][0]&&0==e[n+1][0]&&(e[n][1].substring(e[n][1].length-e[n-1][1].length)==e[n-1][1]?(e[n][1]=e[n-1][1]+e[n][1].substring(0,e[n][1].length-e[n-1][1].length),e[n+1][1]=e[n-1][1]+e[n+1][1],e.splice(n-1,1),l=!0):e[n][1].substring(0,e[n+1][1].length)==e[n+1][1]&&(e[n-1][1]+=e[n+1][1],e[n][1]=e[n][1].substring(e[n+1][1].length)+e[n+1][1],e.splice(n+1,1),l=!0)),n++;l&&this.diff_cleanupMerge(e)},r.prototype.diff_xIndex=function(e,t){var n,r=0,i=0,o=0,a=0;for(n=0;n<e.length&&(1!==e[n][0]&&(r+=e[n][1].length),-1!==e[n][0]&&(i+=e[n][1].length),!(r>t));n++)o=r,a=i;return e.length!=n&&-1===e[n][0]?a:a+(t-o)},r.prototype.diff_prettyHtml=function(e){for(var t=[],n=/&/g,r=/</g,i=/>/g,o=/\n/g,a=0;a<e.length;a++){var l=e[a][0],s=e[a][1],u=s.replace(n,"&amp;").replace(r,"&lt;").replace(i,"&gt;").replace(o,"&para;<br>");switch(l){case 1:t[a]='<ins style="background:#e6ffe6;">'+u+"</ins>";break;case-1:t[a]='<del style="background:#ffe6e6;">'+u+"</del>";break;case 0:t[a]="<span>"+u+"</span>"}}return t.join("")},r.prototype.diff_text1=function(e){for(var t=[],n=0;n<e.length;n++)1!==e[n][0]&&(t[n]=e[n][1]);return t.join("")},r.prototype.diff_text2=function(e){for(var t=[],n=0;n<e.length;n++)-1!==e[n][0]&&(t[n]=e[n][1]);return t.join("")},r.prototype.diff_levenshtein=function(e){for(var t=0,n=0,r=0,i=0;i<e.length;i++){var o=e[i][0],a=e[i][1];switch(o){case 1:n+=a.length;break;case-1:r+=a.length;break;case 0:t+=Math.max(n,r),n=0,r=0}}return t+=Math.max(n,r)},r.prototype.diff_toDelta=function(e){for(var t=[],n=0;n<e.length;n++)switch(e[n][0]){case 1:t[n]="+"+encodeURI(e[n][1]);break;case-1:t[n]="-"+e[n][1].length;break;case 0:t[n]="="+e[n][1].length}return t.join("\t").replace(/%20/g," ")},r.prototype.diff_fromDelta=function(e,t){for(var n=[],r=0,i=0,o=t.split(/\t/g),a=0;a<o.length;a++){var l=o[a].substring(1);switch(o[a].charAt(0)){case"+":try{n[r++]=[1,decodeURI(l)]}catch(e){throw new Error("Illegal escape in diff_fromDelta: "+l)}break;case"-":case"=":var s=parseInt(l,10);if(isNaN(s)||s<0)throw new Error("Invalid number in diff_fromDelta: "+l);var u=e.substring(i,i+=s);"="==o[a].charAt(0)?n[r++]=[0,u]:n[r++]=[-1,u];break;default:if(o[a])throw new Error("Invalid diff operation in diff_fromDelta: "+o[a])}}if(i!=e.length)throw new Error("Delta length ("+i+") does not equal source text length ("+e.length+").");return n},r.prototype.match_main=function(e,t,n){if(null==e||null==t||null==n)throw new Error("Null input. (match_main)");return n=Math.max(0,Math.min(n,e.length)),e==t?0:e.length?e.substring(n,n+t.length)==t?n:this.match_bitap_(e,t,n):-1},r.prototype.match_bitap_=function(e,t,n){function r(e,r){var i=e/t.length,a=Math.abs(n-r);return o.Match_Distance?i+a/o.Match_Distance:a?1:i}if(t.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var i=this.match_alphabet_(t),o=this,a=this.Match_Threshold,l=e.indexOf(t,n);-1!=l&&(a=Math.min(r(0,l),a),-1!=(l=e.lastIndexOf(t,n+t.length))&&(a=Math.min(r(0,l),a)));var s=1<<t.length-1;l=-1;for(var u,c,f,d=t.length+e.length,h=0;h<t.length;h++){for(u=0,c=d;u<c;)r(h,n+c)<=a?u=c:d=c,c=Math.floor((d-u)/2+u);d=c;var g=Math.max(1,n-c+1),p=Math.min(n+c,e.length)+t.length,v=Array(p+2);v[p+1]=(1<<h)-1;for(var m=p;m>=g;m--){var b=i[e.charAt(m-1)];if(v[m]=0===h?(v[m+1]<<1|1)&b:(v[m+1]<<1|1)&b|(f[m+1]|f[m])<<1|1|f[m+1],v[m]&s){var y=r(h,m-1);if(y<=a){if(a=y,!((l=m-1)>n))break;g=Math.max(1,2*n-l)}}}if(r(h+1,n)>a)break;f=v}return l},r.prototype.match_alphabet_=function(e){for(var t={},n=0;n<e.length;n++)t[e.charAt(n)]=0;for(var n=0;n<e.length;n++)t[e.charAt(n)]|=1<<e.length-n-1;return t},r.prototype.patch_addContext_=function(e,t){if(0!=t.length){for(var n=t.substring(e.start2,e.start2+e.length1),r=0;t.indexOf(n)!=t.lastIndexOf(n)&&n.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)r+=this.Patch_Margin,n=t.substring(e.start2-r,e.start2+e.length1+r);r+=this.Patch_Margin;var i=t.substring(e.start2-r,e.start2);i&&e.diffs.unshift([0,i]);var o=t.substring(e.start2+e.length1,e.start2+e.length1+r);o&&e.diffs.push([0,o]),e.start1-=i.length,e.start2-=i.length,e.length1+=i.length+o.length,e.length2+=i.length+o.length}},r.prototype.patch_make=function(e,t,n){var o,a;if("string"==typeof e&&"string"==typeof t&&void 0===n)o=e,a=this.diff_main(o,t,!0),a.length>2&&(this.diff_cleanupSemantic(a),this.diff_cleanupEfficiency(a));else if(e&&"object"==(void 0===e?"undefined":i(e))&&void 0===t&&void 0===n)a=e,o=this.diff_text1(a);else if("string"==typeof e&&t&&"object"==(void 0===t?"undefined":i(t))&&void 0===n)o=e,a=t;else{if("string"!=typeof e||"string"!=typeof t||!n||"object"!=(void 0===n?"undefined":i(n)))throw new Error("Unknown call format to patch_make.");o=e,a=n}if(0===a.length)return[];for(var l=[],s=new r.patch_obj,u=0,c=0,f=0,d=o,h=o,g=0;g<a.length;g++){var p=a[g][0],v=a[g][1];switch(u||0===p||(s.start1=c,s.start2=f),p){case 1:s.diffs[u++]=a[g],s.length2+=v.length,h=h.substring(0,f)+v+h.substring(f);break;case-1:s.length1+=v.length,s.diffs[u++]=a[g],h=h.substring(0,f)+h.substring(f+v.length);break;case 0:v.length<=2*this.Patch_Margin&&u&&a.length!=g+1?(s.diffs[u++]=a[g],s.length1+=v.length,s.length2+=v.length):v.length>=2*this.Patch_Margin&&u&&(this.patch_addContext_(s,d),l.push(s),s=new r.patch_obj,u=0,d=h,c=f)}1!==p&&(c+=v.length),-1!==p&&(f+=v.length)}return u&&(this.patch_addContext_(s,d),l.push(s)),l},r.prototype.patch_deepCopy=function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n],o=new r.patch_obj;o.diffs=[];for(var a=0;a<i.diffs.length;a++)o.diffs[a]=i.diffs[a].slice();o.start1=i.start1,o.start2=i.start2,o.length1=i.length1,o.length2=i.length2,t[n]=o}return t},r.prototype.patch_apply=function(e,t){if(0==e.length)return[t,[]];e=this.patch_deepCopy(e);var n=this.patch_addPadding(e);t=n+t+n,this.patch_splitMax(e);for(var r=0,i=[],o=0;o<e.length;o++){var a,l=e[o].start2+r,s=this.diff_text1(e[o].diffs),u=-1;if(s.length>this.Match_MaxBits?-1!=(a=this.match_main(t,s.substring(0,this.Match_MaxBits),l))&&(-1==(u=this.match_main(t,s.substring(s.length-this.Match_MaxBits),l+s.length-this.Match_MaxBits))||a>=u)&&(a=-1):a=this.match_main(t,s,l),-1==a)i[o]=!1,r-=e[o].length2-e[o].length1;else{i[o]=!0,r=a-l;var c;if(c=-1==u?t.substring(a,a+s.length):t.substring(a,u+this.Match_MaxBits),s==c)t=t.substring(0,a)+this.diff_text2(e[o].diffs)+t.substring(a+s.length);else{var f=this.diff_main(s,c,!1);if(s.length>this.Match_MaxBits&&this.diff_levenshtein(f)/s.length>this.Patch_DeleteThreshold)i[o]=!1;else{this.diff_cleanupSemanticLossless(f);for(var d,h=0,g=0;g<e[o].diffs.length;g++){var p=e[o].diffs[g];0!==p[0]&&(d=this.diff_xIndex(f,h)),1===p[0]?t=t.substring(0,a+d)+p[1]+t.substring(a+d):-1===p[0]&&(t=t.substring(0,a+d)+t.substring(a+this.diff_xIndex(f,h+p[1].length))),-1!==p[0]&&(h+=p[1].length)}}}}}return t=t.substring(n.length,t.length-n.length),[t,i]},r.prototype.patch_addPadding=function(e){for(var t=this.Patch_Margin,n="",r=1;r<=t;r++)n+=String.fromCharCode(r);for(var r=0;r<e.length;r++)e[r].start1+=t,e[r].start2+=t;var i=e[0],o=i.diffs;if(0==o.length||0!=o[0][0])o.unshift([0,n]),i.start1-=t,i.start2-=t,i.length1+=t,i.length2+=t;else if(t>o[0][1].length){var a=t-o[0][1].length;o[0][1]=n.substring(o[0][1].length)+o[0][1],i.start1-=a,i.start2-=a,i.length1+=a,i.length2+=a}if(i=e[e.length-1],o=i.diffs,0==o.length||0!=o[o.length-1][0])o.push([0,n]),i.length1+=t,i.length2+=t;else if(t>o[o.length-1][1].length){var a=t-o[o.length-1][1].length;o[o.length-1][1]+=n.substring(0,a),i.length1+=a,i.length2+=a}return n},r.prototype.patch_splitMax=function(e){for(var t=this.Match_MaxBits,n=0;n<e.length;n++)if(!(e[n].length1<=t)){var i=e[n];e.splice(n--,1);for(var o=i.start1,a=i.start2,l="";0!==i.diffs.length;){var s=new r.patch_obj,u=!0;for(s.start1=o-l.length,s.start2=a-l.length,""!==l&&(s.length1=s.length2=l.length,s.diffs.push([0,l]));0!==i.diffs.length&&s.length1<t-this.Patch_Margin;){var c=i.diffs[0][0],f=i.diffs[0][1];1===c?(s.length2+=f.length,a+=f.length,s.diffs.push(i.diffs.shift()),u=!1):-1===c&&1==s.diffs.length&&0==s.diffs[0][0]&&f.length>2*t?(s.length1+=f.length,o+=f.length,u=!1,s.diffs.push([c,f]),i.diffs.shift()):(f=f.substring(0,t-s.length1-this.Patch_Margin),s.length1+=f.length,o+=f.length,0===c?(s.length2+=f.length,a+=f.length):u=!1,s.diffs.push([c,f]),f==i.diffs[0][1]?i.diffs.shift():i.diffs[0][1]=i.diffs[0][1].substring(f.length))}l=this.diff_text2(s.diffs),l=l.substring(l.length-this.Patch_Margin);var d=this.diff_text1(i.diffs).substring(0,this.Patch_Margin);""!==d&&(s.length1+=d.length,s.length2+=d.length,0!==s.diffs.length&&0===s.diffs[s.diffs.length-1][0]?s.diffs[s.diffs.length-1][1]+=d:s.diffs.push([0,d])),u||e.splice(++n,0,s)}}},r.prototype.patch_toText=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e[n];return t.join("")},r.prototype.patch_fromText=function(e){var t=[];if(!e)return t;for(var n=e.split("\n"),i=0,o=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;i<n.length;){var a=n[i].match(o);if(!a)throw new Error("Invalid patch string: "+n[i]);var l=new r.patch_obj;for(t.push(l),l.start1=parseInt(a[1],10),""===a[2]?(l.start1--,l.length1=1):"0"==a[2]?l.length1=0:(l.start1--,l.length1=parseInt(a[2],10)),l.start2=parseInt(a[3],10),""===a[4]?(l.start2--,l.length2=1):"0"==a[4]?l.length2=0:(l.start2--,l.length2=parseInt(a[4],10)),i++;i<n.length;){var s=n[i].charAt(0);try{var u=decodeURI(n[i].substring(1))}catch(e){throw new Error("Illegal escape in patch_fromText: "+u)}if("-"==s)l.diffs.push([-1,u]);else if("+"==s)l.diffs.push([1,u]);else if(" "==s)l.diffs.push([0,u]);else{if("@"==s)break;if(""!==s)throw new Error('Invalid patch mode "'+s+'" in: '+u)}i++}}return t},r.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},r.patch_obj.prototype.toString=function(){var e,t;e=0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1,t=0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2;for(var n,r=["@@ -"+e+" +"+t+" @@\n"],i=0;i<this.diffs.length;i++){switch(this.diffs[i][0]){case 1:n="+";break;case-1:n="-";break;case 0:n=" "}r[i+1]=n+encodeURI(this.diffs[i][1])+"\n"}return r.join("").replace(/%20/g," ")},e.exports=r},function(e,t,n){"use strict";function r(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function i(e){return 3*e.length/4-r(e)}function o(e){var t,n,i,o,a,l,s=e.length;a=r(e),l=new f(3*s/4-a),i=a>0?s-4:s;var u=0;for(t=0,n=0;t<i;t+=4,n+=3)o=c[e.charCodeAt(t)]<<18|c[e.charCodeAt(t+1)]<<12|c[e.charCodeAt(t+2)]<<6|c[e.charCodeAt(t+3)],l[u++]=o>>16&255,l[u++]=o>>8&255,l[u++]=255&o;return 2===a?(o=c[e.charCodeAt(t)]<<2|c[e.charCodeAt(t+1)]>>4,l[u++]=255&o):1===a&&(o=c[e.charCodeAt(t)]<<10|c[e.charCodeAt(t+1)]<<4|c[e.charCodeAt(t+2)]>>2,l[u++]=o>>8&255,l[u++]=255&o),l}function a(e){return u[e>>18&63]+u[e>>12&63]+u[e>>6&63]+u[63&e]}function l(e,t,n){for(var r,i=[],o=t;o<n;o+=3)r=(e[o]<<16)+(e[o+1]<<8)+e[o+2],i.push(a(r));return i.join("")}function s(e){for(var t,n=e.length,r=n%3,i="",o=[],a=0,s=n-r;a<s;a+=16383)o.push(l(e,a,a+16383>s?s:a+16383));return 1===r?(t=e[n-1],i+=u[t>>2],i+=u[t<<4&63],i+="=="):2===r&&(t=(e[n-2]<<8)+e[n-1],i+=u[t>>10],i+=u[t>>4&63],i+=u[t<<2&63],i+="="),o.push(i),o.join("")}t.byteLength=i,t.toByteArray=o,t.fromByteArray=s;for(var u=[],c=[],f="undefined"!=typeof Uint8Array?Uint8Array:Array,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,g=d.length;h<g;++h)u[h]=d[h],c[d.charCodeAt(h)]=h;c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var o,a,l=8*i-r-1,s=(1<<l)-1,u=s>>1,c=-7,f=n?i-1:0,d=n?-1:1,h=e[t+f];for(f+=d,o=h&(1<<-c)-1,h>>=-c,c+=l;c>0;o=256*o+e[t+f],f+=d,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=r;c>0;a=256*a+e[t+f],f+=d,c-=8);if(0===o)o=1-u;else{if(o===s)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,r),o-=u}return(h?-1:1)*a*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var a,l,s,u=8*o-i-1,c=(1<<u)-1,f=c>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:o-1,g=r?1:-1,p=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(l=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-a))<1&&(a--,s*=2),t+=a+f>=1?d/s:d*Math.pow(2,1-f),t*s>=2&&(a++,s/=2),a+f>=c?(l=0,a=c):a+f>=1?(l=(t*s-1)*Math.pow(2,i),a+=f):(l=t*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;e[n+h]=255&l,h+=g,l/=256,i-=8);for(a=a<<i|l,u+=i;u>0;e[n+h]=255&a,h+=g,a/=256,u-=8);e[n+h-g]|=128*p}},function(e,t){t.endianness=function(){return"LE"},t.hostname=function(){return"undefined"!=typeof location?location.hostname:""},t.loadavg=function(){return[]},t.uptime=function(){return 0},t.freemem=function(){return Number.MAX_VALUE},t.totalmem=function(){return Number.MAX_VALUE},t.cpus=function(){return[]},t.type=function(){return"Browser"},t.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},t.networkInterfaces=t.getNetworkInterfaces=function(){return{}},t.arch=function(){return"javascript"},t.platform=function(){return"browser"},t.tmpdir=t.tmpDir=function(){return"/tmp"},t.EOL="\n"},function(e,t,n){e.exports=n(7)},function(e,t,n){"use strict";function r(e){if(!(this instanceof r))return new r(e);i.call(this,e)}e.exports=r;var i=n(23),o=n(9);o.inherits=n(8),o.inherits(r,i),r.prototype._transform=function(e,t,n){n(null,e)}},function(e,t,n){"use strict";function r(){this.head=null,this.tail=null,this.length=0}var i=n(17).Buffer;e.exports=r,r.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},r.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},r.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},r.prototype.clear=function(){this.head=this.tail=null,this.length=0},r.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},r.prototype.concat=function(e){if(0===this.length)return i.alloc(0);if(1===this.length)return this.head.data;for(var t=i.allocUnsafe(e>>>0),n=this.head,r=0;n;)n.data.copy(t,r),r+=n.data.length,n=n.next;return t}},function(e,t,n){e.exports=n(16).PassThrough},function(e,t,n){e.exports=n(16).Transform},function(e,t,n){e.exports=n(15)},function(e,t,n){(function(e,t){!function(e,n){"use strict";function r(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return u[s]=r,l(s),s++}function i(e){delete u[e]}function o(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(n,r)}}function a(e){if(c)setTimeout(a,0,e);else{var t=u[e];if(t){c=!0;try{o(t)}finally{i(e),c=!1}}}}if(!e.setImmediate){var l,s=1,u={},c=!1,f=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?function(){l=function(e){t.nextTick(function(){a(e)})}}():function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?function(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&a(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),l=function(n){e.postMessage(t+n,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){a(e.data)},l=function(t){e.port2.postMessage(t)}}():f&&"onreadystatechange"in f.createElement("script")?function(){var e=f.documentElement;l=function(t){var n=f.createElement("script");n.onreadystatechange=function(){a(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}():function(){l=function(e){setTimeout(a,0,e)}}(),d.setImmediate=r,d.clearImmediate=i}}("undefined"==typeof self?void 0===e?this:e:self)}).call(t,n(18),n(10))},function(e,t,n){function r(e,t){this._id=e,this._clearFn=t}var i=Function.prototype.apply;t.setTimeout=function(){return new r(i.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new r(i.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(83),t.setImmediate=setImmediate,t.clearImmediate=clearImmediate},function(e,t,n){(function(t){function n(e,t){function n(){if(!i){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),i=!0}return e.apply(this,arguments)}if(r("noDeprecation"))return e;var i=!1;return n}function r(e){try{if(!t.localStorage)return!1}catch(e){return!1}var n=t.localStorage[e];return null!=n&&"true"===String(n).toLowerCase()}e.exports=n}).call(t,n(18))},function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=n(41),i=function(e){return e&&e.__esModule?e:{default:e}}(r);n(31),n(28),n(29),n(30),n(27),n(26),window.tui=window.tui||{},window.tui.EditorViewOnly=i.default,$.fn.tuiEditorViewOnly=function(){var e=void 0,t=void 0,n=this.get(0);if(n){for(var r=arguments.length,o=Array(r),a=0;a<r;a++)o[a]=arguments[a];if(e=o[0]||{},t=$.data(n,"tuiEditorViewOnly")){if("string"==typeof e){var l;return(l=t)[e].apply(l,o.slice(1))}}else e.el=n,t=new i.default(e),$.data(n,"tuiEditorViewOnly",t)}return this}}]);