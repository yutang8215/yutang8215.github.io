webpackJsonp([2],{"Q/I+":function(t,s){},ZTVR:function(t,s,a){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var e=a("IHPB"),i=a.n(e),n=a("IfhF"),c=a("KvKp"),o={name:"match",props:[],data:function(){return{userId:c.c.get("user_id")||"",teamId:c.c.get("team_id")||"",userType:2,myTeamTree:c.c.get("team")||this.renderTeamTree(1),otherTeamTree:this.renderTeamTree(2),myteamName:"王者荣耀战队",otherTeamName:"天龙八部战队",matchStatus:1,btnStatus:c.c.get("btn_status")||0,showModal:0,addIndex:1,phone:"",errTxt:"",delId:"",ssData:{gamename:""},applicationData:"",timer1:null,timer2:null,spinShow:!0}},mixins:[n.a],components:{},created:function(){var t=this;t.checkStatus(),t.getTeamListInfo(),t.timer1||(t.timer1=setInterval(function(){t.getTeamListInfo()},5e3))},mounted:function(){var t=this;t.getTeamStatus(),t.timer2||(t.timer2=setInterval(function(){t.getTeamStatus()},5e3))},computed:{},filters:{filterName:function(t){return t&&""!=t?t:"无"},filterInfo:function(t){return t&&""!=t&&null!=t?t:"待定"},dateFmt:function(t){return Object(c.a)(new Date(t),"YYYY-MM-DD hh:mm:ss")}},methods:{checkStatus:function(){var t=this,s=c.c.get("user_phone");s&&""!=s?t.$api.SelectUserInfo(s).then(function(s){if(1e4==Number(s.code)){var a=s.data;if(!a.userInfo.phone||""==a.userInfo.phone)return t.$Message.success("请先登录"),c.c.clear(),void setTimeout(function(){t.$router.push("/login")},500);if(""==a.userInfo.username||""==a.userInfo.schoolname||""==a.userInfo.major||""==a.userInfo.classname||""==a.userInfo.studentcode)return t.$Message.success("请先完善个人信息"),void setTimeout(function(){t.$router.push("/fillinfo")},500)}else t.$Message.warning(s.msg)}):(t.$Message.success("请先登录"),setTimeout(function(){t.$router.push("/login")},500))},renderTeamTree:function(t){var s=[];if(1==t)for(var a=0;a<5;a++){var e={};e.type=0==a?1:2,e.status=0==a?0:1,e.can_del=0,e.del_id="",e.name="",s.push(e)}else if(2==t)for(var i=0;i<5;i++){var n={};n.type=0==i?1:2,n.status=0==i?0:1,n.name="",s.push(n)}return s},getTeamStatus:function(){var t=this;t.$api.GetTeamStatus(t.teamId).then(function(s){s.data.flag&&(t.matchStatus=2,t.btnStatus=2,t.changeDelStatus(0),t.applicationData=s.data,s.data.teamid&&""!=s.data.teamid&&(clearInterval(t.timer2),t.timer2=null,t.getTeamListInfo(s.data.teamid,2)))})},getTeamListInfo:function(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=this,e=t||a.teamId;a.$api.SelectTeamUsers(e).then(function(t){a.spinShow=!1;var e=t.data.filter(function(t){return t.id==t.asTeam.userid}),n=t.data.filter(function(t){return t.id!==t.asTeam.userid&&t.asTeam.id&&null!=t.asTeam.id&&""!=t.asTeam.id}),c=t.data.filter(function(t){return t.id!==t.asTeam.userid&&(!t.asTeam.id||null==t.asTeam.id||""==t.asTeam.id)}),o=[].concat(i()(e),i()(n),i()(c));switch(s){case 1:a.myteamName=e[0].asTeam.teamname,o.forEach(function(t,s){var e=a.myTeamTree[s];t.asTeam.userid==a.userId&&(a.userType=1),t.id!==t.asTeam.userid&&t.asTeam.id&&null!=t.asTeam.id&&""!=t.asTeam.id&&(a.$set(e,"status",2),a.$set(e,"can_del",1)),a.$set(e,"type",t.id==t.asTeam.userid?1:2),a.$set(e,"del_id",t.autrId),a.$set(e,"name",t.username)});break;case 2:a.otherTeamName=e[0].asTeam.teamname,a.matchStatus=3,a.btnStatus=4,a.changeDelStatus(0),o.forEach(function(t,s){var e=a.otherTeamTree[s];a.$set(e,"name",t.username),t.id==t.asTeam.userid?a.$set(e,"type",1):(a.$set(e,"type",2),a.$set(e,"status",2))})}})},handleUser:function(t,s){this.addIndex=s,1==this.userType&&(1==t.status?this.showModal=3:t.status)},del_Person:function(t){this.showModal=2,this.delId=t},kickout:function(){var t=this,s=t.myTeamTree[t.addIndex];t.delId&&t.$api.DeleteTeamUser(t.delId,t.teamId).then(function(a){1e4==Number(a.code)?(t.$Message.success("操作成功"),setTimeout(function(){t.$set(s,"status",1),t.$set(s,"can_del",0),t.$set(s,"name",""),t.showModal=0,t.btnStatus=0,t.getTeamListInfo()})):t.$Message.warning(a.msg)})},cancelInvitation:function(){this.showModal=0,this.phone=""},invitation:function(){var t=this;t.phone?/^1\d{10}$/.test(t.phone)?t.$api.AddTeamUser(t.phone,t.teamId).then(function(s){1e4==Number(s.code)?(t.errTxt="",t.phone="",t.showModal=0,t.$Message.info({content:"邀请已发出，等待成员加入",duration:10})):t.errTxt="*"+s.msg}):t.errTxt="*请输入正确手机号":t.errTxt="*请输入手机号"},apply:function(){var t=this;t.matchStatus=2,t.btnStatus=2,t.$api.CreateApplication(t.teamId).then(function(s){switch(Number(s.code)){case 90011:t.showModal=4,t.matchStatus=1,t.btnStatus=1;break;case 90012:t.showModal=5,t.matchStatus=1,t.btnStatus=1,t.ssData=s.data;break;case 1e4:t.$Message.info({content:"申请成功，等待审核",duration:1}),t.getTeamStatus()}})},cancelApply:function(){var t=this;if(t.applicationData){var s=t.applicationData.applicationId;t.$api.DeleteApplication(s).then(function(s){1e4==Number(s.code)?(t.$Message.success("操作成功"),setTimeout(function(){t.matchStatus=1,t.btnStatus=1,t.changeDelStatus(1)},500)):t.$Message.warning(s.msg)})}},join:function(){this.showModal=0,this.apply()},dissolution:function(){var t=this;t.$api.DeleteTeamInfo(t.teamId).then(function(s){1e4==Number(s.code)?t.$Message.success("操作成功"):t.$Message.warning(s.msg)})},changeDelStatus:function(t){var s=this;c.b.isArray(s.myTeamTree)&&s.myTeamTree.length&&s.myTeamTree.forEach(function(a,e){0!=e&&s.$set(a,"can_del",t)})}},watch:{myTeamTree:{handler:function(t){var s=t.slice(1).every(function(t){return 2==t.status});s&&(clearInterval(this.timer1),this.timer1=null),s&&1==this.matchStatus&&(this.btnStatus=1),2!=this.matchStatus&&3!=this.matchStatus||this.changeDelStatus(0)},immediate:!0,deep:!0},btnStatus:function(t){}}},l={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"match"},[e("div",{staticClass:"header"},[1==t.userType?e("span",{staticClass:"a jiesan",on:{click:function(s){t.showModal=1}}},[t._v("解散战队")]):t._e(),t._v(" "),e("div",{staticClass:"cont"},[e("div",{staticClass:"title"},[t._v(t._s(t.myteamName))]),t._v(" "),e("router-link",{staticClass:"find__btn",attrs:{to:"/list"}})],1),t._v(" "),e("router-link",{staticClass:"a rule",attrs:{to:"/rule",tag:"span"}},[t._v("赛事规则")])],1),t._v(" "),e("div",{staticClass:"team my"},[e("div",{staticClass:"tit"},[t._v("我的战队")]),t._v(" "),t.myTeamTree.length>0?e("ul",{staticClass:"plays"},t._l(t.myTeamTree,function(s,a){return e("li",{key:a,on:{click:function(e){return t.handleUser(s,a)}}},[e("div",{staticClass:"base",class:{leader:1==s.type,add:1==t.userType&&1==s.status,matched:2==s.status}},[1==t.userType&&2==s.status&&1==s.can_del?e("div",{staticClass:"kickout",on:{click:function(a){return t.del_Person(s.del_id)}}}):t._e()]),t._v(" "),e("div",{staticClass:"name"},[t._v(t._s(t._f("filterName")(s.name)))])])}),0):t._e()]),t._v(" "),3!=t.matchStatus?e("div",{staticClass:"no__match"},[e("div",{directives:[{name:"show",rawName:"v-show",value:1==t.matchStatus,expression:"matchStatus==1"}],staticClass:"a"},[t._v("暂未匹配战队")]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:2==t.matchStatus,expression:"matchStatus==2"}],staticClass:"b"},[e("img",{attrs:{src:a("uHBL")}}),t._v(" "),e("p",[t._v("对战申请中")])])]):t._e(),t._v(" "),3==t.matchStatus?e("div",{staticClass:"team other"},[e("div",{staticClass:"tit"},[t._v(t._s(t.otherTeamName))]),t._v(" "),t.otherTeamTree.length>0?e("ul",{staticClass:"plays"},t._l(t.otherTeamTree,function(s,a){return e("li",{key:a},[e("div",{staticClass:"base",class:{leader:1==s.type,matched:2==s.status}}),t._v(" "),e("div",{staticClass:"name"},[t._v(t._s(s.name))])])}),0):t._e()]):t._e(),t._v(" "),e("div",{staticClass:"bottom"},[4!=t.btnStatus?e("div",{staticClass:"m__ing"},[e("div",{directives:[{name:"show",rawName:"v-show",value:1==t.userType&&0==t.btnStatus,expression:"userType==1 && btnStatus==0"}],staticClass:"btn btn__apply--dis"}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:1==t.userType&&1==t.btnStatus,expression:"userType==1 && btnStatus==1"}],staticClass:"btn btn__apply--can",on:{click:t.apply}},[t._v("申请对战")]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:1==t.userType&&2==t.btnStatus,expression:"userType==1 && btnStatus==2"}],staticClass:"btn btn__cancel",on:{click:t.cancelApply}}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:2==t.userType,expression:"userType==2"}],staticClass:"btn btn__signout",on:{click:function(s){t.showModal=6}}})]):t._e(),t._v(" "),4==t.btnStatus?e("div",{staticClass:"m__success"},[e("div",{staticClass:"text"},[e("div",{staticClass:"item"},[e("div",{staticClass:"lt"},[t._v("比赛时间：")]),t._v(" "),e("div",{staticClass:"rt"},[t._v(t._s(t._f("dateFmt")(t._f("filterInfo")(t.applicationData.isdate))))])]),t._v(" "),e("div",{staticClass:"item"},[e("div",{staticClass:"lt"},[t._v("比赛地点：")]),t._v(" "),e("div",{staticClass:"rt"},[t._v(t._s(t._f("filterInfo")(t.applicationData.gameAddress)))])])])]):t._e()]),t._v(" "),e("transition",{attrs:{name:"cover"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.showModal,expression:"showModal"}],key:"a",staticClass:"mask",on:{touchmove:function(t){t.preventDefault()}}},[e("div",{directives:[{name:"show",rawName:"v-show",value:1==t.showModal,expression:"showModal==1"}],staticClass:"box dissolution"},[e("div",{staticClass:"title"},[t._v("解散战队")]),t._v(" "),e("div",{staticClass:"cont"},[e("div",{staticClass:"txt"},[e("p",[t._v("解散战队将无法恢复数据信息")]),t._v(" "),e("p",[t._v("是否确定解散？")])])]),t._v(" "),e("div",{staticClass:"btns"},[e("div",{staticClass:"btn btn__dissolution",on:{click:t.dissolution}}),t._v(" "),e("div",{staticClass:"btn btn__cancel_02",on:{click:function(s){t.showModal=0}}})])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:2==t.showModal,expression:"showModal==2"}],staticClass:"box kickout"},[e("div",{staticClass:"title"},[t._v("提示")]),t._v(" "),e("div",{staticClass:"cont"},[e("div",{staticClass:"txt"},[e("p",[t._v("是否将好友请出战队？")])])]),t._v(" "),e("div",{staticClass:"btns"},[e("div",{staticClass:"btn btn__kickout",on:{click:t.kickout}}),t._v(" "),e("div",{staticClass:"btn btn__cancel_02",on:{click:function(s){t.showModal=0}}})])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:3==t.showModal,expression:"showModal==3"}],staticClass:"box invitation"},[e("div",{staticClass:"title"},[t._v("邀请队员")]),t._v(" "),e("div",{staticClass:"cont"},[e("Input",{attrs:{type:"text",placeholder:"请输入队员手机号",size:"large",clearable:"",maxlength:11},model:{value:t.phone,callback:function(s){t.phone=s},expression:"phone"}}),t._v(" "),e("div",{staticClass:"err"},[t._v(t._s(t.errTxt))])],1),t._v(" "),e("div",{staticClass:"btns"},[e("div",{staticClass:"btn btn__cancel",on:{click:t.cancelInvitation}}),t._v(" "),e("div",{staticClass:"btn btn__invitation",on:{click:t.invitation}})])]),t._v(" "),4==t.showModal?e("div",{staticClass:"box zanwu"},[e("div",{staticClass:"title"},[t._v("提示")]),t._v(" "),e("div",{staticClass:"cont"},[e("div",{staticClass:"txt"},[e("p",[t._v("暂无赛事，请关注公众号比赛动态")])])]),t._v(" "),e("div",{staticClass:"btns"},[e("div",{staticClass:"btn btn__sure_02",on:{click:function(s){t.showModal=0}}})])]):t._e(),t._v(" "),5==t.showModal?e("div",{staticClass:"box join"},[e("div",{staticClass:"title"},[t._v(t._s(t.ssData.gamename))]),t._v(" "),e("div",{staticClass:"cont"},[e("div",{staticClass:"join__txt"},[e("p",[t._v("未到报名时间")])]),t._v(" "),e("div",{staticClass:"join__date"},[e("p",[t._v("报名时间：")]),t._v(" "),e("p",[t._v(t._s(t._f("dateFmt")(t.ssData.fromdate))+"至"+t._s(t._f("dateFmt")(t.ssData.todate)))])])]),t._v(" "),e("div",{staticClass:"btns"},[e("div",{staticClass:"btn btn__cancel",on:{click:function(s){t.showModal=0}}}),t._v(" "),e("div",{staticClass:"btn btn__join",on:{click:t.join}})])]):t._e(),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:6==t.showModal,expression:"showModal==6"}],staticClass:"box signout"},[e("div",{staticClass:"title"},[t._v("提示")]),t._v(" "),e("div",{staticClass:"cont"},[e("div",{staticClass:"txt"},[e("p",[t._v("是否确定退出战队？")])])]),t._v(" "),e("div",{staticClass:"btns"},[e("div",{staticClass:"btn btn__signout"}),t._v(" "),e("div",{staticClass:"btn btn__cancel_02",on:{click:function(s){t.showModal=0}}})])])])]),t._v(" "),t.spinShow?e("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)},staticRenderFns:[]};var r=a("C7Lr")(o,l,!1,function(t){a("Q/I+")},"data-v-8199be8a",null);s.default=r.exports},uHBL:function(t,s){t.exports="data:image/png;base64,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"}});
//# sourceMappingURL=2.8a92a2bead407cafebd2.js.map